<!DOCTYPE html>
<html lang="en-GB">

<!-- START: html-header -->
<head>
    
    <meta charset="utf-8">
    <meta name=”robots” content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        tskit-dev - Tskit 1.0.0!
    </title>
    <meta property="og:type" content="website">
    <meta content="summary_large_image" name="twitter:card">
    <meta content="" name="description">
    <meta content="The 1.0 release marks the coming-of-age of the _tskit_ library. Breaking changes
to _tskit_ will not be made from now on (except in exceptional circumstances).
" property="og:description">
    <meta content="The 1.0 release marks the coming-of-age of the _tskit_ library. Breaking changes
to _tskit_ will not be made from now on (except in exceptional circumstances).
" property="twitter:description">
    
        <meta content="https://i.imgur.com/I9PBjvU.png" property="og:image">
        <meta content="https://i.imgur.com/I9PBjvU.png" property="twitter:image">
    

    <meta content="tskit-dev - Tskit 1.0.0!" property="og:title">
    <meta content="tskit-dev - Tskit 1.0.0!" property="twitter:title">
    <script>
      document.documentElement.className = 'js'
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="profile" href="http://gmpg.org/xfn/11">

    <link rel="shortcut icon" href="/assets/favicons/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicons/site.webmanifest" crossorigin="use-credentials">
    <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.png" color="#085167">
    <meta name="msapplication-TileColor" content="#085167">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://use.typekit.net/uhf4ono.css">
    <link rel="stylesheet" href="/assets/dist/css/style.min.css">
<script data-goatcounter="https://tskit.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
<!-- END: html-header -->

<body>
<div class="page-wrapper">
    <!-- START: header -->
    <header class="header">
        <!-- START: navbar -->
        <nav class="nav navbar navbar-expand-lg">
    <div class="container">
        <a class="navbar-brand" href="/">
            <!-- START: icon-logo -->
            <svg class="icon icon--logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 84.8 68">
                <style>
                    .logo-st0 {
                        fill: #085167
                    }

                    .logo-st1 {
                        fill: #14e2a8
                    }
                </style>
                <path class="logo-st0"
                      d="M2 61.4v-8.2H0v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                <path class="logo-st0"
                      d="M62.7 67.5v-3.4h1.9V53.2h-1.9v-3.4h6.8v14.3h1.9v3.4h-8.7zm1.1-23.3c-.1-1.6 1.2-2.9 2.7-3 1.6-.1 2.9 1.2 3 2.7.1 1.6-1.2 2.9-2.7 3h-.1c-1.5.1-2.8-1-2.9-2.5v-.2"></path>
                <path class="logo-st0"
                      d="M39.6 67.5v-3.4h1.9V45.4h-1.9V42h6.8v14.4h4l1.7-3.2h-2.5v-3.4h9.6v3.4h-2.6L53.7 58l4.2 6h2.8v3.4h-9.9V64h1.7l-2.8-4.6h-3.4V64h1.9v3.4l-8.6.1z"></path>
                <path class="logo-st0"
                      d="M23.4 57c4.5 1.3 6.4 2.7 6.4 5.9 0 3.3-2.5 5.1-6.4 5.1-2.6 0-4.3-.7-5.4-1.9l-.1 1.3h-3.4v-6.1h3.7c.7 1.9 2.5 3.2 4.5 3.1 1.3 0 2.3-.5 2.3-1.6s-1-1.5-1.7-1.7l-2.6-.7c-2.8-.7-6.2-1.7-6.2-6 0-3.4 2.4-5.2 6-5.2 1.8 0 3.6.6 5 1.8l.1-1.3H29v5.9h-3.7c-.4-1.7-1.9-2.9-3.6-2.9-1.3 0-2.3.5-2.3 1.7 0 1 .6 1.4 1.8 1.7l2.2.9z"></path>
                <path class="logo-st0"
                      d="M75 61.4v-8.2h-2v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                <path class="logo-st1" d="M75 28.8h4.8v12.5H75z"></path>
                <path class="logo-st1" d="M41.5 28.8h4.8v9.6h-4.8z"></path>
                <path class="logo-st1" d="M41.5 24h38.3v4.8H41.5z"></path>
                <path class="logo-st1" d="M58.3 14.4h4.8V24h-4.8z"></path>
                <path class="logo-st1" d="M2 14.4h4.8v26.9H2z"></path>
                <path class="logo-st1" d="M2 9.6h61.1v4.8H2z"></path>
                <path class="logo-st1" d="M34.6 0h4.8v9.6h-4.8z"></path>
            </svg>
            <!-- END: icon-logo -->
            <span class="visually-hidden">
                        tskit
                    </span>
        </a>
        <button class="navbar-toggler collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarContent"
                aria-controls="navbarContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
            <!-- START: menu -->
            <ul class="navbar-nav">
                <li class="nav__item">
                    <a href="/genetics-research" class=" nav__item__link">Genetics research</a>
                </li>
                <li class="nav__item">
                    <a href="/learn" class=" nav__item__link">Learn</a>
                </li>
                <li class="nav__item">
                    <a href="/software" class=" nav__item__link">Software</a>
                </li>
                <li class="nav__item">
                    <a href="/news" class=" nav__item__link">News</a>
                </li>
                <li class="nav__item">
                    <a href="/citation" class=" nav__item__link">Citation</a>
                </li>
                <li class="nav__item">
                    <a href="/community" class=" nav__item__link">Community</a>
                </li>
            </ul>
            <!-- END: menu -->
        </div>
    </div>
</nav>
        <!-- END: navbar -->

        <!-- START: heading -->
        
        <!-- END: heading -->
    </header>
    <!-- END: header -->

    <!-- START: content -->
    <main class="page-content" id="content">
        <!-- START: hero-type-2 -->
<div class="hero hero--type-2">
    <div class="container">
        <div class="row">
            <!-- NOTE: Different column values here than other instances of Type 2 Hero -->
            <div class="col-md-8 col-lg-8">
                <!-- NOTE: H1 here not H2 -->
                <h1 class="hero__heading">
                    Tskit 1.0.0!
                </h1>
                <span class="hero__metadata">
                    
                        <span class="hero__metadata__heading">Yan Wong</span>
                        &nbsp;|&nbsp;
                    
                            <time class="hero__metadate__timestamp" datetime="">January 16 2026</time>
                        </span>
            </div>
        </div>
    </div>
</div>
<!-- END: hero-type-2 -->

<!-- START: news-content -->
<section class="section section--general-content">
    <div class="container">
        <div class="row">
            <div class="col-md-8 offset-md-2 blog-entry">
                <p>The <a href="https://github.com/tskit-dev/tskit/releases/tag/1.0.0">1.0.0 release of tskit</a>
tags the point at which backwards compatibility is guaranteed for users.
From now on, unless unavoidable (e.g. bugfixes), there should be no
breaking changes to the API. We have taken the opportunity to fix minor inconsistencies in the
data model, and provide several new ways to access underlying data more efficiently.</p>

<p>Many improvements and new capabilities have also accumulated since the previous 0.6.0 release.
As well as bugfixes, these include several additional convenience arrays,
a basic implementation of PCA analysis that scales to thousands of genomes or more,
and an optional wrapper to speed up Python-based tree sequence algorithms using
<a href="https://numba.readthedocs.io/en/stable/">Numba</a>,
allowing traversal both up and down the graph (ARG) representation of a tree sequence.</p>

<h3 id="breaking-changes">Breaking changes</h3>

<p>See <a href="https://github.com/tskit-dev/tskit/blob/main/python/CHANGELOG.rst">the changelog</a>
for a full list: below are the two major ones</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">ts.tables</code> attribute now returns an <code class="language-plaintext highlighter-rouge">ImmutableTableCollection</code>, meaning that you can’t change
the resulting tables (to edit them, use the
<a href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.dump_tables"><code class="language-plaintext highlighter-rouge">ts.dump_tables()</code></a>
method instead, which has always been the recommended editing method).</li>
  <li>The ordering requirement for mutations that occur at the same site has been tightened up. This
stricter order is required to create a tree sequence, and the <code class="language-plaintext highlighter-rouge">tables.sort()</code> function now enforces
the correct order (this allows efficient calculation of a mutation’s previous (“inherited”) and new
(“derived”) state, allowing access to a <code class="language-plaintext highlighter-rouge">mutation.inherited_state</code> property, see below).</li>
</ul>

<h3 id="new-features">New features</h3>

<h4 id="convenience-arrays">Convenience arrays</h4>

<p>Thanks to <a href="https://github.com/benjeffery">Ben Jeffery</a>, the following are now available</p>

<p>Arrays of variable-length strings (requires <a href="https://numpy.org/doc/stable/release/2.0.0-notes.html">NumPy 2.0</a>)</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ts.sites_ancestral_state</code></li>
  <li><code class="language-plaintext highlighter-rouge">ts.mutations_derived_state</code></li>
  <li><code class="language-plaintext highlighter-rouge">ts.mutations_inherited_state</code></li>
  <li><code class="language-plaintext highlighter-rouge">ts.mutations_inherited_state</code></li>
</ul>

<p>Convenience arrays (matching previous arrays such as <code class="language-plaintext highlighter-rouge">ts.individual_populations</code>, <code class="language-plaintext highlighter-rouge">ts.individual_times</code> etc):</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">ts.mutations_edge</code></li>
  <li><code class="language-plaintext highlighter-rouge">ts.individual_nodes</code></li>
  <li><code class="language-plaintext highlighter-rouge">ts.sample_nodes_by_ploidy</code></li>
</ul>

<p>A quick demonstration (including the new <code class="language-plaintext highlighter-rouge">inherited_state</code> property)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">msprime</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_mutations</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">np</span><span class="p">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s">'float'</span><span class="p">:</span> <span class="s">'{:0.1f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">})</span> <span class="c1"># for nicer lining up
</span><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">"Mutation positions:       "</span><span class="p">,</span> <span class="n">ts</span><span class="p">.</span><span class="n">sites_position</span><span class="p">[</span><span class="n">ts</span><span class="p">.</span><span class="n">mutations_site</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">sites_position</span>  <span class="c1"># Or equivalently ts.tables.sites.position, which is now efficient
</span><span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">"Mutation ancestral states:"</span><span class="p">,</span> <span class="n">ts</span><span class="p">.</span><span class="n">sites_ancestral_state</span><span class="p">[</span><span class="n">ts</span><span class="p">.</span><span class="n">mutations_site</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">"Mutation inherited states:"</span><span class="p">,</span> <span class="n">ts</span><span class="p">.</span><span class="n">mutations_inherited_state</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span><span class="p">(</span><span class="s">"Two nodes for each diploid individual:</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">ts</span><span class="p">.</span><span class="n">individuals_nodes</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">ts</span><span class="p">.</span><span class="n">draw_svg</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">"Demo of inherited states, individual nodes, and a legend"</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
        <span class="n">mutation_labels</span><span class="o">=</span><span class="p">{</span><span class="n">m</span><span class="p">.</span><span class="nb">id</span><span class="p">:</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">m</span><span class="p">.</span><span class="n">inherited_state</span><span class="si">}{</span><span class="nb">int</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="n">m</span><span class="p">.</span><span class="n">site</span><span class="p">])</span><span class="si">}{</span><span class="n">m</span><span class="p">.</span><span class="n">derived_state</span><span class="si">}</span><span class="s">"</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">.</span><span class="n">mutations</span><span class="p">()},</span>
        <span class="n">style</span><span class="o">=</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">".leaf.i%d .sym {fill: %s}"</span> <span class="o">%</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s">'red'</span><span class="p">,</span> <span class="s">'green'</span><span class="p">,</span> <span class="s">'blue'</span><span class="p">,</span> <span class="s">'magenta'</span><span class="p">])),</span>
        <span class="n">preamble</span><span class="o">=</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span>
            <span class="sa">f</span><span class="s">'&lt;g transform="translate(40, </span><span class="si">{</span><span class="mi">30</span> <span class="o">+</span> <span class="mi">18</span><span class="o">*</span><span class="n">i</span><span class="si">}</span><span class="s">)" class="leaf i</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">"&gt;'</span>  <span class="c1"># an SVG group
</span>            <span class="sa">f</span><span class="s">'&lt;rect width="6" height="6" class="sym" /&gt;&lt;text x="10" y="7"&gt;Ind </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">&lt;/text&gt;&lt;/g&gt;'</span>  <span class="c1"># Label
</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">num_individuals</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">)</span>

<span class="n">Mutation</span> <span class="n">positions</span><span class="p">:</span>        <span class="p">[</span><span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">2.0</span> <span class="mf">2.0</span> <span class="mf">3.0</span><span class="p">]</span>
<span class="n">Mutation</span> <span class="n">ancestral</span> <span class="n">states</span><span class="p">:</span> <span class="p">[</span><span class="s">'G'</span> <span class="s">'G'</span> <span class="s">'C'</span> <span class="s">'C'</span> <span class="s">'G'</span><span class="p">]</span>
<span class="n">Mutation</span> <span class="n">inherited</span> <span class="n">states</span><span class="p">:</span> <span class="p">[</span><span class="s">'G'</span> <span class="s">'G'</span> <span class="s">'C'</span> <span class="s">'A'</span> <span class="s">'G'</span><span class="p">]</span>
<span class="n">Two</span> <span class="n">nodes</span> <span class="k">for</span> <span class="n">each</span> <span class="n">diploid</span> <span class="n">individual</span><span class="p">:</span>
 <span class="p">[[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">6</span> <span class="mi">7</span><span class="p">]]</span>
</code></pre></div></div>
<p><img src="/assets/images/news/20261601-tskit-1.0/output.svg" alt="A simple tree plot, coloured by individual" /></p>

<p>You can see that the mutations at position 2 go from C to A to C, so that the most recent mutation at that
position, above node 6, inherits the state “A” (right hand branch), even though the ancestral state
at that locus is “C”. The code above also illustrates new arguments to the <code class="language-plaintext highlighter-rouge">.draw_svg()</code> methods,
specifically <code class="language-plaintext highlighter-rouge">preamble</code> which can be used to create legends, and <code class="language-plaintext highlighter-rouge">title</code>.</p>

<h4 id="pca">PCA</h4>

<p>Thanks to work by <a href="https://github.com/hanbin973">Hanbin Lee</a>, <a href="https://github.com/petrelharp">Peter Ralph</a> and
others, there is now a scalable implementation of branch-based principle components analysis, which also
allows windowing along the genome and by time (also see the <a href="20251202-genetics_papers.html">previous news item</a>). 
Further improvements to the
<a href="https://tskit.dev/tskit/docs/latest/python-api.html#tskit.TreeSequence.pca"><code class="language-plaintext highlighter-rouge">ts.pca</code></a> method are also planned.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">popn_colours</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="s">'steelblue'</span><span class="p">,</span> <span class="s">'coral'</span><span class="p">,</span> <span class="s">'limegreen'</span><span class="p">,</span> <span class="s">'gold'</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span>
        <span class="n">samples</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">popn_colours</span><span class="p">))},</span>
        <span class="n">demography</span><span class="o">=</span><span class="n">msprime</span><span class="p">.</span><span class="n">Demography</span><span class="p">.</span><span class="n">island_model</span><span class="p">([</span><span class="mf">1e4</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">popn_colours</span><span class="p">),</span> <span class="n">migration_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">),</span>
        <span class="n">random_seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
        <span class="n">sequence_length</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span>
        <span class="n">recombination_rate</span><span class="o">=</span><span class="mf">1e-9</span>
    <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Call the PCA
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">pca_output</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">pca</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Plot it (output as scatter plot shown below)
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="p">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">pca_output</span><span class="p">.</span><span class="n">factors</span><span class="p">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">popn_colours</span><span class="p">[</span><span class="n">ts</span><span class="p">.</span><span class="n">nodes_population</span><span class="p">[</span><span class="n">ts</span><span class="p">.</span><span class="n">samples</span><span class="p">()]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">Line2D</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">'w'</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s">"Pop </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">"</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">popn_colours</span><span class="p">)</span>
    <span class="p">]);</span>
</code></pre></div></div>
<p><img src="/assets/images/news/20261601-tskit-1.0/pca.png" alt="A PCA plot, coloured by population" /></p>

<p>Try it out in the new interactive workbooks at <a href="http://tskit.dev/explore/lab/?path=tskit.ipynb">http://tskit.dev/explore/</a>.</p>

<h4 id="fast-metadata-access">Fast metadata access</h4>

<p>For large tree sequences, accessing metadata can be a time consuming step. Now, if metadata
uses the efficient <a href="https://tskit.dev/tskit/docs/stable/metadata.html#struct">struct</a> codec, it is possible to
access it as an efficient numpy array, e.g. via <code class="language-plaintext highlighter-rouge">ts.individuals_metadata</code>, <code class="language-plaintext highlighter-rouge">ts.populations_metadata</code>, etc.
The new functionality is documented
<a href="https://tskit.dev/tskit/docs/stable/metadata.html#structured-array-metadata">here</a>. Below is a demo:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">msprime</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">tskit</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Make a tree sequence with some population metadata, 
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">demog</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">Demography</span><span class="p">.</span><span class="n">island_model</span><span class="p">([</span><span class="mf">1e4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">migration_rate</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">10</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)},</span> <span class="n">demography</span><span class="o">=</span><span class="n">demog</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Convert the metadata schema to a struct codec
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">tables</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">dump_tables</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tables</span><span class="p">.</span><span class="n">populations</span><span class="p">.</span><span class="n">clear</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">tables</span><span class="p">.</span><span class="n">populations</span><span class="p">.</span><span class="n">metadata_schema</span><span class="p">.</span><span class="n">schema</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">tables</span><span class="p">.</span><span class="n">populations</span><span class="p">.</span><span class="n">metadata_schema</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">MetadataSchema</span><span class="p">({</span>
        <span class="s">"codec"</span><span class="p">:</span><span class="s">"struct"</span><span class="p">,</span>
        <span class="s">"properties"</span><span class="p">:{</span>
            <span class="s">"description"</span><span class="p">:{</span><span class="s">"binaryFormat"</span><span class="p">:</span><span class="s">"10s"</span><span class="p">,</span><span class="s">"nullTerminated"</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span><span class="s">"type"</span><span class="p">:</span><span class="s">"string"</span><span class="p">},</span>
            <span class="s">"name"</span><span class="p">:{</span><span class="s">"binaryFormat"</span><span class="p">:</span><span class="s">"10s"</span><span class="p">,</span><span class="s">"nullTerminated"</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span><span class="s">"type"</span><span class="p">:</span><span class="s">"string"</span><span class="p">}},</span>
        <span class="s">"required"</span><span class="p">:[</span><span class="s">"name"</span><span class="p">,</span><span class="s">"description"</span><span class="p">],</span>
        <span class="s">"type"</span><span class="p">:</span><span class="s">"object"</span><span class="p">,</span>
    <span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">.</span><span class="n">populations</span><span class="p">():</span>
        <span class="n">tables</span><span class="p">.</span><span class="n">populations</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">struct_ts</span> <span class="o">=</span> <span class="n">tables</span><span class="p">.</span><span class="n">tree_sequence</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Now we can get a "binary" numpy string array (more efficient for millions of entries)
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">numpy_array</span> <span class="o">=</span> <span class="n">struct_ts</span><span class="p">.</span><span class="n">populations_metadata</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">assert</span> <span class="n">numpy_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s">'pop_0'</span>
</code></pre></div></div>

<p>Although more restrictive than using <code class="language-plaintext highlighter-rouge">json</code> metadata, the resulting efficiency can be worth it for
tables of millions of rows. For example, it enables fast analysis of our ARG of ~2.5 million SARS-CoV2
genomes, which you can explore in our <a href="http://tskit.dev/explore/lab/?path=sc2ts.ipynb">interactive sc2ts notebook</a>.</p>

<h4 id="numba-integration">Numba integration</h4>

<p><img src="https://numba.pydata.org/_static/numba-blue-horizontal-rgb.svg" alt="Numba logo" class="news-float-right" style="height: 2em;" /></p>

<p>Work by <a href="https://github.com/jeromekelleher">Jerome Kelleher</a> and <a href="https://github.com/benjeffery">Ben Jeffery</a>
makes it possible to speed up python-based tskit algorithms, sometimes by many orders of magnitude,
using the <a href="https://numba.readthedocs.io/en/stable/">Numba</a> just-in-time (JIT) compiler.</p>

<p>This advanced <em>tskit</em> usage is primarily aimed at developers of new algorithms, hence Numba is only
an optional <em>tskit</em> dependency. Its use is described in a
<a href="https://tskit.dev/tskit/docs/stable/numba.html">new documentation page</a>, which also details how it
can be used to traverse timewards through the tree sequence graph.</p>

<h4 id="other-new-features">Other new features</h4>

<p><a href="https://github.com/tskit-dev/tskit/blob/main/python/CHANGELOG.rst">The changelog</a> describes
a few more new features. Two in particular are:</p>

<ul>
  <li><a href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.concatenate"><code class="language-plaintext highlighter-rouge">ts.concatenate()</code></a>
now exists, to convert multiple tree sequences along a genome into a single long tree sequence (also see <code class="language-plaintext highlighter-rouge">ts.shift()</code>)</li>
  <li>Various improvements have been made to VCF exporting.</li>
</ul>

            </div>
        </div>
    </div>
</section>
<!-- END: news-content -->

    </main>
    <!-- END: content -->

    <!-- START: footer -->
        <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-5 offset-md-1">
                <a class="footer__logo" href="./">
                    <!-- START: icon-logo -->
                    <svg class="icon icon--logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0"
                         viewBox="0 0 84.8 68">
                        <style>
                            .logo-st0 {
                                fill: #085167
                            }

                            .logo-st1 {
                                fill: #14e2a8
                            }
                        </style>
                        <path class="logo-st0"
                              d="M2 61.4v-8.2H0v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                        <path class="logo-st0"
                              d="M62.7 67.5v-3.4h1.9V53.2h-1.9v-3.4h6.8v14.3h1.9v3.4h-8.7zm1.1-23.3c-.1-1.6 1.2-2.9 2.7-3 1.6-.1 2.9 1.2 3 2.7.1 1.6-1.2 2.9-2.7 3h-.1c-1.5.1-2.8-1-2.9-2.5v-.2"></path>
                        <path class="logo-st0"
                              d="M39.6 67.5v-3.4h1.9V45.4h-1.9V42h6.8v14.4h4l1.7-3.2h-2.5v-3.4h9.6v3.4h-2.6L53.7 58l4.2 6h2.8v3.4h-9.9V64h1.7l-2.8-4.6h-3.4V64h1.9v3.4l-8.6.1z"></path>
                        <path class="logo-st0"
                              d="M23.4 57c4.5 1.3 6.4 2.7 6.4 5.9 0 3.3-2.5 5.1-6.4 5.1-2.6 0-4.3-.7-5.4-1.9l-.1 1.3h-3.4v-6.1h3.7c.7 1.9 2.5 3.2 4.5 3.1 1.3 0 2.3-.5 2.3-1.6s-1-1.5-1.7-1.7l-2.6-.7c-2.8-.7-6.2-1.7-6.2-6 0-3.4 2.4-5.2 6-5.2 1.8 0 3.6.6 5 1.8l.1-1.3H29v5.9h-3.7c-.4-1.7-1.9-2.9-3.6-2.9-1.3 0-2.3.5-2.3 1.7 0 1 .6 1.4 1.8 1.7l2.2.9z"></path>
                        <path class="logo-st0"
                              d="M75 61.4v-8.2h-2v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                        <path class="logo-st1" d="M75 28.8h4.8v12.5H75z"></path>
                        <path class="logo-st1" d="M41.5 28.8h4.8v9.6h-4.8z"></path>
                        <path class="logo-st1" d="M41.5 24h38.3v4.8H41.5z"></path>
                        <path class="logo-st1" d="M58.3 14.4h4.8V24h-4.8z"></path>
                        <path class="logo-st1" d="M2 14.4h4.8v26.9H2z"></path>
                        <path class="logo-st1" d="M2 9.6h61.1v4.8H2z"></path>
                        <path class="logo-st1" d="M34.6 0h4.8v9.6h-4.8z"></path>
                    </svg>
                    <!-- END: icon-logo -->
                    <span class="visually-hidden">
                        tskit
                    </span>
                </a>
            </div>
            <div class="col">
                <ul class="list list--unstyled">
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/tskit-site/issues/new/choose" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Report a website issue
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Github
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/.github/blob/main/CODE_OF_CONDUCT.md" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Code of conduct
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="/governance/" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Governance
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/tskit-site/blob/main/LICENSE" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Licence
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="/ecosystem-status/" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Ecosystem Status
                                </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <!-- END: footer -->
    <!-- START: global modal -->
    <div class="modal fade"
         id="globalModal"
         tabindex="-1"
         role="dialog"
         aria-labelledby="globalModalLabel"
         aria-hidden="true"
    >
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <button class="navbar-toggler modal-close" type="button" data-bs-dismiss="modal" aria-label="Close">
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="modal-header visually-hidden">
                    <h5 class="modal-title" id="globalModalLabel">
                        Modal content
                    </h5>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>
    <!-- END: global modal -->

</div>

<script src="/assets/dist/js/main.min.js"></script>

</body>
</html>
