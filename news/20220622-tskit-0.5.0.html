<!DOCTYPE html>
<html lang="en-GB">

<!-- START: html-header -->
<head>
    
    <meta charset="utf-8">
    <meta name=‚Äùrobots‚Äù content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        tskit-dev - What's new in TSKIT 0.5.0!
    </title>
    <meta property="og:type" content="website">
    <meta content="summary_large_image" name="twitter:card">
    <meta content="" name="description">
    <meta content="0.5.0 introduces balance metrics, tree arrays, topology operations, performance improvements and much more." property="og:description">
    <meta content="0.5.0 introduces balance metrics, tree arrays, topology operations, performance improvements and much more." property="twitter:description">
    
        <meta content="https://i.imgur.com/I9PBjvU.png" property="og:image">
        <meta content="https://i.imgur.com/I9PBjvU.png" property="twitter:image">
    

    <meta content="tskit-dev - What's new in TSKIT 0.5.0!" property="og:title">
    <meta content="tskit-dev - What's new in TSKIT 0.5.0!" property="twitter:title">
    <script>
      document.documentElement.className = 'js'
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="profile" href="http://gmpg.org/xfn/11">

    <link rel="shortcut icon" href="/assets/favicons/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicons/site.webmanifest" crossorigin="use-credentials">
    <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.png" color="#085167">
    <meta name="msapplication-TileColor" content="#085167">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://use.typekit.net/uhf4ono.css">
    <link rel="stylesheet" href="/assets/dist/css/style.min.css">
<script data-goatcounter="https://tskit.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
<!-- END: html-header -->

<body>
<div class="page-wrapper">
    <!-- START: header -->
    <header class="header">
        <!-- START: navbar -->
        <nav class="nav navbar navbar-expand-lg">
    <div class="container">
        <a class="navbar-brand" href="/">
            <!-- START: icon-logo -->
            <svg class="icon icon--logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0" viewBox="0 0 84.8 68">
                <style>
                    .logo-st0 {
                        fill: #085167
                    }

                    .logo-st1 {
                        fill: #14e2a8
                    }
                </style>
                <path class="logo-st0"
                      d="M2 61.4v-8.2H0v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                <path class="logo-st0"
                      d="M62.7 67.5v-3.4h1.9V53.2h-1.9v-3.4h6.8v14.3h1.9v3.4h-8.7zm1.1-23.3c-.1-1.6 1.2-2.9 2.7-3 1.6-.1 2.9 1.2 3 2.7.1 1.6-1.2 2.9-2.7 3h-.1c-1.5.1-2.8-1-2.9-2.5v-.2"></path>
                <path class="logo-st0"
                      d="M39.6 67.5v-3.4h1.9V45.4h-1.9V42h6.8v14.4h4l1.7-3.2h-2.5v-3.4h9.6v3.4h-2.6L53.7 58l4.2 6h2.8v3.4h-9.9V64h1.7l-2.8-4.6h-3.4V64h1.9v3.4l-8.6.1z"></path>
                <path class="logo-st0"
                      d="M23.4 57c4.5 1.3 6.4 2.7 6.4 5.9 0 3.3-2.5 5.1-6.4 5.1-2.6 0-4.3-.7-5.4-1.9l-.1 1.3h-3.4v-6.1h3.7c.7 1.9 2.5 3.2 4.5 3.1 1.3 0 2.3-.5 2.3-1.6s-1-1.5-1.7-1.7l-2.6-.7c-2.8-.7-6.2-1.7-6.2-6 0-3.4 2.4-5.2 6-5.2 1.8 0 3.6.6 5 1.8l.1-1.3H29v5.9h-3.7c-.4-1.7-1.9-2.9-3.6-2.9-1.3 0-2.3.5-2.3 1.7 0 1 .6 1.4 1.8 1.7l2.2.9z"></path>
                <path class="logo-st0"
                      d="M75 61.4v-8.2h-2v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                <path class="logo-st1" d="M75 28.8h4.8v12.5H75z"></path>
                <path class="logo-st1" d="M41.5 28.8h4.8v9.6h-4.8z"></path>
                <path class="logo-st1" d="M41.5 24h38.3v4.8H41.5z"></path>
                <path class="logo-st1" d="M58.3 14.4h4.8V24h-4.8z"></path>
                <path class="logo-st1" d="M2 14.4h4.8v26.9H2z"></path>
                <path class="logo-st1" d="M2 9.6h61.1v4.8H2z"></path>
                <path class="logo-st1" d="M34.6 0h4.8v9.6h-4.8z"></path>
            </svg>
            <!-- END: icon-logo -->
            <span class="visually-hidden">
                        tskit
                    </span>
        </a>
        <button class="navbar-toggler collapsed"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarContent"
                aria-controls="navbarContent"
                aria-expanded="false"
                aria-label="Toggle navigation"
        >
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarContent">
            <!-- START: menu -->
            <ul class="navbar-nav">
                <li class="nav__item">
                    <a href="/genetics-research" class=" nav__item__link">Genetics research</a>
                </li>
                <li class="nav__item">
                    <a href="/learn" class=" nav__item__link">Learn</a>
                </li>
                <li class="nav__item">
                    <a href="/software" class=" nav__item__link">Software</a>
                </li>
                <li class="nav__item">
                    <a href="/news" class=" nav__item__link">News</a>
                </li>
                <li class="nav__item">
                    <a href="/citation" class=" nav__item__link">Citation</a>
                </li>
                <li class="nav__item">
                    <a href="/community" class=" nav__item__link">Community</a>
                </li>
            </ul>
            <!-- END: menu -->
        </div>
    </div>
</nav>
        <!-- END: navbar -->

        <!-- START: heading -->
        
        <!-- END: heading -->
    </header>
    <!-- END: header -->

    <!-- START: content -->
    <main class="page-content" id="content">
        <!-- START: hero-type-2 -->
<div class="hero hero--type-2">
    <div class="container">
        <div class="row">
            <!-- NOTE: Different column values here than other instances of Type 2 Hero -->
            <div class="col-md-8 col-lg-8">
                <!-- NOTE: H1 here not H2 -->
                <h1 class="hero__heading">
                    What's new in TSKIT 0.5.0!
                </h1>
                <span class="hero__metadata">
                    
                        <span class="hero__metadata__heading">Ben Jeffery</span>
                        &nbsp;|&nbsp;
                    
                            <time class="hero__metadate__timestamp" datetime="">June 22 2022</time>
                        </span>
            </div>
        </div>
    </div>
</div>
<!-- END: hero-type-2 -->

<!-- START: news-content -->
<section class="section section--general-content">
    <div class="container">
        <div class="row">
            <div class="col-md-8 offset-md-2 blog-entry">
                <h2 id="tskit-050">TSKIT 0.5.0</h2>

<h4 id="new-record-number-of-contributors-12">New record number of contributors? (12!)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span> <span class="n">git</span> <span class="n">log</span> <span class="mf">0.4</span><span class="p">.</span><span class="mf">1.</span><span class="p">.</span><span class="mf">0.5</span><span class="p">.</span><span class="mi">0</span> <span class="o">--</span><span class="nb">format</span><span class="o">=</span><span class="s">"%aN"</span> <span class="o">--</span><span class="n">reverse</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ben Jeffery
Bing Guo
Georgia Tsambos
Gertjan Bisschop
Jerome Kelleher
j.guez
Kevin R. Thornton
molpopgen
peter
Peter Ralph
Ruhollah Shemirani
Savita Karthikeyan
savitakartik
Shing Zhan
Yan Wong
</code></pre></div></div>

<h4 id="support-and-wheels-for-python-310-ben-jeffery">Support and wheels for Python 3.10 (Ben Jeffery)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="p">.</span><span class="n">version</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'3.10.5 (main, Jun 11 2022, 16:53:24) [GCC 9.4.0]'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">tskit</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Collecting tskit
  Downloading tskit-0.5.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB)
[2K     [38;2;114;156;31m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m1.1/1.1 MB[0m [31m12.2 MB/s[0m eta [36m0:00:00[0m MB/s[0m eta [36m0:00:01[0m01[0m
[?25hRequirement already satisfied: svgwrite&gt;=1.1.10 in /home/benj/projects/050_notebook/env/lib/python3.10/site-packages (from tskit) (1.4.2)
Requirement already satisfied: numpy&gt;=1.7 in /home/benj/projects/050_notebook/env/lib/python3.10/site-packages (from tskit) (1.23.0)
Requirement already satisfied: jsonschema&gt;=3.0.0 in /home/benj/projects/050_notebook/env/lib/python3.10/site-packages (from tskit) (4.6.1)
Requirement already satisfied: attrs&gt;=17.4.0 in /home/benj/projects/050_notebook/env/lib/python3.10/site-packages (from jsonschema&gt;=3.0.0-&gt;tskit) (21.4.0)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&gt;=0.14.0 in /home/benj/projects/050_notebook/env/lib/python3.10/site-packages (from jsonschema&gt;=3.0.0-&gt;tskit) (0.18.1)
Installing collected packages: tskit
Successfully installed tskit-0.5.0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tskit</span>
<span class="k">print</span><span class="p">(</span><span class="n">tskit</span><span class="p">.</span><span class="n">__version__</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.5.0
</code></pre></div></div>

<h4 id="new-suite-of-tree-balance-metrics-implemented-in-c---jeremy-guez-and-jerome-kelleher">New suite of tree balance metrics, implemented in C - Jeremy Guez and Jerome Kelleher</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#First make some trees to demo
</span><span class="n">comb</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">Tree</span><span class="p">.</span><span class="n">generate_comb</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">comb</span><span class="p">.</span><span class="n">draw_svg</span><span class="p">())</span>
</code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_8_0.svg" alt="svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">balanced</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">Tree</span><span class="p">.</span><span class="n">generate_balanced</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">balanced</span><span class="p">.</span><span class="n">draw_svg</span><span class="p">())</span>

</code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_9_0.svg" alt="svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The Sackin's index is the sum of the number of ancestors for each leaf of the tree.
# The less balanced a tree is the larger its Sackin index.
</span><span class="n">comb</span><span class="p">.</span><span class="n">sackin_index</span><span class="p">(),</span> <span class="n">balanced</span><span class="p">.</span><span class="n">sackin_index</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(20, 16)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The Colless index is the sum of abs(L-R) at each node of the tree where L(R) is the size
# of the left(right) descendant clade at the node.
# The less balanced a tree is the larger its Colless index.
</span><span class="n">comb</span><span class="p">.</span><span class="n">colless_index</span><span class="p">(),</span> <span class="n">balanced</span><span class="p">.</span><span class="n">colless_index</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(10, 2)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># The classic B1 and B2 indexes from (Shao &amp; Sokal, 1990)
</span><span class="n">comb</span><span class="p">.</span><span class="n">b1_index</span><span class="p">(),</span> <span class="n">balanced</span><span class="p">.</span><span class="n">b1_index</span><span class="p">()</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(2.083333333333333, 3.0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comb</span><span class="p">.</span><span class="n">b2_index</span><span class="p">(),</span> <span class="n">balanced</span><span class="p">.</span><span class="n">b2_index</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(0.5832456165989635, 0.7525749891599529)
</code></pre></div></div>

<h4 id="the-tree-class-now-has-arrays-for-gertjan-bisschop">The <code class="highlighter-rouge">Tree</code> class now has arrays for: (Gertjan Bisschop)</h4>
<ul>
  <li>the number of children for each node</li>
  <li>the id of the edge from each node to its parent</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Note that these include an entry for the virtual root at the end of the array!
</span><span class="n">comb</span><span class="p">.</span><span class="n">num_children_array</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 1], dtype=int32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comb</span><span class="p">.</span><span class="n">edge_array</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([ 8,  6,  4,  2,  0,  1,  3,  5,  7,  9, -1, -1], dtype=int32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># And there are methods to get a single value.
</span><span class="n">comb</span><span class="p">.</span><span class="n">edge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Only use these for clarity, don't use these in a tight loop!
</span><span class="n">big_comb</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">Tree</span><span class="p">.</span><span class="n">generate_comb</span><span class="p">(</span><span class="mi">60000</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">array</span> <span class="o">=</span> <span class="n">big_comb</span><span class="p">.</span><span class="n">num_children_array</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>81.6 ns ¬± 1.07 ns per loop (mean ¬± std. dev. of 7 runs, 10,000,000 loops each)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">array</span> <span class="o">=</span> <span class="n">big_comb</span><span class="p">.</span><span class="n">num_children_array</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">val</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">34567</span><span class="p">]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>95.1 ns ¬± 10.6 ns per loop (mean ¬± std. dev. of 7 runs, 10,000,000 loops each)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="n">big_comb</span><span class="p">.</span><span class="n">num_children</span><span class="p">(</span><span class="mi">34567</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>170 ns ¬± 1.45 ns per loop (mean ¬± std. dev. of 7 runs, 1,000,000 loops each)
</code></pre></div></div>

<h4 id="new-convenience-methods-to-get-the-time-and-populations-of-all-individuals-in-a-tree-sequence-peter-ralph">New convenience methods to get the time and populations of all individuals in a tree sequence (Peter Ralph)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">msprime</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">demography</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">Demography</span><span class="p">()</span>
<span class="n">demography</span><span class="p">.</span><span class="n">add_population</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"A"</span><span class="p">,</span> <span class="n">initial_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">demography</span><span class="p">.</span><span class="n">add_population</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"B"</span><span class="p">,</span> <span class="n">initial_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">demography</span><span class="p">.</span><span class="n">add_population</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">"C"</span><span class="p">,</span> <span class="n">initial_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">demography</span><span class="p">.</span><span class="n">add_population_split</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">derived</span><span class="o">=</span><span class="p">[</span><span class="s">"A"</span><span class="p">,</span> <span class="s">"B"</span><span class="p">],</span> <span class="n">ancestral</span><span class="o">=</span><span class="s">"C"</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="p">{</span><span class="s">"A"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">"B"</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">demography</span><span class="o">=</span><span class="n">demography</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span><span class="p">.</span><span class="n">individuals_time</span><span class="p">,</span><span class="n">ts</span><span class="p">.</span><span class="n">individuals_population</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.]),
 array([0, 0, 0, 0, 0, 1, 1, 1, 1, 1], dtype=int32))
</code></pre></div></div>

<h4 id="three-new-topology-operations-have-been-added-so-that-topology-older-than-a-given-time-can-be-removed-jerome-kelleher">Three new topology operations have been added so that topology older than a given time can be removed (Jerome Kelleher)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">Tree</span><span class="p">.</span><span class="n">generate_balanced</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">branch_length</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">tree_sequence</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">draw_svg</span><span class="p">(</span><span class="n">min_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_27_0.svg" alt="svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SVG</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">decapitate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">).</span><span class="n">draw_svg</span><span class="p">(</span><span class="n">min_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_28_0.svg" alt="svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SVG</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">split_edges</span><span class="p">(</span><span class="mf">0.5</span><span class="p">).</span><span class="n">draw_svg</span><span class="p">())</span>

</code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_29_0.svg" alt="svg" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Decapitate is implemented via split_edges and delete_older
</span><span class="n">tables</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">tables</span>
<span class="n">tables</span><span class="p">.</span><span class="n">delete_older</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">.</span><span class="n">edges</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0
</code></pre></div></div>

<h4 id="fix-negative-time-handling-in-svg-drawing-and-add-min_time-to-draw_svg-yan-wong">Fix negative time handling in SVG drawing and add <code class="highlighter-rouge">min_time</code> to <code class="highlighter-rouge">draw_svg</code> (Yan Wong)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">SVG</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">draw_svg</span><span class="p">(</span><span class="n">min_time</span><span class="o">=-</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># (Can also be "tree" or "ts")
</span></code></pre></div></div>

<p><img src="/assets/images/news/20220622-tskit-0.5.0/output_32_0.svg" alt="svg" /></p>

<h4 id="loading-and-dumping-of-tables-and-tree-sequences-is-now-a-zero-copy-operation-this-means-youll-be-able-to-save-and-load-larger-files-for-your-given-ram-its-also-faster-ben-jeffery">Loading and dumping of tables and tree-sequences is now a zero-copy operation. This means you‚Äôll be able to save and load larger files for your given RAM. It‚Äôs also faster! (Ben Jeffery)</h4>

<p>(See images that the notebook wouldn‚Äôt let me embed due to CORS)</p>

<p>#### Edge diffs can now be iterated over in the reverse direction (Jerome Kelleher, Ben Jeffery)</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">recombination_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">list</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">edge_diffs</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EdgeDiff(interval=Interval(left=0.0, right=1.0), edges_out=[], edges_in=[Edge(left=0.0, right=1.0, parent=9, child=0, metadata=b'', id=12), Edge(left=0.0, right=2.0, parent=9, child=3, metadata=b'', id=14), Edge(left=0.0, right=1.0, parent=17, child=1, metadata=b'', id=30), Edge(left=0.0, right=1.0, parent=17, child=2, metadata=b'', id=31), Edge(left=0.0, right=1.0, parent=22, child=9, metadata=b'', id=45), Edge(left=0.0, right=1.0, parent=22, child=17, metadata=b'', id=46)])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">list</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">edge_diffs</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="n">tskit</span><span class="p">.</span><span class="n">REVERSE</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>EdgeDiff(interval=Interval(left=9.0, right=10.0), edges_out=[], edges_in=[Edge(left=8.0, right=10.0, parent=5, child=0, metadata=b'', id=2), Edge(left=8.0, right=10.0, parent=5, child=1, metadata=b'', id=3), Edge(left=9.0, right=10.0, parent=10, child=2, metadata=b'', id=15), Edge(left=8.0, right=10.0, parent=10, child=5, metadata=b'', id=16), Edge(left=9.0, right=10.0, parent=16, child=3, metadata=b'', id=28), Edge(left=9.0, right=10.0, parent=16, child=10, metadata=b'', id=29)])
</code></pre></div></div>

<h5 id="note-that-this-change-bought-edge_diff-into-python-so-there-is-a-small-10-perf-hit-please-let-us-know-if-this-has-impacted-you">Note that this change bought <code class="highlighter-rouge">edge_diff</code> into Python, so there is a small ~10% perf hit. Please let us know if this has impacted you.</h5>

<h4 id="instead-of-iterating-over-all-variants-when-decoding-genotypes-specific-sites-can-be-specified-this-still-uses-tree-seeking-under-the-hood-so-its-more-efficient-to-access-sites-in-order-ben-jeffery">Instead of iterating over all variants when decoding genotypes, specific sites can be specified. This still uses tree seeking under the hood, so it‚Äôs more efficient to access sites in order. (Ben Jeffery)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_ancestry</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span><span class="n">recombination_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="p">.</span><span class="n">sim_mutations</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">random_seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ts</span>
</code></pre></div></div>

<div>
  <style>
    .tskit-table thead tr th {text-align: left;padding: 0.5em 0.5em;}
    .tskit-table tbody tr td {padding: 0.5em 0.5em;}
    .tskit-table tbody tr td:first-of-type {text-align: left;}
    .tskit-details-label {vertical-align: top; padding-right:5px;}
    .tskit-table-set {display: inline-flex;flex-wrap: wrap;margin: -12px 0 0 -12px;width: calc(100% + 12px);}
    .tskit-table-set-table {margin: 12px 0 0 12px;}
    details {display: inline-block;}
    summary {cursor: pointer; outline: 0; display: list-item;}
  </style>
  <div class="tskit-table-set">
    <div class="tskit-table-set-table">
      <table class="tskit-table">
        <thead>
          <tr>
            <th style="padding:0;line-height:21px;">
              <img style="height: 32px;display: inline-block;padding: 3px 5px 3px 0;" src="https://raw.githubusercontent.com/tskit-dev/administrative/main/tskit_logo.svg" />
              <a target="_blank" href="https://tskit.dev/tskit/docs/latest/python-api.html#the-treesequence-class"> Tree Sequence </a>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Trees</td><td>1940</td></tr>
          <tr><td>Sequence Length</td><td>10000.0</td></tr>
          <tr><td>Time Units</td><td>generations</td></tr>
          <tr><td>Sample Nodes</td><td>200</td></tr>
          <tr><td>Total Size</td><td>509.9 KiB</td></tr>
          <tr>
            <td>Metadata</td><td style="text-align: left;">No Metadata</td></tr>
        </tbody>
      </table>
    </div>
    <div class="tskit-table-set-table">
      <table class="tskit-table">
        <thead>
          <tr>
            <th style="line-height:21px;">Table</th>
            <th>Rows</th>
            <th>Size</th>
            <th>Has Metadata</th>
          </tr>
        </thead>
        <tbody>

      <tr>
        <td>Edges</td>
          <td>8097</td>
          <td>253.0 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Individuals</td>
          <td>100</td>
          <td>2.8 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Migrations</td>
          <td>0</td>
          <td>8 Bytes</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Mutations</td>
          <td>2399</td>
          <td>86.7 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Nodes</td>
          <td>1860</td>
          <td>50.9 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Populations</td>
          <td>1</td>
          <td>224 Bytes</td>
          <td style="text-align: center;">
            ‚úÖ
          </td>
        </tr>

      <tr>
        <td>Provenances</td>
          <td>2</td>
          <td>1.6 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

      <tr>
        <td>Sites</td>
          <td>2108</td>
          <td>51.5 KiB</td>
          <td style="text-align: center;">

          </td>
        </tr>

        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">tskit</span><span class="p">.</span><span class="n">Variant</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="n">v</span><span class="p">.</span><span class="n">genotypes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

Input In [30], in &lt;cell line: 2&gt;()
      1 v = tskit.Variant(ts)
----&gt; 2 v.genotypes


File ~/projects/050_notebook/env/lib/python3.10/site-packages/tskit/genotypes.py:156, in Variant.genotypes(self)
    150 @property
    151 def genotypes(self) -&gt; np.ndarray:
    152     """
    153     An array of indexes into the list ``alleles``, giving the
    154     state of each sample at the current site.
    155     """
--&gt; 156     self._check_decoded()
    157     return self._ll_variant.genotypes


File ~/projects/050_notebook/env/lib/python3.10/site-packages/tskit/genotypes.py:120, in Variant._check_decoded(self)
    118 def _check_decoded(self):
    119     if self._ll_variant.site_id == tskit.NULL:
--&gt; 120         raise ValueError(
    121             "This variant has not yet been decoded at a specific site,"
    122             "call Variant.decode to set the site."
    123         )


ValueError: This variant has not yet been decoded at a specific site,call Variant.decode to set the site.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="p">.</span><span class="n">alleles</span><span class="p">,</span> <span class="n">v</span><span class="p">.</span><span class="n">genotypes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(('A', 'G'),
 array([0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0,
        1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0,
        0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0,
        0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0,
        0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
        0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1,
        1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0,
        1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
        1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1,
        0, 0], dtype=int32))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="p">.</span><span class="n">genotypes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0], dtype=int32)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span><span class="p">.</span><span class="n">site</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Site(id=1, position=4.0, ancestral_state='C', mutations=[Mutation(id=1, site=1, node=300, derived_state='T', parent=-1, metadata=b'', time=0.02619723874402521, edge=822)], metadata=b'')
</code></pre></div></div>

<h4 id="tsvariants-has-a-new-copy-argument-which-if-false-reuses-the-variant-object-for-improved-performance-ben-jeffery"><code class="highlighter-rouge">ts.variants</code> has a new <code class="highlighter-rouge">copy</code> argument which if False reuses the variant object for improved performance (Ben Jeffery)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="p">[</span><span class="n">v</span><span class="p">.</span><span class="n">genotypes</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">.</span><span class="n">variants</span><span class="p">()]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4.54 ms ¬± 53.7 ¬µs per loop (mean ¬± std. dev. of 7 runs, 100 loops each)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">timeit</span> <span class="p">[</span><span class="n">v</span><span class="p">.</span><span class="n">genotypes</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ts</span><span class="p">.</span><span class="n">variants</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)]</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.76 ms ¬± 41.4 ¬µs per loop (mean ¬± std. dev. of 7 runs, 100 loops each)
</code></pre></div></div>

<h4 id="the-mutation-class-now-has-an-edge-attribute-that-stores-the-id-of-the-edge-the-mutation-falls-on-jerome-kelleher">The <code class="highlighter-rouge">Mutation</code> class now has an <code class="highlighter-rouge">edge</code> attribute that stores the id of the edge the mutation falls on (Jerome Kelleher)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span><span class="p">.</span><span class="n">edge</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">site</span><span class="p">.</span><span class="n">mutations</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">edge</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Edge(left=0.0, right=779.0, parent=494, child=300, metadata=b'', id=822)
</code></pre></div></div>

<h4 id="vcf-output-now-supports-missingness-and-when-outputting-a-vcf-sites-and-samples-can-be-masked-to-be-omitted-from-the-output-vcfs-can-also-be-returned-as-a-string-with-as_vcf-jerome-kelleher">VCF output now supports missingness, and when outputting a VCF sites and samples can be masked to be omitted from the output. VCFs can also be returned as a string with <code class="highlighter-rouge">as_vcf</code> (Jerome Kelleher)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="k">print</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">num_sites</span><span class="p">,</span> <span class="s">"sites"</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"out.vcf"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ts</span><span class="p">.</span><span class="n">write_vcf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">site_mask</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">ts</span><span class="p">.</span><span class="n">num_sites</span><span class="p">))</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"out.vcf"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()),</span> <span class="s">"lines"</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2108 sites
1053 lines
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">as_vcf</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">as_vcf</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">10</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">pick_sites</span><span class="p">(</span><span class="n">variant</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">variant</span><span class="p">.</span><span class="n">genotypes</span> <span class="o">==</span> <span class="mi">1</span>
<span class="k">print</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">as_vcf</span><span class="p">(</span><span class="n">sample_mask</span><span class="o">=</span><span class="n">pick_sites</span><span class="p">).</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)[</span><span class="mi">10</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	tsk_0	tsk_1	tsk_2	tsk_3	tsk_4	tsk_5	tsk_6	tsk_7	tsk_8	tsk_9	tsk_10	tsk_11	tsk_12	tsk_13	tsk_14	tsk_15	tsk_16	tsk_17	tsk_18	tsk_19	tsk_20	tsk_21	tsk_22	tsk_23	tsk_24	tsk_25	tsk_26	tsk_27	tsk_28	tsk_29	tsk_30	tsk_31	tsk_32	tsk_33	tsk_34	tsk_35	tsk_36	tsk_37	tsk_38	tsk_39	tsk_40	tsk_41	tsk_42	tsk_43	tsk_44	tsk_45	tsk_46	tsk_47	tsk_48	tsk_49	tsk_50	tsk_51	tsk_52	tsk_53	tsk_54	tsk_55	tsk_56	tsk_57	tsk_58	tsk_59	tsk_60	tsk_61	tsk_62	tsk_63	tsk_64	tsk_65	tsk_66	tsk_67	tsk_68	tsk_69	tsk_70	tsk_71	tsk_72	tsk_73	tsk_74	tsk_75	tsk_76	tsk_77	tsk_78	tsk_79	tsk_80	tsk_81	tsk_82	tsk_83	tsk_84	tsk_85	tsk_86	tsk_87	tsk_88	tsk_89	tsk_90	tsk_91	tsk_92	tsk_93	tsk_94	tsk_95	tsk_96	tsk_97	tsk_98	tsk_99
1	14	4	A	T	.	PASS	.	GT	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	1|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	1|0	1|0	0|0	0|0	0|0	0|0	0|0	1|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	1|0	0|0	0|0	0|0	0|0	0|0	1|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|1	0|0	0|0
1	14	4	A	T	.	PASS	.	GT	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	.|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	.|0	.|0	0|0	0|0	0|0	0|0	0|0	.|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	.|0	0|0	0|0	0|0	0|0	0|0	.|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|0	0|.	0|0	0|0
</code></pre></div></div>

<h4 id="vcf-output-now-includes-the-site-id-in-the-vcf-id-field-ruhollah-roohy-shemirani">VCF output now includes the site ID in the VCF ID field (Ruhollah (Roohy) Shemirani)</h4>

<h4 id="when-metadata-equal-to-b-is-printed-to-text-or-html-tables-it-will-render-as-an-empty-string-rather-than-b-yan-wong">When metadata equal to <code class="highlighter-rouge">b''</code> is printed to text or HTML tables it will render as an empty string rather than ‚Äúb‚Äô‚Äô‚Äù (Yan Wong)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tskit</span><span class="p">.</span><span class="n">set_print_options</span><span class="p">(</span><span class="n">max_lines</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ts</span><span class="p">.</span><span class="n">tables</span><span class="p">.</span><span class="n">nodes</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>        &lt;div&gt;
            &lt;style scoped=""&gt;
                .tskit-table tbody tr th:only-of-type {vertical-align: middle;}
                .tskit-table tbody tr th {vertical-align: top;}
                .tskit-table tbody td {text-align: right;padding: 0.5em 0.5em;}
                .tskit-table tbody th {padding: 0.5em 0.5em;}
            &lt;/style&gt;
            &lt;table border="1" class="tskit-table"&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;id&lt;/th&gt;&lt;th&gt;flags&lt;/th&gt;&lt;th&gt;population&lt;/th&gt;&lt;th&gt;individual&lt;/th&gt;&lt;th&gt;time&lt;/th&gt;&lt;th&gt;metadata&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    &lt;tr&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0&lt;/td&gt;&lt;td&gt;0.00000000&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
</code></pre></div></div>
<tr><td>1</td><td>1</td><td>0</td><td>0</td><td>0.00000000</td><td></td></tr>
<tr><td>2</td><td>1</td><td>0</td><td>1</td><td>0.00000000</td><td></td></tr>
<tr><td>3</td><td>1</td><td>0</td><td>1</td><td>0.00000000</td><td></td></tr>
<tr><td>4</td><td>1</td><td>0</td><td>2</td><td>0.00000000</td><td></td></tr>
<tr><td style="text-align: center;" colspan="93"><em>1850 rows skipped (tskit.set_print_options)</em></td></tr>
<tr><td>1855</td><td>0</td><td>0</td><td>-1</td><td>13.07287124</td><td></td></tr>
<tr><td>1856</td><td>0</td><td>0</td><td>-1</td><td>13.38324282</td><td></td></tr>
<tr><td>1857</td><td>0</td><td>0</td><td>-1</td><td>14.40434535</td><td></td></tr>
<tr><td>1858</td><td>0</td><td>0</td><td>-1</td><td>14.69232476</td><td></td></tr>
<tr><td>1859</td><td>0</td><td>0</td><td>-1</td><td>17.66824272</td><td></td></tr>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                &lt;/tbody&gt;
            &lt;/table&gt;
        &lt;/div&gt;
</code></pre></div></div>

<h4 id="treemrca-now-gives-the-most-common-ancestor-of-any-number-of-nodes-savita-karthikeyan"><code class="highlighter-rouge">tree.mrca</code> now gives the most common ancestor of any number of nodes (Savita Karthikeyan)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span><span class="p">.</span><span class="n">first</span><span class="p">().</span><span class="n">mrca</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1556
</code></pre></div></div>

<h4 id="tssite-now-has-a-position-argument-implemented-by-binary-search-shing-hei-zhan"><code class="highlighter-rouge">ts.site</code> now has a <code class="highlighter-rouge">position</code> argument, implemented by binary search (Shing Hei Zhan)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span><span class="p">.</span><span class="n">site</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">420</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

Input In [43], in &lt;cell line: 1&gt;()
----&gt; 1 ts.site(position=420)


File ~/projects/050_notebook/env/lib/python3.10/site-packages/tskit/trees.py:5409, in TreeSequence.site(self, id_, position)
   5407     id_ = site_pos.searchsorted(position)
   5408     if id_ &gt;= len(site_pos) or site_pos[id_] != position:
-&gt; 5409         raise ValueError(f"There is no site at position {position}.")
   5410 ll_site = self._ll_tree_sequence.get_site(id_)
   5411 pos, ancestral_state, ll_mutations, _, metadata = ll_site


ValueError: There is no site at position 420.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ts</span><span class="p">.</span><span class="n">site</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Site(id=4, position=14.0, ancestral_state='A', mutations=[Mutation(id=4, site=4, node=552, derived_state='T', parent=-1, metadata=b'', time=0.043147719803472, edge=2315)], metadata=b'')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

            </div>
        </div>
    </div>
</section>
<!-- END: news-content -->

    </main>
    <!-- END: content -->

    <!-- START: footer -->
        <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-5 offset-md-1">
                <a class="footer__logo" href="./">
                    <!-- START: icon-logo -->
                    <svg class="icon icon--logo" xmlns="http://www.w3.org/2000/svg" x="0" y="0"
                         viewBox="0 0 84.8 68">
                        <style>
                            .logo-st0 {
                                fill: #085167
                            }

                            .logo-st1 {
                                fill: #14e2a8
                            }
                        </style>
                        <path class="logo-st0"
                              d="M2 61.4v-8.2H0v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                        <path class="logo-st0"
                              d="M62.7 67.5v-3.4h1.9V53.2h-1.9v-3.4h6.8v14.3h1.9v3.4h-8.7zm1.1-23.3c-.1-1.6 1.2-2.9 2.7-3 1.6-.1 2.9 1.2 3 2.7.1 1.6-1.2 2.9-2.7 3h-.1c-1.5.1-2.8-1-2.9-2.5v-.2"></path>
                        <path class="logo-st0"
                              d="M39.6 67.5v-3.4h1.9V45.4h-1.9V42h6.8v14.4h4l1.7-3.2h-2.5v-3.4h9.6v3.4h-2.6L53.7 58l4.2 6h2.8v3.4h-9.9V64h1.7l-2.8-4.6h-3.4V64h1.9v3.4l-8.6.1z"></path>
                        <path class="logo-st0"
                              d="M23.4 57c4.5 1.3 6.4 2.7 6.4 5.9 0 3.3-2.5 5.1-6.4 5.1-2.6 0-4.3-.7-5.4-1.9l-.1 1.3h-3.4v-6.1h3.7c.7 1.9 2.5 3.2 4.5 3.1 1.3 0 2.3-.5 2.3-1.6s-1-1.5-1.7-1.7l-2.6-.7c-2.8-.7-6.2-1.7-6.2-6 0-3.4 2.4-5.2 6-5.2 1.8 0 3.6.6 5 1.8l.1-1.3H29v5.9h-3.7c-.4-1.7-1.9-2.9-3.6-2.9-1.3 0-2.3.5-2.3 1.7 0 1 .6 1.4 1.8 1.7l2.2.9z"></path>
                        <path class="logo-st0"
                              d="M75 61.4v-8.2h-2v-3.4h2v-5h4.8v5h5v3.4h-5v8.2c0 1.9.8 2.9 2.5 2.9.9 0 1.7-.2 2.4-.6v3.5c-1.1.5-2.4.8-3.7.8-4.2 0-6-2.8-6-6.6"></path>
                        <path class="logo-st1" d="M75 28.8h4.8v12.5H75z"></path>
                        <path class="logo-st1" d="M41.5 28.8h4.8v9.6h-4.8z"></path>
                        <path class="logo-st1" d="M41.5 24h38.3v4.8H41.5z"></path>
                        <path class="logo-st1" d="M58.3 14.4h4.8V24h-4.8z"></path>
                        <path class="logo-st1" d="M2 14.4h4.8v26.9H2z"></path>
                        <path class="logo-st1" d="M2 9.6h61.1v4.8H2z"></path>
                        <path class="logo-st1" d="M34.6 0h4.8v9.6h-4.8z"></path>
                    </svg>
                    <!-- END: icon-logo -->
                    <span class="visually-hidden">
                        tskit
                    </span>
                </a>
            </div>
            <div class="col">
                <ul class="list list--unstyled">
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/tskit-site/issues/new/choose" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Report a website issue
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Github
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/.github/blob/main/CODE_OF_CONDUCT.md" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Code of conduct
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="/governance/" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Governance
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="https://github.com/tskit-dev/tskit-site/blob/main/LICENSE" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Licence
                                </span>
                        </a>
                    </li>
                    <li class="list__item">
                        <a href="/ecosystem-status/" class="list__item__link link link--type-1">
                                <span class="link__text">
                                    Ecosystem Status
                                </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

    <!-- END: footer -->
    <!-- START: global modal -->
    <div class="modal fade"
         id="globalModal"
         tabindex="-1"
         role="dialog"
         aria-labelledby="globalModalLabel"
         aria-hidden="true"
    >
        <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
            <div class="modal-content">
                <button class="navbar-toggler modal-close" type="button" data-bs-dismiss="modal" aria-label="Close">
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="modal-header visually-hidden">
                    <h5 class="modal-title" id="globalModalLabel">
                        Modal content
                    </h5>
                </div>
                <div class="modal-body"></div>
            </div>
        </div>
    </div>
    <!-- END: global modal -->

</div>

<script src="/assets/dist/js/main.min.js"></script>

</body>
</html>

