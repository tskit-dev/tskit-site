
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Usage &#8212; Tsinfer manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"9655dd4d37074513afba90566c94d091": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "239c7a236d6d4b35bafbe321ec105094": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "254880c9a7ce480ba9c0fd36d79fa62c": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9655dd4d37074513afba90566c94d091", "max": 20.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_239c7a236d6d4b35bafbe321ec105094", "tabbable": null, "tooltip": null, "value": 20.0}}, "d7ef8a78d2c6483da0aa2362a2956930": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "8e6a7517ccec4c738b4e605f9f14e48e": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "ad4bb2a323984f1cbc86309efbd408f4": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d7ef8a78d2c6483da0aa2362a2956930", "placeholder": "\u200b", "style": "IPY_MODEL_8e6a7517ccec4c738b4e605f9f14e48e", "tabbable": null, "tooltip": null, "value": "ga-add\u2007\u2007\u2007(1/6)100%"}}, "06cfd8f799cf4c32906a7d08a8c810f2": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f5e8309dadc94c0c812d618a345c4125": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "bc1e7855a52c4e1eb9932a967e0f5f78": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_06cfd8f799cf4c32906a7d08a8c810f2", "placeholder": "\u200b", "style": "IPY_MODEL_f5e8309dadc94c0c812d618a345c4125", "tabbable": null, "tooltip": null, "value": "\u200720.0/20.0\u2007[00:00,\u20071.36kit/s]"}}, "e45233c5d917407c9269a0d86dfaf91a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "5913c50c83c2417a85a3f839fdd2ef6e": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_ad4bb2a323984f1cbc86309efbd408f4", "IPY_MODEL_254880c9a7ce480ba9c0fd36d79fa62c", "IPY_MODEL_bc1e7855a52c4e1eb9932a967e0f5f78"], "layout": "IPY_MODEL_e45233c5d917407c9269a0d86dfaf91a", "tabbable": null, "tooltip": null}}, "065ac50aa20c43469c54ef705f490f4e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "045c357def9f4aa396765459e3292a98": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "bc550a540d2f4711863e0e08082d5940": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_065ac50aa20c43469c54ef705f490f4e", "max": 15.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_045c357def9f4aa396765459e3292a98", "tabbable": null, "tooltip": null, "value": 15.0}}, "b687155efbab485383e954add2e76d1c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d7ccb1c82704d32b24a57896f12bfbd": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "6c4573ff5e6d4562b7660d87e677cb7b": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b687155efbab485383e954add2e76d1c", "placeholder": "\u200b", "style": "IPY_MODEL_4d7ccb1c82704d32b24a57896f12bfbd", "tabbable": null, "tooltip": null, "value": "ga-gen\u2007\u2007\u2007(2/6)100%"}}, "d6e111cc59a54a81a6c13147356c2c44": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f093f12fafa84b5c82c8e796478bae82": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "af2e6688d80340608a63fb41dc9de62b": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d6e111cc59a54a81a6c13147356c2c44", "placeholder": "\u200b", "style": "IPY_MODEL_f093f12fafa84b5c82c8e796478bae82", "tabbable": null, "tooltip": null, "value": "\u200715.0/15.0\u2007[00:00,\u20071.67kit/s]"}}, "18954a393d784dff92bb160bb5708fbd": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "202c102326b3446eb99918aba7321913": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_6c4573ff5e6d4562b7660d87e677cb7b", "IPY_MODEL_bc550a540d2f4711863e0e08082d5940", "IPY_MODEL_af2e6688d80340608a63fb41dc9de62b"], "layout": "IPY_MODEL_18954a393d784dff92bb160bb5708fbd", "tabbable": null, "tooltip": null}}, "a05bfdc7bcd4422e909e1252a6b4ce09": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5fd16682b36141e0b26b82a4926963c3": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "41d417cbbd5f492ea5f7418c68d70cde": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_a05bfdc7bcd4422e909e1252a6b4ce09", "max": 16.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_5fd16682b36141e0b26b82a4926963c3", "tabbable": null, "tooltip": null, "value": 16.0}}, "eb7e86caa820416591bd6a6db954eab7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fc34d0ad54fe4c9594cf88009ba5cf43": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f04ce97e2c2240a784c83f5ac387eea1": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_eb7e86caa820416591bd6a6db954eab7", "placeholder": "\u200b", "style": "IPY_MODEL_fc34d0ad54fe4c9594cf88009ba5cf43", "tabbable": null, "tooltip": null, "value": "ma-match\u2007(3/6)100%"}}, "f90338e089cf41f9bdfa2b28d04245ba": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "b3ad535413ae4cdcb64c5b7c62d5b5e6": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "4077e48289e14b57b9d9725cb7140373": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f90338e089cf41f9bdfa2b28d04245ba", "placeholder": "\u200b", "style": "IPY_MODEL_b3ad535413ae4cdcb64c5b7c62d5b5e6", "tabbable": null, "tooltip": null, "value": "\u200716.0/16.0\u2007[00:00,\u2007373it/s]"}}, "a3f5bc6a3875498f94168f3080bd8ef3": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "efddebe6aa274aae879af9a28496478d": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f04ce97e2c2240a784c83f5ac387eea1", "IPY_MODEL_41d417cbbd5f492ea5f7418c68d70cde", "IPY_MODEL_4077e48289e14b57b9d9725cb7140373"], "layout": "IPY_MODEL_a3f5bc6a3875498f94168f3080bd8ef3", "tabbable": null, "tooltip": null}}, "ccd85703d1b24c3db07bc4fc5a1d46f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "bfc543975ecd4e1d9cfafbd7d26cfb1e": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "58fc6922e6cd4a57ba6920175899e63c": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_ccd85703d1b24c3db07bc4fc5a1d46f9", "max": 17.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_bfc543975ecd4e1d9cfafbd7d26cfb1e", "tabbable": null, "tooltip": null, "value": 17.0}}, "3616391b510248a1bae206da12f0bd47": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5f65ad29cd2d448686799faa6b0d4e94": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "d9460ff670254d78981e24ead9325967": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_3616391b510248a1bae206da12f0bd47", "placeholder": "\u200b", "style": "IPY_MODEL_5f65ad29cd2d448686799faa6b0d4e94", "tabbable": null, "tooltip": null, "value": "ms-muts\u2007\u2007(4/6)100%"}}, "01766696378b482788a950cfc999fca4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "63a64a9fbec44ae28bb3e1c77c3380ea": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "48d7836bb98047ac8760f8fedda740be": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_01766696378b482788a950cfc999fca4", "placeholder": "\u200b", "style": "IPY_MODEL_63a64a9fbec44ae28bb3e1c77c3380ea", "tabbable": null, "tooltip": null, "value": "\u200717.0/17.0\u2007[00:00,\u20072.83kit/s]"}}, "987fc4d230ac486b9ab444090bc31620": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "f5677227afa94c9facb1ecdf5d979fc7": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_d9460ff670254d78981e24ead9325967", "IPY_MODEL_58fc6922e6cd4a57ba6920175899e63c", "IPY_MODEL_48d7836bb98047ac8760f8fedda740be"], "layout": "IPY_MODEL_987fc4d230ac486b9ab444090bc31620", "tabbable": null, "tooltip": null}}, "f7bb92ffc6f6427f8faa1601c72318f1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f46e5a50dda7447caa16d0a4be85d5ef": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "e7ef411cd95844b795a97edc3fb00fb1": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f7bb92ffc6f6427f8faa1601c72318f1", "max": 200.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_f46e5a50dda7447caa16d0a4be85d5ef", "tabbable": null, "tooltip": null, "value": 200.0}}, "c89f1391a5b44266a680ea2279b6c0f0": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5fc555d6fea2476783e898c5352da36f": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "61bb9848da9948a5acf645d1637a00d2": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c89f1391a5b44266a680ea2279b6c0f0", "placeholder": "\u200b", "style": "IPY_MODEL_5fc555d6fea2476783e898c5352da36f", "tabbable": null, "tooltip": null, "value": "ms-match\u2007(5/6)100%"}}, "fc6442d9e06941bfa43ea56db2fadb90": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6540f4ba0186411c805f8d5eec67093d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "0c4ba0cde13848cf9244d5bebc8eb2a0": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fc6442d9e06941bfa43ea56db2fadb90", "placeholder": "\u200b", "style": "IPY_MODEL_6540f4ba0186411c805f8d5eec67093d", "tabbable": null, "tooltip": null, "value": "\u2007200/200\u2007[00:00,\u20074.33kit/s]"}}, "eab4004be3844803997839fdebea1eac": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "0742812de67447169fb9b229750ef7d6": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_61bb9848da9948a5acf645d1637a00d2", "IPY_MODEL_e7ef411cd95844b795a97edc3fb00fb1", "IPY_MODEL_0c4ba0cde13848cf9244d5bebc8eb2a0"], "layout": "IPY_MODEL_eab4004be3844803997839fdebea1eac", "tabbable": null, "tooltip": null}}, "ad1a0f22104947f380df4896b4e1f3b7": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "85d240213a2a42bcae2e4932ac19607a": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "ac9e5fa8fbba45419915fe90970432da": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_ad1a0f22104947f380df4896b4e1f3b7", "max": 200.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_85d240213a2a42bcae2e4932ac19607a", "tabbable": null, "tooltip": null, "value": 200.0}}, "1c6183b81ff94215a7ec0b5beacb2969": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "67214cbbfb4447b9aef43c40ba0653b2": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "29e2fa53a3374bc3ae290dd4f0031778": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_1c6183b81ff94215a7ec0b5beacb2969", "placeholder": "\u200b", "style": "IPY_MODEL_67214cbbfb4447b9aef43c40ba0653b2", "tabbable": null, "tooltip": null, "value": "ms-paths\u2007(6/6)100%"}}, "c215ad7c975f4de3af13ad2c04edbb5e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "38e94182da9b43c89b3e0dcd68674c4d": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "ae0f67ad85df4a0ab676d871c695ae92": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c215ad7c975f4de3af13ad2c04edbb5e", "placeholder": "\u200b", "style": "IPY_MODEL_38e94182da9b43c89b3e0dcd68674c4d", "tabbable": null, "tooltip": null, "value": "\u2007200/200\u2007[00:00,\u200723.2kit/s]"}}, "fe2b778f2c2e486981a833e68b6dd84c": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "cdc00f8811f245658341a75670029516": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_29e2fa53a3374bc3ae290dd4f0031778", "IPY_MODEL_ac9e5fa8fbba45419915fe90970432da", "IPY_MODEL_ae0f67ad85df4a0ab676d871c695ae92"], "layout": "IPY_MODEL_fe2b778f2c2e486981a833e68b6dd84c", "tabbable": null, "tooltip": null}}, "f1e2ec818abc4a1cb99304e71c26828d": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "4d339c34adb446c183b636759c8bf513": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "abdc4f802f304a44b4fd9d84f9452eae": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f1e2ec818abc4a1cb99304e71c26828d", "max": 17.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_4d339c34adb446c183b636759c8bf513", "tabbable": null, "tooltip": null, "value": 17.0}}, "fc0e2fcda6f74402a070ea85f20124ce": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e7bb2882d3da4152a6998dad4ce01193": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f63de508e4db416797aae01ff3b19879": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_fc0e2fcda6f74402a070ea85f20124ce", "placeholder": "\u200b", "style": "IPY_MODEL_e7bb2882d3da4152a6998dad4ce01193", "tabbable": null, "tooltip": null, "value": "ms-muts\u2007\u2007(7/6)100%"}}, "d632d4c7d6314dabb5aa1f656b7034d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "13969e216bd94a8c88e8fbe76a5aee38": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "195a635466b241d5afc0d9445e899d90": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_d632d4c7d6314dabb5aa1f656b7034d4", "placeholder": "\u200b", "style": "IPY_MODEL_13969e216bd94a8c88e8fbe76a5aee38", "tabbable": null, "tooltip": null, "value": "\u200717.0/17.0\u2007[00:00,\u20072.66kit/s]"}}, "13514766ffcd4f4380485317ec6d36c6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "4aa1309b3762429d850b84a5353171db": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_f63de508e4db416797aae01ff3b19879", "IPY_MODEL_abdc4f802f304a44b4fd9d84f9452eae", "IPY_MODEL_195a635466b241d5afc0d9445e899d90"], "layout": "IPY_MODEL_13514766ffcd4f4380485317ec6d36c6", "tabbable": null, "tooltip": null}}, "b54588e32ca84ea6a4fc05073fd7b768": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": "2", "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fe665768e34a4aa7a218bffbefcf0198": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "3a15782718a64487958aec2e101c9362": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_b54588e32ca84ea6a4fc05073fd7b768", "max": 3.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_fe665768e34a4aa7a218bffbefcf0198", "tabbable": null, "tooltip": null, "value": 3.0}}, "69af589dc4784b79bfd497e207adf93a": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "6296eef1e6f541b09669b84129264c40": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1b485748a5fe41f7b5a85cee6add0645": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_69af589dc4784b79bfd497e207adf93a", "placeholder": "\u200b", "style": "IPY_MODEL_6296eef1e6f541b09669b84129264c40", "tabbable": null, "tooltip": null, "value": "ms-xsites\u2007(8/6)100%"}}, "8724bbcf42fe4a5f8957856e141fa9e1": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ba4bc109e8e94380896fd6879d70e78b": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "42df550abaea4f46abe6b2644969ddc6": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_8724bbcf42fe4a5f8957856e141fa9e1", "placeholder": "\u200b", "style": "IPY_MODEL_ba4bc109e8e94380896fd6879d70e78b", "tabbable": null, "tooltip": null, "value": "\u20073.00/3.00\u2007[00:00,\u2007204it/s]"}}, "c5e70659b35043beb2e19e93176020b6": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": "inline-flex", "flex": null, "flex_flow": "row wrap", "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "100%"}}, "badae838ac7a4fe293dcc6e6746a8849": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_1b485748a5fe41f7b5a85cee6add0645", "IPY_MODEL_3a15782718a64487958aec2e101c9362", "IPY_MODEL_42df550abaea4f46abe6b2644969ddc6"], "layout": "IPY_MODEL_c5e70659b35043beb2e19e93176020b6", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Inference overview" href="inference.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <script data-goatcounter="https://tskit.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/tsinfer_logo.svg" class="logo__image only-light" alt="Tsinfer manual - Home"/>
    <script>document.write(`<img src="_static/tsinfer_logo.svg" class="logo__image only-dark" alt="Tsinfer manual - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Usage</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Inference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="inference.html">Inference overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="large_scale.html">Large Scale Inference</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interfaces</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">File Formats</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="file_formats.html">File formats</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="development.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="CITATION.html">Citing tsinfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/usage.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Usage</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#toy-example">Toy example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variantdata-and-ancestral-alleles">VariantData and ancestral alleles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topology-inference">Topology inference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-example">Simulation example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-example">Data example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-vcf">Reading a VCF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-metadata">Adding more metadata</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="usage">
<span id="sec-usage"></span><h1>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h1>
<section id="toy-example">
<span id="sec-usage-toy-example"></span><h2>Toy example<a class="headerlink" href="#toy-example" title="Link to this heading">#</a></h2>
<p><em>Tsinfer</em> takes as input a <a class="reference external" href="https://zarr.readthedocs.io/">Zarr</a> file, with phased variant data encoded in the
<a class="reference external" href="https://github.com/sgkit-dev/vcf-zarr-spec/">VCF Zarr</a> (.vcz) format. The standard
route to create such a file is by conversion from a VCF file, e.g. using
<a class="reference external" href="https://sgkit-dev.github.io/bio2zarr/vcf2zarr/overview.html">vcf2zarr</a> as described later in this
document. However, for the moment we’ll just use a pre-generated dataset:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>
<span class="n">vcf_zarr</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;_static/example_data.vcz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This is what the genotypes stored in that datafile look like:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Diploid sample id:     0           1           2      
Genome for sample:   0    1      0    1      0    1    
------------------------------------------------------
      position 16:   T    T      T    G      T    G      
      position 44:   G    G      G    G      T    T      
      position 50:   G    G      G    C      C    C      
      position 55:   A    T      T    T      A    T      
      position 71:   C    C      C    C      C    C      
      position 75:   T    T      T    A      T    T      
      position 85:   C    G      G    C      C    C      
      position 95:   AGGT AGGT   A    AGGT   AGGT AGGT   
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The last site, at position 95, is an indel (insertion or deletion). Indels can be used as long as the indel does not overlap with other variants, only 2 alleles exist, and the ancestral state is known.</p>
</div>
<section id="variantdata-and-ancestral-alleles">
<h3>VariantData and ancestral alleles<a class="headerlink" href="#variantdata-and-ancestral-alleles" title="Link to this heading">#</a></h3>
<p>We wish to infer a genealogy that could have given rise to this data set. To run <em>tsinfer</em>
we wrap the <code class="docutils literal notranslate"><span class="pre">.vcz</span></code> file in a <a class="reference internal" href="api.html#tsinfer.VariantData" title="tsinfer.VariantData"><code class="xref py py-class docutils literal notranslate"><span class="pre">tsinfer.VariantData</span></code></a> object. This requires an
<em>ancestral state</em> to be specified for each site; there are
many methods for calculating these: details are outside the scope of this manual, but we
have started a <a class="reference external" href="https://github.com/tskit-dev/tsinfer/discussions/523">discussion topic</a>
on this issue to provide some recommendations.</p>
<p>Sometimes VCF files will contain the
ancestral state in the “AA” (“ancestral allele”) info field, in which case it will be encoded
in the <code class="docutils literal notranslate"><span class="pre">variant_AA</span></code> field of the .vcz file. It’s also possible to provide a numpy array
of ancestral alleles, of the same length as the number of selected variants. If you have a string
of the ancestral states (e.g. from FASTA) the <a class="reference internal" href="api.html#tsinfer.add_ancestral_state_array" title="tsinfer.add_ancestral_state_array"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_ancestral_state_array()</span></code></a>
method can be used to convert and save this to the VCF Zarr dataset (under the name
<code class="docutils literal notranslate"><span class="pre">ancestral_state</span></code>). Note that this method assumes that the string uses zero-based
indexing, so that the first letter corresponds to a site at position 0. If,
as is typical, the first letter in the string denotes the ancestral state of
the site at position 1 in the .vcz file, you should prepend an “X” to the string.
Alleles that are not in the list of alleles for their respective site are
treated as unknown and not used for inference (with a warning given).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tsinfer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyfaidx</span>

<span class="n">vcf_zarr</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;_static/example_data.vcz&quot;</span><span class="p">)</span>

<span class="n">reader</span> <span class="o">=</span> <span class="n">pyfaidx</span><span class="o">.</span><span class="n">Fasta</span><span class="p">(</span><span class="s2">&quot;_static/example_ancestral_state.fa&quot;</span><span class="p">)</span>
<span class="n">ancestral_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">reader</span><span class="p">[</span><span class="s2">&quot;chr1&quot;</span><span class="p">])</span>
<span class="c1"># Our positions are zero-based, if they were one-based we would</span>
<span class="c1"># prepend an X here.</span>
<span class="c1"># e.g. ancestral_str = &quot;X&quot; + ancestral_str</span>

<span class="c1"># Set the ancestral state at the last known position to &quot;N&quot;, for demonstration</span>
<span class="n">last_pos</span> <span class="o">=</span> <span class="n">vcf_zarr</span><span class="p">[</span><span class="s1">&#39;variant_position&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ancestral_str</span> <span class="o">=</span> <span class="n">ancestral_str</span><span class="p">[:</span><span class="n">last_pos</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;N&quot;</span> <span class="o">+</span> <span class="n">ancestral_str</span><span class="p">[(</span><span class="n">last_pos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):]</span>

<span class="n">tsinfer</span><span class="o">.</span><span class="n">add_ancestral_state_array</span><span class="p">(</span><span class="n">vcf_zarr</span><span class="p">,</span> <span class="n">ancestral_str</span><span class="p">)</span> 
<span class="n">vdata</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">VariantData</span><span class="p">(</span><span class="s2">&quot;_static/example_data.vcz&quot;</span><span class="p">,</span> <span class="n">ancestral_state</span><span class="o">=</span><span class="s2">&quot;ancestral_state&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference internal" href="api.html#tsinfer.VariantData" title="tsinfer.VariantData"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariantData</span></code></a> object is a lightweight wrapper around the .vcz file.
We’ll use it to infer a tree sequence on the basis of the sites that vary between the
different samples. However, note that certain sites are not used by <em>tsinfer</em> for inferring
the genealogy (although they are still encoded in the final tree sequence), These are:</p>
<ul class="simple">
<li><p>Non-variable (fixed) sites, e.g. the site at position 71 above</p></li>
<li><p>Singleton sites, where only one genome has the derived allele
e.g. the site at position 75 above</p></li>
<li><p>Sites where the ancestral allele is unknown, e.g. demonstrated above when setting the
ancestral state of the site at position 95 to <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p></li>
<li><p>Multialleleic sites, with more than 2 alleles (but see
<a class="reference external" href="https://github.com/tskit-dev/tsinfer/issues/670">here</a> for a workaround)</p></li>
</ul>
<p>Additionally, during the inference step, additional sites can be flagged as not for use in
inference, for example if they are deemed unreliable (this is done
via the <code class="docutils literal notranslate"><span class="pre">exclude_positions</span></code> parameter).</p>
<p>Sites which are not used for inference will
still be included in the final tree sequence, with mutations at those sites being placed
onto branches by <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.Tree.map_mutations" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parsimony</span></code></a>.</p>
</section>
<section id="topology-inference">
<h3>Topology inference<a class="headerlink" href="#topology-inference" title="Link to this heading">#</a></h3>
<p>Once we have stored our data in a <code class="docutils literal notranslate"><span class="pre">.VariantData</span></code> object, we can easily infer
a <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#sec-python-api-trees-and-tree-sequences" title="(in Project name not set)"><span class="xref std std-ref">tree sequence</span></a> using the Python
API. Note that each sample in the original .vcz file will correspond to an <em>individual</em>
in the resulting tree sequence. Since these three individuals are diploid, the resulting
tree sequence will have <code class="docutils literal notranslate"><span class="pre">ts.num_samples</span> <span class="pre">==</span> <span class="pre">6</span></code> (i.e. unlike in a .vcz file, a “sample” in
tskit refers to a haploid genome, not a diploid individual).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inferred_ts</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inferred a genetic genealogy for </span><span class="si">{</span><span class="n">inferred_ts</span><span class="o">.</span><span class="n">num_samples</span><span class="si">}</span><span class="s2"> (haploid) genomes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inferred a genetic genealogy for 6 (haploid) genomes
</pre></div>
</div>
</div>
</div>
<p>And that’s it: we now have a fully functional <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tskit.TreeSequence</span></code></a>
object that we can interrogate in the usual ways. For example, we can look
at the <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.variants" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">variants</span></code></a> in the tree sequence:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TS sample&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">()),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TS individual&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">inferred_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">individual</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">()),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pos (anc state)&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">variants</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="si">}</span><span class="s2">   (</span><span class="si">{</span><span class="n">v</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">ancestral_state</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">a</span><span class="si">:</span><span class="s2">&lt;4</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">alleles</span><span class="p">)[</span><span class="n">v</span><span class="o">.</span><span class="n">genotypes</span><span class="p">]),</span>
        <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TS sample	0	1	2	3	4	5
TS individual	0	0	1	1	2	2
------------------------------------------------------------
Pos (anc state)
16   (G)	T   	T   	T   	G   	T   	G   
44   (G)	G   	G   	G   	G   	T   	T   
50   (C)	G   	G   	G   	C   	C   	C   
55   (T)	A   	T   	T   	T   	A   	T   
71   (C)	C   	C   	C   	C   	C   	C   
75   (A)	T   	T   	T   	A   	T   	T   
85   (G)	C   	G   	G   	C   	C   	C   
95   (AGGT)	AGGT	AGGT	A   	AGGT	AGGT	AGGT
</pre></div>
</div>
</div>
</div>
<p>Comparing the genotypes of each individual in the inferred tree sequence
against the equivalent diploid samples in the .vcz file, you can see that they
are identical. Apart from the imputation of
<a class="reference internal" href="inference.html#sec-inference-data-requirements"><span class="std std-ref">missing data</span></a>, <em>tsinfer</em> is guaranteed to
losslessly encode any genetic variation data, regardless of the inferred topology. You can
check this programatically if you want:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="k">for</span> <span class="n">v_orig</span><span class="p">,</span> <span class="n">v_inferred</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vdata</span><span class="o">.</span><span class="n">variants</span><span class="p">(),</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">variants</span><span class="p">()):</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_orig</span><span class="o">.</span><span class="n">alleles</span><span class="p">)[</span><span class="n">v_orig</span><span class="o">.</span><span class="n">genotypes</span><span class="p">]</span> <span class="o">!=</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v_inferred</span><span class="o">.</span><span class="n">alleles</span><span class="p">)[</span><span class="n">v_inferred</span><span class="o">.</span><span class="n">genotypes</span><span class="p">]</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Genotypes in original dataset and inferred tree seq not equal&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;** Genotypes in original dataset and inferred tree sequence are the same **&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>** Genotypes in original dataset and inferred tree sequence are the same **
</pre></div>
</div>
</div>
</div>
<p>We can examine the inferred genetic genealogy, in the form of
<a class="reference external" href="https://tskit.dev/tutorials/what_is.html#sec-what-is-local-trees" title="(in Project name not set)"><span class="xref std std-ref">local trees</span></a>. <em>Tsinfer</em> has
placed mutations on the genealogy to explain the observed genetic variation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mut_labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">m</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:g}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">→</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">s</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
        <span class="n">inferred_ts</span><span class="o">.</span><span class="n">mutation</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span><span class="o">.</span><span class="n">derived_state</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">parent</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">ancestral_state</span><span class="p">,</span>
        <span class="n">m</span><span class="o">.</span><span class="n">derived_state</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">sites</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">mutations</span>
<span class="p">}</span>
<span class="n">node_labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">u</span><span class="p">:</span> <span class="n">u</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">()}</span>

<span class="n">inferred_ts</span><span class="o">.</span><span class="n">draw_svg</span><span class="p">(</span>
    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">canvas_size</span><span class="o">=</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">node_labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">,</span>
    <span class="n">mutation_labels</span><span class="o">=</span><span class="n">mut_labels</span><span class="p">,</span>
    <span class="n">y_axis</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f02477f5342e018279b47ee58555ae5f35ba7238f4f1f8166461d4877d0c0cd4.svg" src="_images/f02477f5342e018279b47ee58555ae5f35ba7238f4f1f8166461d4877d0c0cd4.svg" />
</div>
</div>
<p>We have inferred 4 trees aong the genome. Note, however, that there are “polytomies” in the
trees, where some nodes have more than two children (e.g. the root node in the first tree).
This is a common feature of trees inferred by <em>tsinfer</em> and signals that there was not
sufficient information to resolve the tree at this internal node.</p>
<p>Each internal (non-sample) node in this inferred tree represents an ancestral sequence,
constructed on the basis of shared, derived alleles at one or more of the sites. By
default, the time of each such node is <em>not</em> measured in years or generations, but
is simply the frequency of the shared derived allele(s) on which the ancestral sequence
is based. For this reason, the time units are described as “uncalibrated” in the plot,
and trying to calculate statistics based on branch lengths will raise an error:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inferred_ts</span><span class="o">.</span><span class="n">diversity</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">LibraryError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">/tmp/ipykernel_3129/2935518142.py</span> in <span class="ni">?</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">inferred_ts</span><span class="o">.</span><span class="n">diversity</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;branch&quot;</span><span class="p">)</span>

<span class="nn">~/work/tskit-site/tskit-site/.venv/lib/python3.11/site-packages/tskit/trees.py</span> in <span class="ni">?</span><span class="nt">(self, sample_sets, windows, mode, span_normalise)</span>
<span class="g g-Whitespace">   </span><span class="mi">8228</span>             <span class="n">window</span> <span class="p">(</span><span class="n">defaults</span> <span class="n">to</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">8229</span>         <span class="p">:</span><span class="k">return</span><span class="p">:</span> <span class="n">A</span> <span class="n">numpy</span> <span class="n">array</span> <span class="n">whose</span> <span class="n">length</span> <span class="ow">is</span> <span class="n">equal</span> <span class="n">to</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">sample</span> <span class="n">sets</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">8230</span>             <span class="n">If</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">one</span> <span class="n">sample</span> <span class="nb">set</span> <span class="ow">and</span> <span class="n">windows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">a</span> <span class="n">numpy</span> <span class="n">scalar</span> <span class="ow">is</span> <span class="n">returned</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">8231</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">8232</span><span class="s2">         return self.__one_way_sample_set_stat(</span>
<span class="g g-Whitespace">   </span><span class="mi">8233</span><span class="s2">             self._ll_tree_sequence.diversity,</span>
<span class="g g-Whitespace">   </span><span class="mi">8234</span><span class="s2">             sample_sets,</span>
<span class="g g-Whitespace">   </span><span class="mi">8235</span><span class="s2">             windows=windows,</span>

<span class="nn">~/work/tskit-site/tskit-site/.venv/lib/python3.11/site-packages/tskit/trees.py</span> in <span class="ni">?</span><span class="nt">(self, ll_method, sample_sets, windows, mode, span_normalise, polarised)</span>
<span class="g g-Whitespace">   </span><span class="mi">7935</span><span class="s2">         if np.any(sample_set_sizes == 0):</span>
<span class="g g-Whitespace">   </span><span class="mi">7936</span><span class="s2">             raise ValueError(&quot;Sample sets must contain at least one element&quot;)</span>
<span class="g g-Whitespace">   </span><span class="mi">7937</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">7938</span><span class="s2">         flattened = util.safe_np_int_cast(np.hstack(sample_sets), np.int32)</span>
<span class="ne">-&gt; </span><span class="mi">7939</span><span class="s2">         stat = self.__run_windowed_stat(</span>
<span class="g g-Whitespace">   </span><span class="mi">7940</span><span class="s2">             windows,</span>
<span class="g g-Whitespace">   </span><span class="mi">7941</span><span class="s2">             ll_method,</span>
<span class="g g-Whitespace">   </span><span class="mi">7942</span><span class="s2">             sample_set_sizes,</span>

<span class="nn">~/work/tskit-site/tskit-site/.venv/lib/python3.11/site-packages/tskit/trees.py</span> in <span class="ni">?</span><span class="nt">(self, windows, method, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">7898</span><span class="s2">     def __run_windowed_stat(self, windows, method, *args, **kwargs):</span>
<span class="g g-Whitespace">   </span><span class="mi">7899</span><span class="s2">         strip_dim = windows is None</span>
<span class="g g-Whitespace">   </span><span class="mi">7900</span><span class="s2">         windows = self.parse_windows(windows)</span>
<span class="ne">-&gt; </span><span class="mi">7901</span><span class="s2">         stat = method(*args, **kwargs, windows=windows)</span>
<span class="g g-Whitespace">   </span><span class="mi">7902</span><span class="s2">         if strip_dim:</span>
<span class="g g-Whitespace">   </span><span class="mi">7903</span><span class="s2">             stat = stat[0]</span>
<span class="g g-Whitespace">   </span><span class="mi">7904</span><span class="s2">         return stat</span>

<span class="ne">LibraryError</span>: Statistics using branch lengths cannot be calculated when time_units is &#39;uncalibrated&#39;. (TSK_ERR_TIME_UNCALIBRATED)
</pre></div>
</div>
</div>
</div>
<p>To add meaningful dates to an inferred tree sequence, allowing meaningful branch length
statistics to be calulated, you must use additional
software such as <a class="reference external" href="https://tskit.dev/software/tsdate.html">tsdate</a>: the <em>tsinfer</em>
algorithm is only intended to infer the genetic relationships between the samples
(i.e. the <em>topology</em> of the tree sequence).</p>
</section>
<section id="masks">
<h3>Masks<a class="headerlink" href="#masks" title="Link to this heading">#</a></h3>
<p>It is possible to <em>completely</em> exclude sites and samples, by specifing a boolean
<code class="docutils literal notranslate"><span class="pre">site_mask</span></code> and/or a <code class="docutils literal notranslate"><span class="pre">sample_mask</span></code> when creating the <code class="docutils literal notranslate"><span class="pre">VariantData</span></code> object. Sites or samples with
a mask value of <code class="docutils literal notranslate"><span class="pre">True</span></code> will be completely omitted both from inference and the final tree sequence.
This can be useful, for example, if you wish to select only a subset of the chromosome for
inference, e.g. to reduce computational load. You can also use it to subset inference to a
particular contig, if your dataset contains multiple contigs. Note that if a <code class="docutils literal notranslate"><span class="pre">site_mask</span></code> is provided,
the ancestral states array should only specify alleles for the unmasked sites.</p>
<p>Below, for instance, is an example of including only sites up to position six in the contig
labelled “chr1” in the <code class="docutils literal notranslate"><span class="pre">example_data.vcz</span></code> file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>

<span class="n">vcf_zarr</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;_static/example_data.vcz&quot;</span><span class="p">)</span>

<span class="c1"># mask out any sites not associated with the contig named &quot;chr1&quot;</span>
<span class="c1"># (for demonstration: all sites in this .vcz file are from &quot;chr1&quot; anyway)</span>
<span class="n">chr1_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">vcf_zarr</span><span class="o">.</span><span class="n">contig_id</span><span class="p">[:]</span> <span class="o">==</span> <span class="s2">&quot;chr1&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">site_mask</span> <span class="o">=</span> <span class="n">vcf_zarr</span><span class="o">.</span><span class="n">variant_contig</span><span class="p">[:]</span> <span class="o">!=</span> <span class="n">chr1_index</span>
<span class="c1"># also mask out any sites with a position &gt;= 80</span>
<span class="n">site_mask</span><span class="p">[</span><span class="n">vcf_zarr</span><span class="o">.</span><span class="n">variant_position</span><span class="p">[:]</span> <span class="o">&gt;=</span> <span class="mi">80</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">smaller_vdata</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">VariantData</span><span class="p">(</span>
    <span class="s2">&quot;_static/example_data.vcz&quot;</span><span class="p">,</span>
    <span class="n">ancestral_state</span><span class="o">=</span><span class="s2">&quot;ancestral_state&quot;</span><span class="p">,</span>
    <span class="n">site_mask</span><span class="o">=</span><span class="n">site_mask</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The `smaller_vdata` object returns data for only </span><span class="si">{</span><span class="n">smaller_vdata</span><span class="o">.</span><span class="n">num_sites</span><span class="si">}</span><span class="s2"> sites&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The `smaller_vdata` object returns data for only 6 sites
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="simulation-example">
<span id="sec-usage-simulation-example"></span><h2>Simulation example<a class="headerlink" href="#simulation-example" title="Link to this heading">#</a></h2>
<p>The previous example showed how we can infer a tree sequence using the Python API for a trivial
toy example. However, for real data we will not prepare our data and infer the tree sequence all
in one go; rather, we will usually split the process into at least two distinct steps.</p>
<p>The first step in any inference is to prepare your data and create the .vcz file.
For simplicity here we’ll use
Python to simulate some data under the coalescent with recombination, using
<a class="reference external" href="https://msprime.readthedocs.io/en/stable/api.html#msprime.simulate">msprime</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">builtins</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">Bio</span><span class="w"> </span><span class="kn">import</span> <span class="n">bgzf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">msprime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tsinfer</span>

<span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">builtins</span><span class="p">,</span> <span class="s2">&quot;__IPYTHON__&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>  <span class="c1"># if running IPython: e.g. in a notebook</span>
    <span class="n">num_diploids</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10_000</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;notebook-simulation&quot;</span>
    <span class="n">python</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span>
<span class="k">else</span><span class="p">:</span>  <span class="c1"># Take parameters from the command-line</span>
    <span class="n">num_diploids</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;cli-simulation&quot;</span>
    <span class="n">python</span> <span class="o">=</span> <span class="s2">&quot;python&quot;</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="o">.</span><span class="n">sim_ancestry</span><span class="p">(</span>
    <span class="n">num_diploids</span><span class="p">,</span>
    <span class="n">population_size</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">recombination_rate</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
    <span class="n">sequence_length</span><span class="o">=</span><span class="n">seq_len</span><span class="p">,</span>
    <span class="n">random_seed</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">msprime</span><span class="o">.</span><span class="n">sim_mutations</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="n">ts</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;-source.trees&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Simulated </span><span class="si">{</span><span class="n">ts</span><span class="o">.</span><span class="n">num_samples</span><span class="si">}</span><span class="s2"> samples over </span><span class="si">{</span><span class="n">seq_len</span><span class="o">/</span><span class="mf">1e6</span><span class="si">}</span><span class="s2"> Mb:&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ts</span><span class="o">.</span><span class="n">num_trees</span><span class="si">}</span><span class="s2"> trees and </span><span class="si">{</span><span class="n">ts</span><span class="o">.</span><span class="n">num_sites</span><span class="si">}</span><span class="s2"> sites&quot;</span>
<span class="p">)</span>

<span class="c1"># Convert to a zarr file: this should be easier once a tskit2zarr utility is made, see</span>
<span class="c1"># https://github.com/sgkit-dev/bio2zarr/issues/232</span>
<span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">-AA.npy&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">ancestral_state</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">ts</span><span class="o">.</span><span class="n">sites</span><span class="p">()])</span>
<span class="n">vcf_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.vcf.gz&quot;</span>
<span class="k">with</span> <span class="n">bgzf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">vcf_name</span><span class="p">,</span> <span class="s2">&quot;wt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">write_vcf</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;tabix&quot;</span><span class="p">,</span> <span class="n">vcf_name</span><span class="p">])</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="p">[</span><span class="n">python</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;bio2zarr&quot;</span><span class="p">,</span> <span class="s2">&quot;vcf2zarr&quot;</span><span class="p">,</span> <span class="s2">&quot;convert&quot;</span><span class="p">,</span> <span class="s2">&quot;--force&quot;</span><span class="p">,</span> <span class="n">vcf_name</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.vcz&quot;</span><span class="p">],</span>
    <span class="n">stderr</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span> <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;notebook-simulation&quot;</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.vcz&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">ret</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Converted to </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.vcz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Simulated 200 samples over 0.01 Mb: 20 trees and 20 sites
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Converted to notebook-simulation.vcz
</pre></div>
</div>
</div>
</div>
<p>Here we first run a simulation then we create a vcf file and convert it to .vcz format.
If we store this code in a file named <code class="docutils literal notranslate"><span class="pre">simulate-data.py</span></code>, we can run it on the
command line, providing parameters to generate much bigger datasets:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>python<span class="w"> </span>simulate-data.py<span class="w"> </span><span class="m">5000</span><span class="w"> </span>10_000_000
Simulated<span class="w"> </span><span class="m">10000</span><span class="w"> </span>samples<span class="w"> </span>over<span class="w"> </span><span class="m">10</span>.0<span class="w"> </span>Mb:<span class="w"> </span><span class="m">36204</span><span class="w"> </span>trees<span class="w"> </span>and<span class="w"> </span><span class="m">38988</span><span class="w"> </span>sites
<span class="w">    </span>Scan:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">1</span>.00/1.00<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">2</span>.86files/s<span class="o">]</span>
<span class="w"> </span>Explode:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">39</span>.0k/39.0k<span class="w"> </span><span class="o">[</span><span class="m">01</span>:17&lt;<span class="m">00</span>:00,<span class="w"> </span>501vars/s<span class="o">]</span>
<span class="w">  </span>Encode:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>███████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span>976M/976M<span class="w"> </span><span class="o">[</span><span class="m">00</span>:12&lt;<span class="m">00</span>:00,<span class="w"> </span><span class="m">78</span>.0MB/s<span class="o">]</span>
Finalise:<span class="w"> </span><span class="m">100</span>%<span class="p">|</span>█████████████████████████████████████████████████████████████████████<span class="p">|</span><span class="w"> </span><span class="m">10</span>.0/10.0<span class="w"> </span><span class="o">[</span><span class="m">00</span>:00&lt;<span class="m">00</span>:00,<span class="w"> </span>421array/s<span class="o">]</span>
</pre></div>
</div>
<p>Here, we simulated a sample of 10 thousand chromosomes, each 10Mb long, under
human-like parameters. That has created 39K segregating sites. The output
above shows the state of the vcf-to-zarr conversion at the end of this process,
indicating that it took about a minute to convert the data into .vcz format
(this only needs doing once)</p>
<p>Examining the files on the command line, we then see the following::</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>du<span class="w"> </span>-sh<span class="w"> </span>cli-simulation*
156K<span class="w">	</span>cli-simulation-AA.npy
<span class="m">8</span>.8M<span class="w">	</span>cli-simulation-source.trees
<span class="w"> </span>25M<span class="w">	</span>cli-simulation.vcf.gz
<span class="m">8</span>.0K<span class="w">	</span>cli-simulation.vcf.gz.tbi
<span class="m">9</span>.4M<span class="w">	</span>cli-simulation.vcz
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cli-simulation.vcz</span></code> zarr data is quite small, about the same size as the
original <code class="docutils literal notranslate"><span class="pre">msprime</span></code> tree sequence file. Since (like all zarr datastores)
<code class="docutils literal notranslate"><span class="pre">cli-simulation.vcz</span></code> is a directory
we can peer inside to look where everything is stored:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>du<span class="w"> </span>-sh<span class="w"> </span>cli-simulation.vcz/*
<span class="m">8</span>.7M<span class="w">	</span>cli-simulation.vcz/call_genotype
<span class="w"> </span>88K<span class="w">	</span>cli-simulation.vcz/call_genotype_mask
<span class="w"> </span>88K<span class="w">	</span>cli-simulation.vcz/call_genotype_phased
<span class="w"> </span>12K<span class="w">	</span>cli-simulation.vcz/contig_id
<span class="w"> </span>12K<span class="w">	</span>cli-simulation.vcz/contig_length
<span class="w"> </span>12K<span class="w">	</span>cli-simulation.vcz/filter_id
<span class="w"> </span>28K<span class="w">	</span>cli-simulation.vcz/sample_id
<span class="w"> </span>52K<span class="w">	</span>cli-simulation.vcz/variant_allele
<span class="w"> </span>24K<span class="w">	</span>cli-simulation.vcz/variant_contig
<span class="w"> </span>24K<span class="w">	</span>cli-simulation.vcz/variant_filter
<span class="w"> </span>48K<span class="w">	</span>cli-simulation.vcz/variant_id
<span class="w"> </span>24K<span class="w">	</span>cli-simulation.vcz/variant_id_mask
144K<span class="w">	</span>cli-simulation.vcz/variant_position
<span class="w"> </span>24K<span class="w">	</span>cli-simulation.vcz/variant_quality
</pre></div>
</div>
<p>Most of this output is not particularly interesting here, but we can see that the
<code class="docutils literal notranslate"><span class="pre">call_genotype</span></code> array which holds all of the sample genotypes (and thus the vast bulk of the
actual data) only requires about 8.7MB compared to 25MB for the compressed vcf file.
In practice this means we can keep such files lying around without taking up too much space.</p>
<p>Once we have our <code class="docutils literal notranslate"><span class="pre">.vcz</span></code> file created, running the inference is straightforward.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Infer &amp; save a ts from the notebook simulation.</span>
<span class="n">ancestral_states</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">-AA.npy&quot;</span><span class="p">)</span>
<span class="n">vdata</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">VariantData</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.vcz&quot;</span><span class="p">,</span> <span class="n">ancestral_states</span><span class="p">)</span>
<span class="n">tsinfer</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">vdata</span><span class="p">,</span> <span class="n">progress_monitor</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;.trees&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "5913c50c83c2417a85a3f839fdd2ef6e"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "202c102326b3446eb99918aba7321913"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "efddebe6aa274aae879af9a28496478d"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "f5677227afa94c9facb1ecdf5d979fc7"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "0742812de67447169fb9b229750ef7d6"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "cdc00f8811f245658341a75670029516"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4aa1309b3762429d850b84a5353171db"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "badae838ac7a4fe293dcc6e6746a8849"}</script></div>
</div>
<p>Running the <code class="docutils literal notranslate"><span class="pre">infer</span></code> command runs the full inference pipeline in one go (the individual steps
are explained <a class="reference internal" href="inference.html#sec-inference"><span class="std std-ref">here</span></a>). We provided two extra arguments to <code class="docutils literal notranslate"><span class="pre">infer</span></code>:
<code class="docutils literal notranslate"><span class="pre">progress_monitor</span></code> gives us the progress bars show above, and <code class="docutils literal notranslate"><span class="pre">num_threads=4</span></code> tells
<em>tsinfer</em> to use four worker threads whenever it can use them.</p>
<p>Performing this inference on the <code class="docutils literal notranslate"><span class="pre">cli-simulation</span></code> data using Core i5 processor (launched 2009)
with 4GiB of RAM, took about eighteen minutes. The maximum memory usage was about 600MiB.</p>
<p>The output files look like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ls<span class="w"> </span>-lh<span class="w"> </span>cli-simulation*
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>user<span class="w">  </span>group<span class="w">   </span><span class="m">8</span>.2M<span class="w"> </span><span class="m">14</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">13</span>:45<span class="w"> </span>cli-simulation-source.trees
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>user<span class="w">  </span>group<span class="w">    </span>22M<span class="w"> </span><span class="m">14</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">13</span>:45<span class="w"> </span>cli-simulation.samples
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>user<span class="w">  </span>group<span class="w">   </span><span class="m">8</span>.1M<span class="w"> </span><span class="m">14</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">13</span>:50<span class="w"> </span>cli-simulation.trees
</pre></div>
</div>
<p>Therefore our output tree sequence file that we have just inferred in a few minutes is
<em>even smaller</em> than the original <code class="docutils literal notranslate"><span class="pre">msprime</span></code> simulated tree sequence!
Because the output file is also a <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tskit.TreeSequence</span></code></a>, we can use the same API
to work with both. For example, to load up the original and inferred tree sequences
from their corresponding <code class="docutils literal notranslate"><span class="pre">.trees</span></code> files you can simply use the <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.load" title="(in Project name not set)"><code class="xref py py-func docutils literal notranslate"><span class="pre">tskit.load()</span></code></a>
function, as shown below.</p>
<p>However, there are thousands of trees in these tree sequences, each of which has
10 thousand samples: much too much to easily visualise. Therefore, in the code below, we
we subset both tree sequences down to their minimal representations for the first six
sample nodes using <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.simplify" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tskit.TreeSequence.simplify()</span></code></a>, while keeping all sites, even if
they do not show genetic variation between the six selected samples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using this tiny subset of the overall data allows us to get an informal
feel for the trees that are inferred by <em>tsinfer</em>, but this is certainly
not a recommended approach for validating the inference!</p>
</div>
<p>Once we’ve subsetted the tree sequences down to something that we can comfortably look
at, we can plot the trees in particular regions of interest, for example the first
2kb of genome. Below, for simplicity we use the smaller dataset that was simulated and
inferred within the the notebook, but exactly the same code will work with
the larger version run from the cli simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tskit</span>

<span class="n">subset</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># show first 6 samples</span>
<span class="n">limit</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2_000</span><span class="p">)</span>    <span class="c1"># show only the trees covering the first 2kb</span>

<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;notebook&quot;</span>  <span class="c1"># Or use &quot;cli&quot; for the larger example</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">tskit</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;-simulation-source.trees&quot;</span><span class="p">)</span>
<span class="n">source_subset</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">filter_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True tree seq, simplified to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="si">}</span><span class="s2"> sampled genomes&quot;</span><span class="p">)</span>
<span class="n">source_subset</span><span class="o">.</span><span class="n">draw_svg</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">x_lim</span><span class="o">=</span><span class="n">limit</span><span class="p">,</span> <span class="n">time_scale</span><span class="o">=</span><span class="s2">&quot;rank&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True tree seq, simplified to 6 sampled genomes
</pre></div>
</div>
<img alt="_images/7b4875b7f516e6ba9ecda51d4c74691339006862bf3feb48b547cefa6ed48270.svg" src="_images/7b4875b7f516e6ba9ecda51d4c74691339006862bf3feb48b547cefa6ed48270.svg" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inferred</span> <span class="o">=</span> <span class="n">tskit</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="s2">&quot;-simulation.trees&quot;</span><span class="p">)</span>
<span class="n">inferred_subset</span> <span class="o">=</span> <span class="n">inferred</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">subset</span><span class="p">,</span> <span class="n">filter_sites</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inferred tree seq, simplified to </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span><span class="si">}</span><span class="s2"> sampled genomes&quot;</span><span class="p">)</span>
<span class="n">inferred_subset</span><span class="o">.</span><span class="n">draw_svg</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">800</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">x_lim</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inferred tree seq, simplified to 6 sampled genomes
</pre></div>
</div>
<img alt="_images/eb9853b6da8fb56bd43f71c5929c4a5f1c443b1446785e9d4807e94c67198a1c.svg" src="_images/eb9853b6da8fb56bd43f71c5929c4a5f1c443b1446785e9d4807e94c67198a1c.svg" />
</div>
</div>
<p>There are a number of things to note when comparing the plots above. Most
obviously, the first tree in the inferred tree sequence is empty: by default, <em>tsinfer</em>
will not generate a genealogy before the first site in the genome (here, position 655)
or past the last site, as there is, by definition, no data in these regions.</p>
<p>You can also see that the inferred tree sequence has fewer trees than the original,
simulated one. There are two reasons for this. First, there are some tree changes that
do not involve a change of topology (e.g. the first two trees in the original tree
sequence are topologically identical, as are two trees after that).
Even if we had different mutations on the
different edges in these trees, such tree changes are unlikely to be spotted.
Second, our inference depends on the mutational information that is present. If no
mutations fall on a particular edge in the tree sequence, then we have no way of
inferring that this edge existed. The fact that there are no mutations in the first,
third, and fifth trees shows that tree changes can occur without associated mutations.
As a result, there will be tree transitions that we cannot pick up. In the simulation
that we performed, the mutation rate is equal to the recombination rate, and so we
expect that many recombinations will be invisible to us.</p>
<p>For similar reasons, there will be many nodes in the tree at which
polytomies occur. Here we correctly infer that sample nodes 0 and 4 group together,
as do 1 and 2. However, in the middle inferred tree we were not able to distinguish
whether node 3 was closer to node 1 or 2, so we have three children of node 7 in that
tree.</p>
<p>Finally, you should note that inference does not always get the right answer. At the
first site in the inferred trees, node 5 is placed as an outgroup, but at this site
it is actually closer to the group consisting of nodes 0 and 4.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Other than the sample node IDs, it is meaningless to compare node numbers in the
source and inferred tree sequences.</p>
</div>
</section>
<section id="data-example">
<span id="sec-usage-data-example"></span><h2>Data example<a class="headerlink" href="#data-example" title="Link to this heading">#</a></h2>
<p>Inputting real data for inference is similar in principle to the examples above.
All that is required is a .vcz file, which can be created using
<a class="reference external" href="https://sgkit-dev.github.io/bio2zarr/vcf2zarr/overview.html">vcf2zarr</a> as above</p>
<section id="reading-a-vcf">
<span id="sec-usage-read-vcf"></span><h3>Reading a VCF<a class="headerlink" href="#reading-a-vcf" title="Link to this heading">#</a></h3>
<p>For example data, we use a publicly available VCF file of the genetic
variants from chromosome 24 of ten Norwegian and French house sparrows,
<em>Passer domesticus</em> (thanks to Mark Ravinet for the data file):</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>

<span class="n">vcf_location</span> <span class="o">=</span> <span class="s2">&quot;_static/P_dom_chr24_phased.vcf.gz&quot;</span>
<span class="o">!</span>python<span class="w"> </span>-m<span class="w"> </span>bio2zarr<span class="w"> </span>vcf2zarr<span class="w"> </span>convert<span class="w"> </span>--force<span class="w"> </span><span class="o">{</span>vcf_location<span class="o">}</span><span class="w"> </span>sparrows.vcz
</pre></div>
</div>
</div>
</div>
<p>This creates the <code class="docutils literal notranslate"><span class="pre">sparrows.vcz</span></code> datastore, which we open using <code class="docutils literal notranslate"><span class="pre">tsinfer.VariantData</span></code>.
The original VCF had the ancestral allelic state specified in the <code class="docutils literal notranslate"><span class="pre">AA</span></code> INFO field,
so we can simply provide the string <code class="docutils literal notranslate"><span class="pre">&quot;variant_AA&quot;</span></code> as the ancestral_state parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do the inference: this VCF has ancestral states in the AA field</span>
<span class="n">vdata</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">VariantData</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz&quot;</span><span class="p">,</span> <span class="n">ancestral_state</span><span class="o">=</span><span class="s2">&quot;variant_AA&quot;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Inferred tree sequence: </span><span class="si">{}</span><span class="s2"> trees over </span><span class="si">{}</span><span class="s2"> Mb (</span><span class="si">{}</span><span class="s2"> edges)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">ts</span><span class="o">.</span><span class="n">num_trees</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">sequence_length</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">num_edges</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Inferred tree sequence: 6890 trees over 7.077728 Mb (36959 edges)
</pre></div>
</div>
</div>
</div>
<p>On a modern computer, this should only take a few seconds to run.</p>
</section>
<section id="adding-more-metadata">
<h3>Adding more metadata<a class="headerlink" href="#adding-more-metadata" title="Link to this heading">#</a></h3>
<p>We can add additional data to the zarr file, which will make it through to the tree sequence.
For instance, we might want to mark which population each individual comes from.
This can be done by adding some descriptive metadata for each population, and the assigning
each sample to one of those populations. In our case, the sample sparrow IDs beginning with
“FR” are from France:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tskit</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">zarr</span>

<span class="n">vcf_zarr</span> <span class="o">=</span> <span class="n">zarr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz&quot;</span><span class="p">)</span>

<span class="n">populations</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Norway&quot;</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">)</span>
<span class="c1"># save the population data in json format</span>
<span class="n">schema</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">tskit</span><span class="o">.</span><span class="n">MetadataSchema</span><span class="o">.</span><span class="n">permissive_json</span><span class="p">()</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="n">zarr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz/populations_metadata_schema&quot;</span><span class="p">,</span> <span class="n">schema</span><span class="p">)</span>
<span class="n">metadata</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">pop</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The country from which this sample comes&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">populations</span>
<span class="p">]</span>
<span class="n">zarr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz/populations_metadata&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Now assign each diploid sample to a population</span>
<span class="n">num_individuals</span> <span class="o">=</span> <span class="n">vcf_zarr</span><span class="p">[</span><span class="s2">&quot;sample_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">individuals_population</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">num_individuals</span><span class="p">,</span> <span class="n">tskit</span><span class="o">.</span><span class="n">NULL</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vcf_zarr</span><span class="p">[</span><span class="s2">&quot;sample_id&quot;</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;FR&quot;</span><span class="p">):</span>
        <span class="n">individuals_population</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">populations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;France&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">individuals_population</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">populations</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;Norway&quot;</span><span class="p">)</span>
<span class="n">zarr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz/individuals_population&quot;</span><span class="p">,</span> <span class="n">individuals_population</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now when we carry out the inference, we get a tree sequence in which the nodes are
correctly assigned to named populations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vdata</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">VariantData</span><span class="p">(</span><span class="s2">&quot;sparrows.vcz&quot;</span><span class="p">,</span> <span class="n">ancestral_state</span><span class="o">=</span><span class="s2">&quot;variant_AA&quot;</span><span class="p">,</span> <span class="n">individuals_population</span><span class="o">=</span><span class="s2">&quot;individuals_population&quot;</span><span class="p">)</span>
<span class="n">sparrow_ts</span> <span class="o">=</span> <span class="n">tsinfer</span><span class="o">.</span><span class="n">infer</span><span class="p">(</span><span class="n">vdata</span><span class="p">)</span>

<span class="k">for</span> <span class="n">sample_node_id</span> <span class="ow">in</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">individual_id</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">sample_node_id</span><span class="p">)</span><span class="o">.</span><span class="n">individual</span>
    <span class="n">population_id</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">sample_node_id</span><span class="p">)</span><span class="o">.</span><span class="n">population</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;Node&quot;</span><span class="p">,</span>
        <span class="n">sample_node_id</span><span class="p">,</span>
        <span class="s2">&quot;labels a chr24 sampled from individual&quot;</span><span class="p">,</span>
        <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">individual</span><span class="p">(</span><span class="n">individual_id</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;variant_data_sample_id&quot;</span><span class="p">],</span>
        <span class="s2">&quot;in&quot;</span><span class="p">,</span>
        <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">population</span><span class="p">(</span><span class="n">population_id</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Node 0 labels a chr24 sampled from individual 8934547 in Norway
Node 1 labels a chr24 sampled from individual 8934547 in Norway
Node 2 labels a chr24 sampled from individual 8L19766 in Norway
Node 3 labels a chr24 sampled from individual 8L19766 in Norway
Node 4 labels a chr24 sampled from individual 8M31651 in Norway
Node 5 labels a chr24 sampled from individual 8M31651 in Norway
Node 6 labels a chr24 sampled from individual 8N05890 in Norway
Node 7 labels a chr24 sampled from individual 8N05890 in Norway
Node 8 labels a chr24 sampled from individual 8N73604 in Norway
Node 9 labels a chr24 sampled from individual 8N73604 in Norway
Node 10 labels a chr24 sampled from individual FR041 in France
Node 11 labels a chr24 sampled from individual FR041 in France
Node 12 labels a chr24 sampled from individual FR044 in France
Node 13 labels a chr24 sampled from individual FR044 in France
Node 14 labels a chr24 sampled from individual FR046 in France
Node 15 labels a chr24 sampled from individual FR046 in France
Node 16 labels a chr24 sampled from individual FR048 in France
Node 17 labels a chr24 sampled from individual FR048 in France
Node 18 labels a chr24 sampled from individual FR050 in France
Node 19 labels a chr24 sampled from individual FR050 in France
</pre></div>
</div>
</div>
</div>
</section>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Link to this heading">#</a></h3>
<p>To analyse your inferred tree sequence you can use all the analysis functions built in to
the <a class="reference external" href="https://tskit.dev/tskit/docs/stable/">tskit</a> library. The
<a class="reference external" href="https://tskit.dev/tutorials/analysing_tree_sequences.html#sec-tutorial-stats" title="(in Project name not set)"><span class="xref std std-ref">tskit tutorial</span></a> provides much more detail. Below we just give a
flavour of the possibilities.</p>
<p>To quickly eyeball small datasets, we can draw the entire tree sequence, or
<a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.Tree.draw" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">draw()</span></code></a> the tree at any particular genomic position. The following
code demonstrates how to use the <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.at" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tskit.TreeSequence.at()</span></code></a> method to obtain the tree
1Mb from the start of the sequence, and plot it, colouring the tips according to
population:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colours</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Norway&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;France&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">}</span>
<span class="n">colours_for_node</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">population_data</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">population</span><span class="p">(</span><span class="n">sparrow_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
    <span class="n">colours_for_node</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">colours</span><span class="p">[</span><span class="n">population_data</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span>

<span class="n">individual_for_node</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">():</span>
    <span class="n">individual_data</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">individual</span><span class="p">(</span><span class="n">sparrow_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">individual</span><span class="p">)</span>
    <span class="n">individual_for_node</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">individual_data</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;variant_data_sample_id&quot;</span><span class="p">]</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
    <span class="n">path</span><span class="o">=</span><span class="s2">&quot;tree_at_1Mb.svg&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span>
    <span class="n">node_labels</span><span class="o">=</span><span class="n">individual_for_node</span><span class="p">,</span>
    <span class="n">node_colours</span><span class="o">=</span><span class="n">colours_for_node</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a966a746db3d7a013fc0696ef00f2cee0099d62b1e0a95b3f82ee2bcc5464f3.svg" src="_images/4a966a746db3d7a013fc0696ef00f2cee0099d62b1e0a95b3f82ee2bcc5464f3.svg" />
</div>
</div>
<p>This tree seems to suggest that Norwegian and French individuals may not fall into
discrete groups on the tree, but be part of a larger mixing population. Note, however,
that this is only one of thousands of trees, and may not be typical of the genome as a
whole. Additionally, most data sets will have far more samples than this example, so
trees visualized in this way are likely to be huge and difficult to understand. As in
the <a class="reference internal" href="#sec-usage-simulation-example"><span class="std std-ref">simulation example</span></a> above, one possibility
is to <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.simplify" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplify()</span></code></a> the tree sequence to a limited number of
samples, but it is likely that most studies will
instead rely on various statistical summaries of the trees. Storing genetic data as a
tree sequence makes many of these calculations fast and efficient, and tskit has both a
set of <a class="reference external" href="https://tskit.dev/tskit/docs/stable/stats.html#sec-stats" title="(in Project name not set)"><span class="xref std std-ref">commonly used methods</span></a> and a framework that
<a class="reference external" href="https://tskit.dev/tskit/docs/stable/stats.html#sec-stats-general-api" title="(in Project name not set)"><span class="xref std std-ref">generalizes population genetic statistics</span></a>. For example,
the allele or site frequency spectrum (SFS) can be calculated using
<a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.allele_frequency_spectrum" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tskit.TreeSequence.allele_frequency_spectrum()</span></code></a> and the allelic diversity (“Tajima’s
<span class="math notranslate nohighlight">\({\pi}\)</span>”) using <a class="reference external" href="https://tskit.dev/tskit/docs/stable/python-api.html#tskit.TreeSequence.diversity" title="(in Project name not set)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tskit.TreeSequence.diversity()</span></code></a>, both of which can also be
calculated locally (e.g. <a class="reference external" href="https://tskit.dev/tskit/docs/stable/stats.html#sec-stats-windows" title="(in Project name not set)"><span class="xref std std-ref">per tree or in genomic windows</span></a>). As
a basic example, here’s how to calculate genome-wide <span class="math notranslate nohighlight">\(F_{st}\)</span> between the Norwegian
and French (sub)populations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples_listed_by_population</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="n">pop_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">pop_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sparrow_ts</span><span class="o">.</span><span class="n">num_populations</span><span class="p">)</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fst between populations:&quot;</span><span class="p">,</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">Fst</span><span class="p">(</span><span class="n">samples_listed_by_population</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fst between populations: 0.014022798331082553
</pre></div>
</div>
</div>
</div>
<p>As noted above, the times of nodes are uncalibrated so we shouldn’t perform
calculations that reply on branch lengths. However, some statistics, such as the
genealogical nearest neighbour (GNN) proportions are calculated from the topology
of the trees. Here’s an example, using the individual and population metadata to format the results table in
a tidy manner</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">gnn</span> <span class="o">=</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">genealogical_nearest_neighbours</span><span class="p">(</span>
    <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">(),</span> <span class="n">samples_listed_by_population</span>
<span class="p">)</span>

<span class="c1"># Tabulate GNN nicely using a Pandas dataframe with named rows and columns</span>
<span class="n">sample_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">sparrow_ts</span><span class="o">.</span><span class="n">node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">samples</span><span class="p">()]</span>
<span class="n">sample_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_nodes</span><span class="p">]</span>
<span class="n">sample_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">individual</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">individual</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;variant_data_sample_id&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_nodes</span>
<span class="p">]</span>
<span class="n">sample_pops</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">population</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">population</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_nodes</span>
<span class="p">]</span>
<span class="n">gnn_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">gnn</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">sample_ids</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Sample node&quot;</span><span class="p">),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">sample_names</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bird&quot;</span><span class="p">),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">sample_pops</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Country&quot;</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">sparrow_ts</span><span class="o">.</span><span class="n">populations</span><span class="p">()],</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">gnn_table</span><span class="p">)</span>
<span class="c1"># Summarize GNN for all birds from the same country</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gnn_table</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;Country&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                               Norway    France
Sample node Bird    Country                    
0           8934547 Norway   0.548078  0.451922
1           8934547 Norway   0.519736  0.480264
2           8L19766 Norway   0.498110  0.501890
3           8L19766 Norway   0.460057  0.539943
4           8M31651 Norway   0.562564  0.437436
5           8M31651 Norway   0.573115  0.426885
6           8N05890 Norway   0.554173  0.445827
7           8N05890 Norway   0.538251  0.461749
8           8N73604 Norway   0.545487  0.454513
9           8N73604 Norway   0.530388  0.469612
10          FR041   France   0.446387  0.553613
11          FR041   France   0.448367  0.551633
12          FR044   France   0.473520  0.526480
13          FR044   France   0.441096  0.558904
14          FR046   France   0.533155  0.466845
15          FR046   France   0.503537  0.496463
16          FR048   France   0.488966  0.511034
17          FR048   France   0.472713  0.527287
18          FR050   France   0.493882  0.506118
19          FR050   France   0.484976  0.515024
           Norway    France
Country                    
France   0.478660  0.521340
Norway   0.532996  0.467004
</pre></div>
</div>
</div>
</div>
<p>From this, it can be seen that the genealogical nearest neighbours of birds in Norway
tend also to be in Norway, and vice versa for birds from France. In other words, there is
a small but noticable degree of population structure in the data. The bird <code class="docutils literal notranslate"><span class="pre">8L19766</span></code>
and one of the chromosomes of bird <code class="docutils literal notranslate"><span class="pre">FR046</span></code> seem to buck this trend, and it would
probably be worth checking these data points further (perhaps they are migrant birds),
and verifying if other chromosomes in these individuals show the same pattern.</p>
<p>Much more can be done with the genomic statistics built into tskit. For further
information, please refer to the <a class="reference external" href="https://tskit.dev/tskit/docs/stable/stats.html#sec-stats" title="(in Project name not set)"><span class="xref std std-ref">statistics section</span></a> of the
tskit documentation.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="inference.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Inference overview</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#toy-example">Toy example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variantdata-and-ancestral-alleles">VariantData and ancestral alleles</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#topology-inference">Topology inference</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#masks">Masks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-example">Simulation example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-example">Data example</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-a-vcf">Reading a VCF</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-metadata">Adding more metadata</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis">Analysis</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tskit Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2018.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>