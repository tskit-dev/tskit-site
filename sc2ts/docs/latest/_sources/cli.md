
(sc2ts_sec_cli)=

# Command line interface

The ``sc2ts`` package provides a command line interface for running
inference and working with sc2ts datasets. After installation, the
``sc2ts`` entry point should be available

```
$ sc2ts --help
```

You can also invoke the CLI via the module::
```
$ python -m sc2ts --help
```

## Order of high-level commands

In a typical end-to-end workflow, the main subcommands are used in the
following order:

1. ``import-alignments`` and ``import-metadata`` to build a VCF Zarr
   dataset from raw alignments and metadata.
2. ``infer`` to run primary inference over the dataset and produce a
   series of tree sequence files and a match database.
3. ``postprocess`` to apply housekeeping steps and incorporate exact
   matches, outputting a cleaned ARG.
4. ``minimise-metadata`` to generate an analysis-ready ARG with compact
   metadata suitable for use with the Python analysis APIs.


## CLI reference

% A note on cross references... There's some weird long-standing problem with
% cross referencing program values in Sphinx, which means that we can't use
% the built-in labels generated by sphinx-click. We can make our own explicit
% targets, but these have to have slightly weird names to avoid conflicting
% with what sphinx-click is doing. So, hence the cmd- prefix.
% Based on: https://github.com/skypilot-org/skypilot/pull/2834

### Data import

```{eval-rst}
.. _cmd-sc2ts-import-alignments:
.. click:: sc2ts.cli:import_alignments
   :prog: sc2ts import-alignments
```

```{eval-rst}
.. _cmd-sc2ts-import-metadata:
.. click:: sc2ts.cli:import_metadata
   :prog: sc2ts import-metadata
```

### Inference

```{eval-rst}
.. _cmd-sc2ts-infer:
.. click:: sc2ts.cli:infer
   :prog: sc2ts infer
```

### Inspection

```{eval-rst}
.. _cmd-sc2ts-info-dataset:
.. click:: sc2ts.cli:info_dataset
   :prog: sc2ts info-dataset
```

```{eval-rst}
.. _cmd-sc2ts-info-matches:
.. click:: sc2ts.cli:info_matches
   :prog: sc2ts info-matches
```

### Postprocessing

```{eval-rst}
.. _cmd-sc2ts-postprocess:
.. click:: sc2ts.cli:postprocess
   :prog: sc2ts postprocess
```

```{eval-rst}
.. _cmd-sc2ts-map-parsimony:
.. click:: sc2ts.cli:map_parsimony
   :prog: sc2ts map-parsimony
```

```{eval-rst}
.. _cmd-sc2ts-minimise-metadata:
.. click:: sc2ts.cli:minimise_metadata
   :prog: sc2ts minimise-metadata
```

### Miscellaneous

% For some reason this one isn't working. Not worth worrying about.

<!-- ```{eval-rst} -->
<!-- .. _cmd-sc2ts-validate: -->
<!-- .. click:: sc2ts.cli:validate -->
<!--    :prog: sc2ts validate -->
<!-- ``` -->


```{eval-rst}
.. _cmd-sc2ts-run-hmm:
.. click:: sc2ts.cli:run_hmm
   :prog: sc2ts run-hmm
```


