
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>C API &#8212; Tskit manual</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5349f25f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/bespoke.css?v=00f581dd" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c-api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Command line interface" href="cli.html" />
    <link rel="prev" title="Numba Integration" href="numba.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <script data-goatcounter="https://tskit.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="introduction.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">Version 1.0.2.dev1</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-model.html">Data model</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="provenance.html">Provenance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="stats.html">Statistics</a></li>
<li class="toctree-l1"><a class="reference internal" href="topological-analysis.html">Topological analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="ibd.html">Identity by descent</a></li>
<li class="toctree-l1"><a class="reference internal" href="export.html">Data export</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interfaces</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="python-api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="numba.html">Numba Integration</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">C API</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-formats.html">File formats</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">For developers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelogs.html">Changelogs</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="citation.html">Citing tskit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/tskit-dev/tskit" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tskit-dev/tskit/edit/main/docs/c-api.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/tskit-dev/tskit/issues/new?title=Issue%20on%20page%20%2Fc-api.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/c-api.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>C API</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-i-need-the-c-api">Do I need the C API?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-with-the-python-api">Differences with the Python API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-stability-contract">API stability contract</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-structure">API structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-handling">Error handling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-allocation-strategy">Memory allocation strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-tskit-in-your-project">Using tskit in your project</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-types">Basic Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-options">Common options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-api">Tables API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-collections">Table collections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individuals">Individuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nodes">Nodes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edges">Edges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migrations">Migrations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sites">Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutations">Mutations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#populations">Populations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#provenances">Provenances</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-indexes">Table indexes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-sequences">Tree sequences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trees">Trees</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lifecycle">Lifecycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#null-state">Null state</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seeking">Seeking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-queries">Tree queries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#node-queries">Node queries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#traversal-orders">Traversal orders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-level-sorting">Low-level sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-genotypes">Decoding genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#miscellaneous-functions">Miscellaneous functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-specific-options">Function Specific Options</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-init">Load and init</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-treeseq-init"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-treeseq-simplify-tsk-table-collection-simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_simplify()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_simplify()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-check-integrity"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_check_integrity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_clear()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-equality-functions">All equality functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-subset"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_subset()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-union"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_union()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-version">API Version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-constants">Common constants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-errors">Generic Errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-format-errors">File format errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#out-of-bounds-errors">Out-of-bounds errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-errors">Edge errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#site-errors">Site errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutation-errors">Mutation errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migration-errors">Migration errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-errors">Sample errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-errors">Table errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genotype-decoding-errors">Genotype decoding errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#union-errors">Union errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-errors">Simplify errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-errors">Individual errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extend-edges-errors">Extend edges errors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-forwards-simulator">Basic forwards simulator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-iteration">Tree iteration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-traversals">Tree traversals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-streaming">File streaming</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-multichromosome-simulation">Parallel, multichromosome simulation</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="c-api">
<span id="sec-c-api"></span><h1>C API<a class="headerlink" href="#c-api" title="Link to this heading">#</a></h1>
<p>This is the documentation for the <code class="docutils literal notranslate"><span class="pre">tskit</span></code> C API, a low-level library
for manipulating and processing <a class="reference internal" href="data-model.html#sec-data-model"><span class="std std-ref">tree sequence data</span></a>.
The library is written using the C99 standard and is fully thread safe.
Tskit uses <a class="reference external" href="https://kastore.readthedocs.io/">kastore</a> to define a
simple storage format for the tree sequence data.</p>
<p>To see the API in action, please see <a class="reference internal" href="#sec-c-api-examples"><span class="std std-ref">Examples</span></a> section.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<section id="do-i-need-the-c-api">
<h3>Do I need the C API?<a class="headerlink" href="#do-i-need-the-c-api" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">tskit</span></code> C API is generally useful in the following situations:</p>
<ul class="simple">
<li><p>You want to use the <code class="docutils literal notranslate"><span class="pre">tskit</span></code> API in a larger C/C++ application (e.g.,
in order to output data in the <code class="docutils literal notranslate"><span class="pre">.trees</span></code> format);</p></li>
<li><p>You need to perform lots of tree traversals/loops etc. to analyse some
data that is in tree sequence form.</p></li>
</ul>
<p>For high level operations that are not performance sensitive, the <a class="reference internal" href="python-api.html#sec-python-api"><span class="std std-ref">Python API</span></a>
is generally more useful. Python is <em>much</em> more convenient that C,
and since the <code class="docutils literal notranslate"><span class="pre">tskit</span></code> Python module is essentially a wrapper for this
C library, there’s often no real performance penalty for using it.</p>
</section>
<section id="differences-with-the-python-api">
<h3>Differences with the Python API<a class="headerlink" href="#differences-with-the-python-api" title="Link to this heading">#</a></h3>
<p>Much of the explanatory material (for example tutorials) about the Python API applies to
the C-equivalent methods as the Python API wraps this API.</p>
<p>The main area of difference is, unlike the Python API, the C API doesn’t do any
decoding, encoding or schema validation of <a class="reference internal" href="metadata.html#sec-metadata"><span class="std std-ref">Metadata</span></a> fields,
instead only handling the byte string representation of the metadata. Metadata is therefore
never used directly by any tskit C API method, just stored.</p>
</section>
<section id="api-stability-contract">
<h3>API stability contract<a class="headerlink" href="#api-stability-contract" title="Link to this heading">#</a></h3>
<p>Since the C API 1.0 release we pledge to make <strong>no</strong> breaking changes
to the documented API in subsequent releases in the 1.0 series.
What this means is that any code that compiles under the 1.0 release
should also compile without changes in subsequent 1.x releases. We
will not change the semantics of documented functions,  unless it is to
fix clearly buggy behaviour. We will not change the values of macro
constants.</p>
<p>Undocumented functions do not have this guarantee, and may be changed
arbitrarily between releases.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not currently make any guarantees about
<a class="reference external" href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a>
stability, since the primary use-case is for tskit to be embedded
within another application rather than used as a shared library. If you
do intend to use tskit as a shared library and ABI stability is
therefore important to you, please let us know and we can plan
accordingly.</p>
</div>
</section>
<section id="api-structure">
<span id="sec-c-api-overview-structure"></span><h3>API structure<a class="headerlink" href="#api-structure" title="Link to this heading">#</a></h3>
<p>Tskit uses a set of conventions to provide a pseudo object-oriented API. Each
‘object’ is represented by a C struct and has a set of ‘methods’. This is
most easily explained by an example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit/tables.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        fprintf(stderr, &quot;line %d: %s&quot;, __LINE__, tsk_strerror(val));                    \</span>
<span class="cp">        exit(EXIT_FAILURE);                                                             \</span>
<span class="cp">    }</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_edge_table_t</span><span class="w"> </span><span class="n">edges</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_add_row</span><span class="p">(</span><span class="o">&amp;</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tsk_edge_table_print_state</span><span class="p">(</span><span class="o">&amp;</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="p">);</span>
<span class="w">    </span><span class="n">tsk_edge_table_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">edges</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this program we create a <a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_edge_table_t</span></code></a> instance, add five rows
using <a class="reference internal" href="#c.tsk_edge_table_add_row" title="tsk_edge_table_add_row"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_edge_table_add_row()</span></code></a>, print out its contents using the
<a class="reference internal" href="#c.tsk_edge_table_print_state" title="tsk_edge_table_print_state"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_edge_table_print_state()</span></code></a> debugging method, and finally free
the memory used by the edge table object. We define this edge table
‘class’ by using some simple naming conventions which are adhered
to throughout <code class="docutils literal notranslate"><span class="pre">tskit</span></code>. This is simply a naming convention that helps to
keep code written in plain C logically structured; there are no extra C++ style features.
We use object oriented terminology freely throughout this documentation
with this understanding.</p>
<p>In this convention, a class is defined by a struct <code class="docutils literal notranslate"><span class="pre">tsk_class_name_t</span></code> (e.g.
<code class="docutils literal notranslate"><span class="pre">tsk_edge_table_t</span></code>) and its methods all have the form <code class="docutils literal notranslate"><span class="pre">tsk_class_name_method_name</span></code>
whose first argument is always a pointer to an instance of the class (e.g.,
<code class="docutils literal notranslate"><span class="pre">tsk_edge_table_add_row</span></code> above).
Each class has an initialise and free method, called <code class="docutils literal notranslate"><span class="pre">tsk_class_name_init</span></code>
and <code class="docutils literal notranslate"><span class="pre">tsk_class_name_free</span></code>, respectively. The init method must
be called to ensure that the object is correctly initialised (except
for functions such as for <a class="reference internal" href="#c.tsk_table_collection_load" title="tsk_table_collection_load"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_load()</span></code></a>
and <a class="reference internal" href="#c.tsk_table_collection_copy" title="tsk_table_collection_copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_copy()</span></code></a> which automatically initialise
the object by default for convenience). The free
method must always be called to avoid leaking memory, even in the
case of an error occurring during initialisation. If <code class="docutils literal notranslate"><span class="pre">tsk_class_name_init</span></code> has
been called successfully, we say the object has been “initialised”; if not,
it is “uninitialised”. After <code class="docutils literal notranslate"><span class="pre">tsk_class_name_free</span></code> has been called,
the object is again uninitialised.</p>
<p>It is important to note that the init methods only allocate <em>internal</em> memory;
the memory for the instance itself must be allocated either on the
heap or the stack:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// Instance allocated on the stack</span>
<span class="n">tsk_node_table_t</span><span class="w"> </span><span class="n">nodes</span><span class="p">;</span>
<span class="n">tsk_node_table_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="n">tsk_node_table_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">nodes</span><span class="p">);</span>

<span class="c1">// Instance allocated on the heap</span>
<span class="n">tsk_edge_table_t</span><span class="w"> </span><span class="o">*</span><span class="n">edges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">tsk_edge_table_t</span><span class="p">));</span>
<span class="n">tsk_edge_table_init</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="n">tsk_edge_table_free</span><span class="p">(</span><span class="n">edges</span><span class="p">);</span>
<span class="n">free</span><span class="p">(</span><span class="n">edges</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="error-handling">
<span id="sec-c-api-error-handling"></span><h3>Error handling<a class="headerlink" href="#error-handling" title="Link to this heading">#</a></h3>
<p>C does not have a mechanism for propagating exceptions, and great care
must be taken to ensure that errors are correctly and safely handled.
The convention adopted in <code class="docutils literal notranslate"><span class="pre">tskit</span></code> is that
every function (except for trivial accessor methods) returns
an integer. If this return value is negative an error has occured which
must be handled. A description of the error that occured can be obtained
using the <a class="reference internal" href="#c.tsk_strerror" title="tsk_strerror"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_strerror()</span></code></a> function. The following example illustrates
the key conventions around error handling in <code class="docutils literal notranslate"><span class="pre">tskit</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit.h&gt;</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_treeseq_t</span><span class="w"> </span><span class="n">ts</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;usage: &lt;tree sequence file&gt;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Error condition. Free and exit */</span>
<span class="w">        </span><span class="n">tsk_treeseq_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">);</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tsk_strerror</span><span class="p">(</span><span class="n">ret</span><span class="p">));</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Loaded tree sequence with %lld nodes and %lld edges from %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tsk_treeseq_get_num_nodes</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">),</span>
<span class="w">        </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tsk_treeseq_get_num_edges</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">),</span>
<span class="w">        </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="n">tsk_treeseq_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example we load a tree sequence from file and print out a summary
of the number of nodes and edges it contains. After calling
<a class="reference internal" href="#c.tsk_treeseq_load" title="tsk_treeseq_load"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_load()</span></code></a> we check the return value <code class="docutils literal notranslate"><span class="pre">ret</span></code> to see
if an error occured. If an error has occured we exit with an error
message produced by <a class="reference internal" href="#c.tsk_strerror" title="tsk_strerror"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_strerror()</span></code></a>. Note that in this example we call
<a class="reference internal" href="#c.tsk_treeseq_free" title="tsk_treeseq_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_free()</span></code></a> whether or not an error occurs: in general,
once a function that initialises an object (e.g., <code class="docutils literal notranslate"><span class="pre">X_init</span></code>, <code class="docutils literal notranslate"><span class="pre">X_copy</span></code>
or <code class="docutils literal notranslate"><span class="pre">X_load</span></code>) is called, then <code class="docutils literal notranslate"><span class="pre">X_free</span></code> must
be called to ensure that memory is not leaked.</p>
<p>Most functions in <code class="docutils literal notranslate"><span class="pre">tskit</span></code> return an error status; we recommend that <strong>every</strong>
return value is checked.</p>
</section>
<section id="memory-allocation-strategy">
<span id="sec-c-api-memory-allocation-strategy"></span><h3>Memory allocation strategy<a class="headerlink" href="#memory-allocation-strategy" title="Link to this heading">#</a></h3>
<p>To reduce the frequency of memory allocations tskit pre-allocates space for
additional table rows in each table, along with space for the contents of
ragged columns. The default behaviour is to start with space for 1,024 rows
in each table and 65,536 bytes in each ragged column. The table then grows
as needed by doubling, until a maximum pre-allocation of 2,097,152 rows for
a table or 104,857,600 bytes for a ragged column. This behaviour can be
disabled and a fixed increment used, on a per-table and per-ragged-column
basis using the <code class="docutils literal notranslate"><span class="pre">tsk_X_table_set_max_rows_increment</span></code> and
<code class="docutils literal notranslate"><span class="pre">tsk_provenance_table_set_max_X_length_increment</span></code> methods where <code class="docutils literal notranslate"><span class="pre">X</span></code> is
the name of the table or column.</p>
</section>
<section id="using-tskit-in-your-project">
<h3>Using tskit in your project<a class="headerlink" href="#using-tskit-in-your-project" title="Link to this heading">#</a></h3>
<p>Tskit is built as a standard C library and so there are many different ways
in which it can be included in downstream projects. It is possible to
install <code class="docutils literal notranslate"><span class="pre">tskit</span></code> onto a system (i.e., installing a shared library and
header files to a standard locations on Unix) and linking against it,
but there are many different ways in which this can go wrong. In the
interest of simplicity and improving the end-user experience we recommend
embedding <code class="docutils literal notranslate"><span class="pre">tskit</span></code> directly into your applications.</p>
<p>There are many different build systems and approaches to compiling
code, and so it’s not possible to give definitive documentation on
how <code class="docutils literal notranslate"><span class="pre">tskit</span></code> should be included in downstream projects. Please
see the <a class="reference external" href="https://github.com/tskit-dev/tskit-build-examples">build examples</a>
repo for some examples of how to incorporate <code class="docutils literal notranslate"><span class="pre">tskit</span></code> into
different project structures and build systems.</p>
<p>Tskit uses the <a class="reference external" href="https://mesonbuild.com">meson</a> build system internally,
and supports being used a <a class="reference external" href="https://mesonbuild.com/Subprojects.html">meson subproject</a>.
We show an <a class="reference external" href="https://github.com/tskit-dev/tskit-build-examples/tree/main/meson">example</a>
in which this is combined with the tskit distribution tarball to neatly
abstract many details of cross-platform C development.</p>
<p>Some users may choose to check the source for <code class="docutils literal notranslate"><span class="pre">tskit</span></code> directly into their source
control repositories. If you wish to do this, the code is in the <code class="docutils literal notranslate"><span class="pre">c</span></code> subdirectory of the
<a class="reference external" href="https://github.com/tskit-dev/tskit/tree/main/c">tskit</a> repo.
The following header files should be placed in the search path:
<code class="docutils literal notranslate"><span class="pre">subprojects/kastore/kastore.h</span></code>, <code class="docutils literal notranslate"><span class="pre">tskit.h</span></code>, and <code class="docutils literal notranslate"><span class="pre">tskit/*.h</span></code>.
The C files <code class="docutils literal notranslate"><span class="pre">subprojects/kastore/kastore.c</span></code> and <code class="docutils literal notranslate"><span class="pre">tskit/*.c</span></code> should be compiled.
For those who wish to minimise the size of their compiled binaries,
<code class="docutils literal notranslate"><span class="pre">tskit</span></code> is quite modular, and C files can be omitted if not needed.
For example, if you are just using the <a class="reference internal" href="#sec-c-api-tables-api"><span class="std std-ref">Generic Errors</span></a> then
only the files <code class="docutils literal notranslate"><span class="pre">tskit/core.[c,h]</span></code> and <code class="docutils literal notranslate"><span class="pre">tskit/tables.[c,h]</span></code> are
needed.</p>
<p>However you include <code class="docutils literal notranslate"><span class="pre">tskit</span></code> in your project, however, please
ensure that it is a <strong>released version</strong>. Released versions are
tagged on GitHub using the convention <code class="docutils literal notranslate"><span class="pre">C_{VERSION}</span></code>. The code
can either be downloaded from GitHub on the <a class="reference external" href="https://github.com/tskit-dev/tskit/releases">releases page</a> where each release has a distribution
tarball for example
<a class="github reference external" href="https://github.com/tskit-dev/tskit/releases/download/C_1.0.0/tskit-1.0.0.tar.xz">tskit-dev/tskit</a>
Alternatively the code can be checked out
using git. For example, to check out the <code class="docutils literal notranslate"><span class="pre">C_1.0.0</span></code> release:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/tskit-dev/tskit.git
$ cd tskit
$ git checkout C_1.0.0
</pre></div>
</div>
</section>
</section>
<section id="basic-types">
<h2>Basic Types<a class="headerlink" href="#basic-types" title="Link to this heading">#</a></h2>
<dl class="c type">
<dt class="sig sig-object c" id="c.tsk_id_t">
<span class="target" id="core_8h_1ad11b8b1c1f56c700a6959e80417e4d53"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_id_t</span></span></span><a class="headerlink" href="#c.tsk_id_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Tskit Object IDs. </p>
<p>All objects in tskit are referred to by integer IDs corresponding to the
row they occupy in the relevant table. The <code class="docutils literal notranslate"><span class="pre">tsk_id_t</span></code> type should be used
when manipulating these ID values. The reserved value <a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> (-1) defines
missing data.</p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.tsk_size_t">
<span class="target" id="core_8h_1a1ee7b8dba655626a919f933a8e8f8f05"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">uint64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_size_t</span></span></span><a class="headerlink" href="#c.tsk_size_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Tskit sizes. </p>
<p>The <code class="docutils literal notranslate"><span class="pre">tsk_size_t</span></code> type is an unsigned integer used for any size or count value.</p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.tsk_flags_t">
<span class="target" id="core_8h_1a71cbeb24f4c37b359ca0136673821612"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_flags_t</span></span></span><a class="headerlink" href="#c.tsk_flags_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Container for bitwise flags. </p>
<p>Bitwise flags are used in tskit as a column type and also as a way to
specify options to API functions.</p>
</dd></dl>

<dl class="c type">
<dt class="sig sig-object c" id="c.tsk_bool_t">
<span class="target" id="core_8h_1ab470c7c73ae9d7a1a79cd5f7a24a8dcd"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_bool_t</span></span></span><a class="headerlink" href="#c.tsk_bool_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Boolean type. </p>
<p>Fixed-size (1 byte) boolean values.</p>
</dd></dl>

</section>
<section id="common-options">
<h2>Common options<a class="headerlink" href="#common-options" title="Link to this heading">#</a></h2>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_DEBUG">
<span class="target" id="group___g_e_n_e_r_i_c___f_u_n_c_t_i_o_n___o_p_t_i_o_n_s_1gace02380b81c74961db6c17a5aba50fd6"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_DEBUG</span></span></span> <span class="pre">(1u</span> <span class="pre">&lt;&lt;</span> <span class="pre">31)</span><a class="headerlink" href="#c.TSK_DEBUG" title="Link to this definition">#</a><br /></dt>
<dd><p>Turn on debugging output. Not supported by all functions. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_NO_INIT">
<span class="target" id="group___g_e_n_e_r_i_c___f_u_n_c_t_i_o_n___o_p_t_i_o_n_s_1ga687006cf389016372a4e12f11158abe2"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_NO_INIT</span></span></span> <span class="pre">(1u</span> <span class="pre">&lt;&lt;</span> <span class="pre">30)</span><a class="headerlink" href="#c.TSK_NO_INIT" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not initialise the parameter object. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_NO_CHECK_INTEGRITY">
<span class="target" id="group___g_e_n_e_r_i_c___f_u_n_c_t_i_o_n___o_p_t_i_o_n_s_1ga835bef5159a71a4a708c9ecdfec104de"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_NO_CHECK_INTEGRITY</span></span></span> <span class="pre">(1u</span> <span class="pre">&lt;&lt;</span> <span class="pre">29)</span><a class="headerlink" href="#c.TSK_NO_CHECK_INTEGRITY" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not run integrity checks before performing an operation. This performance optimisation should not be used unless the calling code can guarantee reference integrity within the table collection. References to rows not in the table or bad offsets will result in undefined behaviour. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TAKE_OWNERSHIP">
<span class="target" id="group___g_e_n_e_r_i_c___f_u_n_c_t_i_o_n___o_p_t_i_o_n_s_1gad11c9cec7798d8a00252a000122aef23"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TAKE_OWNERSHIP</span></span></span> <span class="pre">(1u</span> <span class="pre">&lt;&lt;</span> <span class="pre">28)</span><a class="headerlink" href="#c.TSK_TAKE_OWNERSHIP" title="Link to this definition">#</a><br /></dt>
<dd><p>Instead of taking a copy of input objects, the function should take ownership of them and manage their lifecycle. The caller specifying this flag should no longer modify or free the object or objects passed. See individual functions using this flag for what object it applies to. </p>
</dd></dl>

</section>
<section id="tables-api">
<h2>Tables API<a class="headerlink" href="#tables-api" title="Link to this heading">#</a></h2>
<p>The tables API section of <code class="docutils literal notranslate"><span class="pre">tskit</span></code> is defined in the <code class="docutils literal notranslate"><span class="pre">tskit/tables.h</span></code> header.</p>
<section id="table-collections">
<h3>Table collections<a class="headerlink" href="#table-collections" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_table_collection_t">
<span class="target" id="structtsk__table__collection__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_t</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A collection of tables defining the data for a tree sequence. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.sequence_length">
<span class="target" id="structtsk__table__collection__t_1aec59b1f300ef29e9c393893ba0fbe400"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sequence_length</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.sequence_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The sequence length defining the tree sequence’s coordinate space. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.time_units">
<span class="target" id="structtsk__table__collection__t_1aae7735804e121426ffab99dbd5cd961d"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">time_units</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.time_units" title="Link to this definition">#</a><br /></dt>
<dd><p>The units of the time dimension. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.metadata">
<span class="target" id="structtsk__table__collection__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The tree-sequence metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.metadata_schema">
<span class="target" id="structtsk__table__collection__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.individuals">
<span class="target" id="structtsk__table__collection__t_1a76ff995a01f01333ee26054313e64932"></span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">individuals</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.individuals" title="Link to this definition">#</a><br /></dt>
<dd><p>The individual table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.nodes">
<span class="target" id="structtsk__table__collection__t_1a1e198b802cb18b87ba8058669fd3ed05"></span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nodes</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.nodes" title="Link to this definition">#</a><br /></dt>
<dd><p>The node table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.edges">
<span class="target" id="structtsk__table__collection__t_1acb5aef13ac627d7dca910e47497aba90"></span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">edges</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.edges" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.migrations">
<span class="target" id="structtsk__table__collection__t_1a84d768db560874e356d213c75fada585"></span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">migrations</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.migrations" title="Link to this definition">#</a><br /></dt>
<dd><p>The migration table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.sites">
<span class="target" id="structtsk__table__collection__t_1a923fcee7e13a4cb5ad75845ca063cdbc"></span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sites</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.sites" title="Link to this definition">#</a><br /></dt>
<dd><p>The site table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.mutations">
<span class="target" id="structtsk__table__collection__t_1aad6cfdf153e558b05699f7e5188162d0"></span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mutations</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.mutations" title="Link to this definition">#</a><br /></dt>
<dd><p>The mutation table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.populations">
<span class="target" id="structtsk__table__collection__t_1a5f9a800720a2d06f2723e7e20dd1590b"></span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">populations</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.populations" title="Link to this definition">#</a><br /></dt>
<dd><p>The population table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_table_collection_t.provenances">
<span class="target" id="structtsk__table__collection__t_1a00139a1323ba12d812d2b9ab7f3dd8ae"></span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">provenances</span></span></span><a class="headerlink" href="#c.tsk_table_collection_t.provenances" title="Link to this definition">#</a><br /></dt>
<dd><p>The provenance table. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_bookmark_t">
<span class="target" id="structtsk__bookmark__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_bookmark_t</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A bookmark recording the position of all the tables in a table collection. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.individuals">
<span class="target" id="structtsk__bookmark__t_1a19e610f902da5441f916f8f21d0892d9"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">individuals</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.individuals" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the individual table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.nodes">
<span class="target" id="structtsk__bookmark__t_1a0833e4fe6fd7377847b01e0e50cdb0bb"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nodes</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.nodes" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the node table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.edges">
<span class="target" id="structtsk__bookmark__t_1a7892e438d097862aa2b99544d55a3ff8"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">edges</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.edges" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the edge table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.migrations">
<span class="target" id="structtsk__bookmark__t_1a7450fdfa955cf6b7fbaafde5850f8807"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">migrations</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.migrations" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the migration table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.sites">
<span class="target" id="structtsk__bookmark__t_1ac87ec7b24b924682b0d942540c4f2c05"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sites</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.sites" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the site table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.mutations">
<span class="target" id="structtsk__bookmark__t_1addd6eccb97a00f4a2bb890e1ef621c89"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mutations</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.mutations" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the mutation table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.populations">
<span class="target" id="structtsk__bookmark__t_1a2c3d1ca2a3c7f962eca32cce1ee08aa8"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">populations</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.populations" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the population table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_bookmark_t.provenances">
<span class="target" id="structtsk__bookmark__t_1a26151fe1d1475cac6c6fa9d5ab18a1ee"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">provenances</span></span></span><a class="headerlink" href="#c.tsk_bookmark_t.provenances" title="Link to this definition">#</a><br /></dt>
<dd><p>The position in the provenance table. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_init">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gade1c247dbe4e9ffb9fe690dad77a6dee"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table collection by allocating the internal memory and initialising all the constituent tables. </p>
<p><p>This must be called before any operations are performed on the table
collection. See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing bitwise flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_TC_NO_EDGE_METADATA" title="TSK_TC_NO_EDGE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_TC_NO_EDGE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options as above. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_free">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga043e1665798d38dd6ca6b875af3df36a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table collection. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_clear">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gafd25e45f0b52b75eb2e92dec7d01f128"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears data tables (and optionally provenances and metadata) in this table collection. </p>
<p><p>By default this operation clears all tables except the provenance table, retaining
table metadata schemas and the tree-sequence level metadata and schema.</p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_table_collection_free" title="tsk_table_collection_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_free()</span></code></a> to free internal resources.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CLEAR_PROVENANCE" title="TSK_CLEAR_PROVENANCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CLEAR_PROVENANCE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CLEAR_METADATA_SCHEMAS" title="TSK_CLEAR_METADATA_SCHEMAS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CLEAR_METADATA_SCHEMAS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CLEAR_TS_METADATA_AND_SCHEMA" title="TSK_CLEAR_TS_METADATA_AND_SCHEMA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CLEAR_TS_METADATA_AND_SCHEMA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise clearing options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_equals">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga8d959de5fed8fd7e4fc110223c165a09"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table collection is equal to the data in this table collection. </p>
<p><p>Returns true if the two table collections are equal. The indexes are
not considered as these are derived from the tables. We also do not
consider the <code class="docutils literal notranslate"><span class="pre">file_uuid</span></code>, since it is a property of the file that set
of tables is stored in.</p>
<p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) two table
collections are considered equal if all of the tables are byte-wise
identical, and the sequence lengths, metadata and metadata schemas
of the two table collections are identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_PROVENANCE" title="TSK_CMP_IGNORE_PROVENANCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_PROVENANCE</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_TS_METADATA" title="TSK_CMP_IGNORE_TS_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_TS_METADATA</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_TIMESTAMPS" title="TSK_CMP_IGNORE_TIMESTAMPS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_TIMESTAMPS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_TABLES" title="TSK_CMP_IGNORE_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_TABLES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_REFERENCE_SEQUENCE" title="TSK_CMP_IGNORE_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_REFERENCE_SEQUENCE</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table collection is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_copy">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gaefa80e243fcb5740293b60f29e75b794"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table collection into the specified destination. </p>
<p><p>By default the method initialises the specified destination table collection. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing bitwise flags:</p>
<p><a class="reference internal" href="#c.TSK_COPY_FILE_UUID" title="TSK_COPY_FILE_UUID"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_COPY_FILE_UUID</span></code></a></p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised table collection. If not, it must be an uninitialised table collection. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_print_state">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gaf9bf5e6fab44f2dfd98e8f60ff133406"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table collection to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_load">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gacba45f7097d54490763c0e0242fa8c2e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_load</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">filename</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_load" title="Link to this definition">#</a><br /></dt>
<dd><p>Load a table collection from a file path. </p>
<p><p>Loads the data from the specified file into this table collection.
By default, the table collection is also initialised.
The resources allocated must be freed using
<a class="reference internal" href="#c.tsk_table_collection_free" title="tsk_table_collection_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_free()</span></code></a> even in error conditions.</p>
<p>If the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option is set, the table collection is
not initialised, allowing an already initialised table collection to
be overwritten with the data from a file.</p>
<p>If the file contains multiple table collections, this function will load
the first. Please see the <a class="reference internal" href="#c.tsk_table_collection_loadf" title="tsk_table_collection_loadf"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_loadf()</span></code></a> for details
on how to sequentially load table collections from a stream.</p>
<p>If the <a class="reference internal" href="#c.TSK_LOAD_SKIP_TABLES" title="TSK_LOAD_SKIP_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_TABLES</span></code></a> option is set, only the non-table information from
the table collection will be read, leaving all tables with zero rows and no
metadata or schema.
If the <a class="reference internal" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="TSK_LOAD_SKIP_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></code></a> option is set, the table collection is
read without loading the reference sequence.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_LOAD_SKIP_TABLES" title="TSK_LOAD_SKIP_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_TABLES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="TSK_LOAD_SKIP_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></code></a></p></li>
</ul>
<p><strong>Examples</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data.trees&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Load error:%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tsk_strerror</span><span class="p">(</span><span class="n">ret</span><span class="p">));</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object if the TSK_NO_INIT option is not set (default), or an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> otherwise. </p></li>
<li><p><strong>filename</strong> – A NULL terminated string containing the filename. </p></li>
<li><p><strong>options</strong> – Bitwise options. See above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_loadf">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga07ac4970005ea7ee0201e15deff37f99"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_loadf</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_loadf" title="Link to this definition">#</a><br /></dt>
<dd><p>Load a table collection from a stream. </p>
<p><p>Loads a tables definition from the specified file stream to this table
collection. By default, the table collection is also initialised.
The resources allocated must be freed using
<a class="reference internal" href="#c.tsk_table_collection_free" title="tsk_table_collection_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_free()</span></code></a> even in error conditions.</p>
<p>If the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option is set, the table collection is
not initialised, allowing an already initialised table collection to
be overwritten with the data from a file.</p>
<p>The stream can be an arbitrary file descriptor, for example a network socket.
No seek operations are performed.</p>
<p>If the stream contains multiple table collection definitions, this function
will load the next table collection from the stream. If the stream contains no
more table collection definitions the error value <a class="reference internal" href="#c.TSK_ERR_EOF" title="TSK_ERR_EOF"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_ERR_EOF</span></code></a> will
be returned. Note that EOF is only returned in the case where zero bytes are
read from the stream — malformed files or other errors will result in
different error conditions. Please see the
<a class="reference internal" href="#sec-c-api-examples-file-streaming"><span class="std std-ref">File streaming</span></a> section for an example of how to
sequentially load tree sequences from a stream.</p>
<p>Please note that this streaming behaviour is not supported if the
<a class="reference internal" href="#c.TSK_LOAD_SKIP_TABLES" title="TSK_LOAD_SKIP_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_TABLES</span></code></a> or <a class="reference internal" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="TSK_LOAD_SKIP_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></code></a> option is
set. If the <a class="reference internal" href="#c.TSK_LOAD_SKIP_TABLES" title="TSK_LOAD_SKIP_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_TABLES</span></code></a> option is set, only the non-table information
from the table collection will be read, leaving all tables with zero rows and no metadata
or schema. If the <a class="reference internal" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="TSK_LOAD_SKIP_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></code></a> option is set, the table
collection is read without loading the reference sequence. When attempting to read from a
stream with multiple table collection definitions and either of these two options set,
the requested information from the first table collection will be read on the first call
to <a class="reference internal" href="#c.tsk_table_collection_loadf" title="tsk_table_collection_loadf"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_loadf()</span></code></a>, with subsequent calls leading to errors.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_LOAD_SKIP_TABLES" title="TSK_LOAD_SKIP_TABLES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_TABLES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="TSK_LOAD_SKIP_REFERENCE_SEQUENCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object if the TSK_NO_INIT option is not set (default), or an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> otherwise. </p></li>
<li><p><strong>file</strong> – A FILE stream opened in an appropriate mode for reading (e.g. “r”, “r+” or “w+”) positioned at the beginning of a table collection definition. </p></li>
<li><p><strong>options</strong> – Bitwise options. See above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_dump">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gabd5507ef3f3a980a5b423100463e72c7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_dump</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">filename</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_dump" title="Link to this definition">#</a><br /></dt>
<dd><p>Write a table collection to file. </p>
<p><p>Writes the data from this table collection to the specified file.</p>
<p>If an error occurs the file path is deleted, ensuring that only complete
and well formed files will be written.</p>
<p><strong>Examples</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span>

<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="n">error_check</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="n">tables</span><span class="p">.</span><span class="n">sequence_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="c1">// Write out the empty tree sequence</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_dump</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;empty.trees&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="n">error_check</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>filename</strong> – A NULL terminated string containing the filename. </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_dumpf">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga7f7bc30d5f0674667b634fa00b8575fa"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_dumpf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_dumpf" title="Link to this definition">#</a><br /></dt>
<dd><p>Write a table collection to a stream. </p>
<p><p>Writes the data from this table collection to the specified FILE stream.
Semantics are identical to <a class="reference internal" href="#c.tsk_table_collection_dump" title="tsk_table_collection_dump"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_dump()</span></code></a>.</p>
<p>Please see the <a class="reference internal" href="#sec-c-api-examples-file-streaming"><span class="std std-ref">File streaming</span></a> section for an example
of how to sequentially dump and load tree sequences from a stream.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>file</strong> – A FILE stream opened in an appropriate mode for writing (e.g. “w”, “a”, “r+” or “w+”). </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_record_num_rows">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga8612ce93902506bcd77822687d80f622"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_record_num_rows</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><span class="n"><span class="pre">tsk_bookmark_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bookmark</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_record_num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Record the number of rows in each table in the specified <a class="reference internal" href="#structtsk__bookmark__t"><span class="std std-ref">tsk_bookmark_t</span></a> object. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>bookmark</strong> – A pointer to a <a class="reference internal" href="#structtsk__bookmark__t"><span class="std std-ref">tsk_bookmark_t</span></a> which is updated to contain the number of rows in all tables. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_truncate">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga3d1067849cc92fb142acbb3f6ac3489e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><span class="n"><span class="pre">tsk_bookmark_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">bookmark</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates the tables in this table collection according to the specified bookmark. </p>
<p>Truncate the tables in this collection so that each one has the number
of rows specified in the parameter <a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_bookmark_t</span></code></a>. Use the
<a class="reference internal" href="#c.tsk_table_collection_record_num_rows" title="tsk_table_collection_record_num_rows"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_record_num_rows()</span></code></a> function to record the
number rows for each table in a table collection at a particular time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>bookmark</strong> – The number of rows to retain in each table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_sort">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gabfe4eec1e871d20f899fbd78d7e379be"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_sort</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><span class="n"><span class="pre">tsk_bookmark_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">start</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_sort" title="Link to this definition">#</a><br /></dt>
<dd><p>Sorts the tables in this collection. </p>
<p><p>Some of the tables in a table collection must satisfy specific sortedness requirements
in order to define a <a class="reference internal" href="data-model.html#sec-valid-tree-sequence-requirements"><span class="std std-ref">valid tree sequence</span></a>.
This method sorts the <code class="docutils literal notranslate"><span class="pre">edge</span></code>, <code class="docutils literal notranslate"><span class="pre">site</span></code>, <code class="docutils literal notranslate"><span class="pre">mutation</span></code> and <code class="docutils literal notranslate"><span class="pre">individual</span></code> tables such
that these requirements are guaranteed to be fulfilled. The <code class="docutils literal notranslate"><span class="pre">node</span></code>, <code class="docutils literal notranslate"><span class="pre">population</span></code>
and <code class="docutils literal notranslate"><span class="pre">provenance</span></code> tables do not have any sortedness requirements, and are therefore
ignored by this method.</p>
<p>The specified <a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_bookmark_t</span></code></a> allows us to specify a start position
for sorting in each of the tables; rows before this value are assumed to already be
in sorted order and this information is used to make sorting more efficient.
Positions in tables that are not sorted (<code class="docutils literal notranslate"><span class="pre">node</span></code>, <code class="docutils literal notranslate"><span class="pre">population</span></code>
and <code class="docutils literal notranslate"><span class="pre">provenance</span></code>) are ignored and can be set to arbitrary values.</p>
<p>The table collection will always be unindexed after sort successfully completes.</p>
<p>For more control over the sorting process, see the <a class="reference internal" href="#sec-c-api-low-level-sorting"><span class="std std-ref">Low-level sorting</span></a>
section.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<dl class="simple">
<dt><a class="reference internal" href="#c.TSK_NO_CHECK_INTEGRITY" title="TSK_NO_CHECK_INTEGRITY"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_CHECK_INTEGRITY</span></code></a></dt><dd><p>Do not run integrity checks using
<a class="reference internal" href="#c.tsk_table_collection_check_integrity" title="tsk_table_collection_check_integrity"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_check_integrity()</span></code></a> before sorting,
potentially leading to a small reduction in execution time. This
performance optimisation should not be used unless the calling code can
guarantee reference integrity within the table collection. References
to rows not in the table or bad offsets will result in undefined
behaviour.</p>
</dd>
</dl>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current implementation <strong>may</strong> sort in such a way that exceeds
these requirements, but this behaviour should not be relied upon and later
versions may weaken the level of sortedness. However, the method does <strong>guarantee</strong>
that the resulting tables describes a valid tree sequence.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sorting migrations is currently not supported and an error will be raised
if a table collection containing a non-empty migration table is specified.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current implementation only supports specifying a start
position for the <code class="docutils literal notranslate"><span class="pre">edge</span></code> table and in a limited form for the
<code class="docutils literal notranslate"><span class="pre">site</span></code>, <code class="docutils literal notranslate"><span class="pre">mutation</span></code> and <code class="docutils literal notranslate"><span class="pre">individual</span></code> tables. Specifying a non-zero
<code class="docutils literal notranslate"><span class="pre">migration</span></code>, start position results in an error. The start positions for the
<code class="docutils literal notranslate"><span class="pre">site</span></code>, <code class="docutils literal notranslate"><span class="pre">mutation</span></code> and <code class="docutils literal notranslate"><span class="pre">individual</span></code> tables can either be 0 or the length of the
respective tables, allowing these tables to either be fully sorted, or not sorted at
all.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>start</strong> – The position to begin sorting in each table; all rows less than this position must fulfill the tree sequence sortedness requirements. If this is NULL, sort all rows. </p></li>
<li><p><strong>options</strong> – Sort options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_individual_topological_sort">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga4ba080444388c9babb74d47d043024d1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_individual_topological_sort</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_individual_topological_sort" title="Link to this definition">#</a><br /></dt>
<dd><p>Sorts the individual table in this collection. </p>
<p>Sorts the individual table in place, so that parents come before children,
and the parent column is remapped as required. Node references to individuals
are also updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Sort options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_canonicalise">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga07de229ab87f0706d10334981d314e49"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_canonicalise</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_canonicalise" title="Link to this definition">#</a><br /></dt>
<dd><p>Puts the tables into canonical form. </p>
<p><p>Put tables into canonical form such that randomly reshuffled tables
are guaranteed to always be sorted in the same order, and redundant
information is removed. The canonical sorting exceeds the usual
tree sequence sortedness requirements.</p>
<p><strong>Options</strong>:</p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_SUBSET_KEEP_UNREFERENCED" title="TSK_SUBSET_KEEP_UNREFERENCED"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SUBSET_KEEP_UNREFERENCED</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_simplify">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gac246f379b40f37b580704ffdf8d06d7e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_simplify</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">samples</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_samples</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_simplify" title="Link to this definition">#</a><br /></dt>
<dd><p>Simplify the tables to remove redundant information. </p>
<p><p>Simplification transforms the tables to remove redundancy and canonicalise
tree sequence data. See the <a class="reference external" href="https://tskit.dev/tutorials/simplification.html#sec-simplification" title="(in Project name not set)"><span class="xref std std-ref">simplification</span></a> tutorial for
more details.</p>
<p>A mapping from the node IDs in the table before simplification to their equivalent
values after simplification can be obtained via the <code class="docutils literal notranslate"><span class="pre">node_map</span></code> argument. If this
is non NULL, <code class="docutils literal notranslate"><span class="pre">node_map[u]</span></code> will contain the new ID for node <code class="docutils literal notranslate"><span class="pre">u</span></code> after simplification,
or <a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the node has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">node_map</span></code> must be an array
of at least <code class="docutils literal notranslate"><span class="pre">self-&gt;nodes.num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
<p>If the <cite>TSK_SIMPLIFY_NO_FILTER_NODES</cite> option is specified, the node table will be
unaltered except for changing the sample status of nodes (but see the
<cite>TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS</cite> option below) and to update references
to other tables that may have changed as a result of filtering (see below).
The <code class="docutils literal notranslate"><span class="pre">node_map</span></code> (if specified) will always be the identity mapping, such that
<code class="docutils literal notranslate"><span class="pre">node_map[u]</span> <span class="pre">==</span> <span class="pre">u</span></code> for all nodes. Note also that the order of the list of
samples is not important in this case.</p>
<p>When a table is not filtered (i.e., if the <cite>TSK_SIMPLIFY_NO_FILTER_NODES</cite>
option is provided or the <cite>TSK_SIMPLIFY_FILTER_SITES</cite>,
<cite>TSK_SIMPLIFY_FILTER_POPULATIONS</cite> or <cite>TSK_SIMPLIFY_FILTER_INDIVIDUALS</cite>
options are <em>not</em> provided) the corresponding table is modified as
little as possible, and all pointers are guaranteed to remain valid
after simplification. The only changes made to an unfiltered table are
to update any references to tables that may have changed (for example,
remapping population IDs in the node table if
<cite>TSK_SIMPLIFY_FILTER_POPULATIONS</cite> was specified) or altering the
sample status flag of nodes.</p>
<p>By default, the node sample flags are updated by unsetting the
<a class="reference internal" href="#c.TSK_NODE_IS_SAMPLE" title="TSK_NODE_IS_SAMPLE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NODE_IS_SAMPLE</span></code></a> flag for all nodes and subsequently setting it
for the nodes provided as input to this function. The
<cite>TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS</cite> option will prevent this from occuring,
making it the responsibility of calling code to keep track of the ultimate
sample status of nodes. Using this option in conjunction with
<cite>TSK_SIMPLIFY_NO_FILTER_NODES</cite> (and without the
<cite>TSK_SIMPLIFY_FILTER_POPULATIONS</cite> and <cite>TSK_SIMPLIFY_FILTER_INDIVIDUALS</cite>
options) guarantees that the node table will not be written to during the
lifetime of this function.</p>
<p>The table collection will always be unindexed after simplify successfully completes.</p>
<p><strong>Options</strong>:</p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_FILTER_SITES" title="TSK_SIMPLIFY_FILTER_SITES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_FILTER_SITES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_FILTER_POPULATIONS" title="TSK_SIMPLIFY_FILTER_POPULATIONS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_FILTER_POPULATIONS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_FILTER_INDIVIDUALS" title="TSK_SIMPLIFY_FILTER_INDIVIDUALS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_FILTER_INDIVIDUALS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_NO_FILTER_NODES" title="TSK_SIMPLIFY_NO_FILTER_NODES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_NO_FILTER_NODES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS" title="TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY" title="TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_KEEP_UNARY" title="TSK_SIMPLIFY_KEEP_UNARY"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_KEEP_UNARY</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_KEEP_INPUT_ROOTS" title="TSK_SIMPLIFY_KEEP_INPUT_ROOTS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_KEEP_INPUT_ROOTS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS" title="TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS</span></code></a></p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible for populations and individuals to be filtered
even if <cite>TSK_SIMPLIFY_NO_FILTER_NODES</cite> is specified because there
may be entirely unreferenced entities in the input tables, which
are not affected by whether we filter nodes or not.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Migrations are currently not supported by simplify, and an error will
be raised if we attempt call simplify on a table collection with greater
than zero migrations. See <a class="github reference external" href="https://github.com/tskit-dev/tskit/issues/20">tskit-dev/tskit#20</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>samples</strong> – Either NULL or an array of num_samples distinct and valid node IDs. If non-null the nodes in this array will be marked as samples in the output. If NULL, the num_samples parameter is ignored and the samples in the output will be the same as the samples in the input. This is equivalent to populating the samples array with all of the sample nodes in the input in increasing order of ID. </p></li>
<li><p><strong>num_samples</strong> – The number of node IDs in the input samples array. Ignored if the samples array is NULL. </p></li>
<li><p><strong>options</strong> – Simplify options; see above for the available bitwise flags. For the default behaviour, a value of 0 should be provided. </p></li>
<li><p><strong>node_map</strong> – If not NULL, this array will be filled to define the mapping between nodes IDs in the table collection before and after simplification. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_subset">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga9c1351fe941955c130593e7b12397006"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_subset</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nodes</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_nodes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_subset" title="Link to this definition">#</a><br /></dt>
<dd><p>Subsets and reorders a table collection according to an array of nodes. </p>
<p><p>Reduces the table collection to contain only the entries referring to
the provided list of nodes, with nodes reordered according to the order
they appear in the <code class="docutils literal notranslate"><span class="pre">nodes</span></code> argument. Specifically, this subsets and reorders
each of the tables as follows (but see options, below):</p>
<ol class="arabic simple">
<li><p>Nodes: if in the list of nodes, and in the order provided.</p></li>
<li><p>Individuals: if referred to by a retained node.</p></li>
<li><p>Populations: if referred to by a retained node, and in the order first seen
when traversing the list of retained nodes.</p></li>
<li><p>Edges: if both parent and child are retained nodes.</p></li>
<li><p>Mutations: if the mutation’s node is a retained node.</p></li>
<li><p>Sites: if any mutations remain at the site after removing mutations.</p></li>
</ol>
<p>Retained individuals, edges, mutations, and sites appear in the same
order as in the original tables. Note that only the information <em>directly</em>
associated with the provided nodes is retained - for instance,
subsetting to nodes=[A, B] does not retain nodes ancestral to A and B,
and only retains the individuals A and B are in, and not their parents.</p>
<p>This function does <em>not</em> require the tables to be sorted.</p>
<p><strong>Options</strong>:</p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_SUBSET_NO_CHANGE_POPULATIONS" title="TSK_SUBSET_NO_CHANGE_POPULATIONS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SUBSET_NO_CHANGE_POPULATIONS</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_SUBSET_KEEP_UNREFERENCED" title="TSK_SUBSET_KEEP_UNREFERENCED"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SUBSET_KEEP_UNREFERENCED</span></code></a></p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Migrations are currently not supported by subset, and an error will
be raised if we attempt call subset on a table collection with greater
than zero migrations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>nodes</strong> – An array of num_nodes valid node IDs. </p></li>
<li><p><strong>num_nodes</strong> – The number of node IDs in the input nodes array. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_union">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga330f817f8d35836c5198b2c3ac0e2402"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_union</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other_node_mapping</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_union" title="Link to this definition">#</a><br /></dt>
<dd><p>Forms the node-wise union of two table collections. </p>
<p><p>Expands this table collection by adding the non-shared portions of another table
collection to itself. The <code class="docutils literal notranslate"><span class="pre">other_node_mapping</span></code> encodes which nodes in <code class="docutils literal notranslate"><span class="pre">other</span></code> are
equivalent to a node in <code class="docutils literal notranslate"><span class="pre">self</span></code>. The positions in the <code class="docutils literal notranslate"><span class="pre">other_node_mapping</span></code> array
correspond to node ids in <code class="docutils literal notranslate"><span class="pre">other</span></code>, and the elements encode the equivalent
node id in <code class="docutils literal notranslate"><span class="pre">self</span></code> or <a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the node is exclusive to <code class="docutils literal notranslate"><span class="pre">other</span></code>. Nodes
that are exclusive <code class="docutils literal notranslate"><span class="pre">other</span></code> are added to <code class="docutils literal notranslate"><span class="pre">self</span></code>, along with:</p>
<ol class="arabic simple">
<li><p>Individuals which are new to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p>Edges whose parent or child are new to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p>Sites which were not present in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
<li><p>Mutations whose nodes are new to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p></li>
</ol>
<p>By default, populations of newly added nodes are assumed to be new populations,
and added to the population table as well.</p>
<p>The behavior can be changed by the flags <code class="docutils literal notranslate"><span class="pre">TSK_UNION_ALL_EDGES</span></code> and
<code class="docutils literal notranslate"><span class="pre">TSK_UNION_ALL_MUTATIONS</span></code>, which will (respectively) add <em>all</em> edges
or <em>all</em> sites and mutations instead.</p>
<p>This operation will also sort the resulting tables, so the tables may change
even if nothing new is added, if the original tables were not sorted.</p>
<p><strong>Options</strong>:</p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_UNION_NO_CHECK_SHARED" title="TSK_UNION_NO_CHECK_SHARED"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_UNION_NO_CHECK_SHARED</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_UNION_NO_ADD_POP" title="TSK_UNION_NO_ADD_POP"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_UNION_NO_ADD_POP</span></code></a></p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Migrations are currently not supported by union, and an error will
be raised if we attempt call union on a table collection with migrations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>other_node_mapping</strong> – An array of node IDs that relate nodes in other to nodes in self: the k-th element of other_node_mapping should be the index of the equivalent node in self, or TSK_NULL if the node is not present in self (in which case it will be added to self). </p></li>
<li><p><strong>options</strong> – Union options; see above for the available bitwise flags. For the default behaviour, a value of 0 should be provided. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_set_time_units">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga24703879fe0f7483c3fef3426c2d9dc3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_set_time_units</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time_units</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">time_units_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_set_time_units" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the time_units. </p>
<p><p>Copies the time_units string to this table collection, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>time_units</strong> – A pointer to a char array. </p></li>
<li><p><strong>time_units_length</strong> – The size of the time units string in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_set_metadata">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga4e5f19a0801656596c75467f49ef06d9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_set_metadata</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_set_metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata. </p>
<p><p>Copies the metadata string to this table collection, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>metadata</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_set_metadata_schema">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga17dada0c0e78a4a0b4745e0eaec4003b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table collection, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_has_index">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gafa80e4988654ff3a42d4eaef23113b47"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_has_index</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_has_index" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if this table collection is indexed. </p>
<p><p>This method returns true if the table collection has an index
for the edge table. It guarantees that the index exists, and that
it is for the same number of edges that are in the edge table. It
does <em>not</em> guarantee that the index is valid (i.e., if the rows
in the edge have been permuted in some way since the index was built).</p>
<p>See the <a class="reference internal" href="#sec-c-api-table-indexes"><span class="std std-ref">Table indexes</span></a> section for details on the index
life-cycle.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if there is an index present for this table collection. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_drop_index">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga6499760341734267ff7b4d1d1e48f59c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_drop_index</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_drop_index" title="Link to this definition">#</a><br /></dt>
<dd><p>Deletes the indexes for this table collection. </p>
<p>Unconditionally drop the indexes that may be present for this table collection. It
is not an error to call this method on an unindexed table collection.
See the <a class="reference internal" href="#sec-c-api-table-indexes"><span class="std std-ref">Table indexes</span></a> section for details on the index
life-cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_build_index">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1gad9156485b1a21790aace699c6b524502"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_build_index</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_build_index" title="Link to this definition">#</a><br /></dt>
<dd><p>Builds indexes for this table collection. </p>
<p>Builds the tree traversal <a class="reference internal" href="data-model.html#sec-table-indexes"><span class="std std-ref">indexes</span></a> for this table
collection. Any existing index is first dropped using
<a class="reference internal" href="#c.tsk_table_collection_drop_index" title="tsk_table_collection_drop_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_drop_index()</span></code></a>. See the
<a class="reference internal" href="#sec-c-api-table-indexes"><span class="std std-ref">Table indexes</span></a> section for details on the index life-cycle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_collection_check_integrity">
<span class="target" id="group___t_a_b_l_e___c_o_l_l_e_c_t_i_o_n___a_p_i___g_r_o_u_p_1ga0dffccc43df921f3c6a27cf6795593ea"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_collection_check_integrity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_collection_check_integrity" title="Link to this definition">#</a><br /></dt>
<dd><p>Runs integrity checks on this table collection. </p>
<p><p>Checks the integrity of this table collection. The default checks (i.e., with
options = 0) guarantee the integrity of memory and entity references within the
table collection. All positions along the genome are checked
to see if they are finite values and within the required bounds. Time values
are checked to see if they are finite or marked as unknown.
Consistency of the direction of inheritance is also checked: whether
parents are more recent than children, mutations are not more recent
than their nodes or their mutation parents, etcetera.</p>
<p>To check if a set of tables fulfills the <a class="reference internal" href="data-model.html#sec-valid-tree-sequence-requirements"><span class="std std-ref">requirements</span></a> needed for a valid tree sequence, use
the <a class="reference internal" href="#c.TSK_CHECK_TREES" title="TSK_CHECK_TREES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_TREES</span></code></a> option. When this method is called with
<a class="reference internal" href="#c.TSK_CHECK_TREES" title="TSK_CHECK_TREES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_TREES</span></code></a>, the number of trees in the tree sequence is returned. Thus,
to check for errors client code should verify that the return value is less than zero.
All other options will return zero on success and a negative value on failure.</p>
<p>More fine-grained checks can be achieved using bitwise combinations of the
other options.</p>
<p><strong>Options</strong>:</p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CHECK_EDGE_ORDERING" title="TSK_CHECK_EDGE_ORDERING"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_EDGE_ORDERING</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_SITE_ORDERING" title="TSK_CHECK_SITE_ORDERING"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_SITE_ORDERING</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_SITE_DUPLICATES" title="TSK_CHECK_SITE_DUPLICATES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_SITE_DUPLICATES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_MUTATION_ORDERING" title="TSK_CHECK_MUTATION_ORDERING"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_MUTATION_ORDERING</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_INDIVIDUAL_ORDERING" title="TSK_CHECK_INDIVIDUAL_ORDERING"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_INDIVIDUAL_ORDERING</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_MIGRATION_ORDERING" title="TSK_CHECK_MIGRATION_ORDERING"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_MIGRATION_ORDERING</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_INDEXES" title="TSK_CHECK_INDEXES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_INDEXES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_CHECK_TREES" title="TSK_CHECK_TREES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CHECK_TREES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_NO_CHECK_POPULATION_REFS" title="TSK_NO_CHECK_POPULATION_REFS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_CHECK_POPULATION_REFS</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return a negative error value on if any problems are detected in the tree sequence. If the TSK_CHECK_TREES option is provided, the number of trees in the tree sequence will be returned, on success. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="individuals">
<h3>Individuals<a class="headerlink" href="#individuals" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_individual_t">
<span class="target" id="structtsk__individual__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_t</span></span></span><a class="headerlink" href="#c.tsk_individual_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single individual defined by a row in the individual table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
an individual and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.id">
<span class="target" id="structtsk__individual__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_individual_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.flags">
<span class="target" id="structtsk__individual__t_1a8c1a775f6bf2ddb0a918f9ed205aa079"></span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.tsk_individual_t.flags" title="Link to this definition">#</a><br /></dt>
<dd><p>Bitwise flags. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.location">
<span class="target" id="structtsk__individual__t_1adea9073402b828362791cb74a25f6e5a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">location</span></span></span><a class="headerlink" href="#c.tsk_individual_t.location" title="Link to this definition">#</a><br /></dt>
<dd><p>Spatial location. The number of dimensions is defined by <code class="docutils literal notranslate"><span class="pre">location_length</span></code>. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.location_length">
<span class="target" id="structtsk__individual__t_1a07581eeec37d2d85e019033d8556b2c1"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">location_length</span></span></span><a class="headerlink" href="#c.tsk_individual_t.location_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Number of spatial dimensions. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.parents">
<span class="target" id="structtsk__individual__t_1a23808aa60d59ff877959bd34d6d4b0d5"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parents</span></span></span><a class="headerlink" href="#c.tsk_individual_t.parents" title="Link to this definition">#</a><br /></dt>
<dd><p>IDs of the parents. The number of parents given by <code class="docutils literal notranslate"><span class="pre">parents_length</span></code></p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.parents_length">
<span class="target" id="structtsk__individual__t_1ace0a5b151b7a41b762f0c4b8ee16a967"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parents_length</span></span></span><a class="headerlink" href="#c.tsk_individual_t.parents_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Number of parents. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.metadata">
<span class="target" id="structtsk__individual__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_individual_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.metadata_length">
<span class="target" id="structtsk__individual__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_individual_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the metadata in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.nodes">
<span class="target" id="structtsk__individual__t_1a96209882a93c4be21a6433698be26da6"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">nodes</span></span></span><a class="headerlink" href="#c.tsk_individual_t.nodes" title="Link to this definition">#</a><br /></dt>
<dd><p>An array of the nodes associated with this individual. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_t.nodes_length">
<span class="target" id="structtsk__individual__t_1a98ada117b74d0bbc1d4e543acc4dbbf8"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nodes_length</span></span></span><a class="headerlink" href="#c.tsk_individual_t.nodes_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of nodes associated with this individual. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_individual_table_t">
<span class="target" id="structtsk__individual__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_t</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The individual table. </p>
<p>See the individual <a class="reference internal" href="data-model.html#sec-individual-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.num_rows">
<span class="target" id="structtsk__individual__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.location_length">
<span class="target" id="structtsk__individual__table__t_1a07581eeec37d2d85e019033d8556b2c1"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">location_length</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.location_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the location column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.parents_length">
<span class="target" id="structtsk__individual__table__t_1ace0a5b151b7a41b762f0c4b8ee16a967"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parents_length</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.parents_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the parent column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.metadata_length">
<span class="target" id="structtsk__individual__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.flags">
<span class="target" id="structtsk__individual__table__t_1a78463db8ca13e5df2899da0788a1115e"></span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.flags" title="Link to this definition">#</a><br /></dt>
<dd><p>The flags column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.location">
<span class="target" id="structtsk__individual__table__t_1a43c4cebb732302d6122df31abd759733"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">location</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.location" title="Link to this definition">#</a><br /></dt>
<dd><p>The location column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.location_offset">
<span class="target" id="structtsk__individual__table__t_1a912f0407b27b30ee4adf359fa94e41f6"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">location_offset</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.location_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The location_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.parents">
<span class="target" id="structtsk__individual__table__t_1a23808aa60d59ff877959bd34d6d4b0d5"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parents</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.parents" title="Link to this definition">#</a><br /></dt>
<dd><p>The parents column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.parents_offset">
<span class="target" id="structtsk__individual__table__t_1ac65562b131b516d3adbcdd0ddcb45128"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parents_offset</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.parents_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The parents_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.metadata">
<span class="target" id="structtsk__individual__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.metadata_offset">
<span class="target" id="structtsk__individual__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_individual_table_t.metadata_schema">
<span class="target" id="structtsk__individual__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_individual_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_init">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga52d2331a47e917d3c2a43e68af42718b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_free">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga0be23718890ab421ccb2e4ec249af4ee"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_add_row">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga9cec9a4fc8b61518ed0ca463bc03aa58"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">location_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parents_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this individual table. </p>
<p>Add a new individual with the specified <code class="docutils literal notranslate"><span class="pre">flags</span></code>, <code class="docutils literal notranslate"><span class="pre">location</span></code>, <code class="docutils literal notranslate"><span class="pre">parents</span></code> and
<code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. Copies of the <code class="docutils literal notranslate"><span class="pre">location</span></code>, <code class="docutils literal notranslate"><span class="pre">parents</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code>
parameters are taken immediately. See the <a class="reference internal" href="data-model.html#sec-individual-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>flags</strong> – The bitwise flags for the new individual. </p></li>
<li><p><strong>location</strong> – A pointer to a double array representing the spatial location of the new individual. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">location_length</span></code> is 0. </p></li>
<li><p><strong>location_length</strong> – The number of dimensions in the locations position. Note this the number of elements in the corresponding double array not the number of bytes. </p></li>
<li><p><strong>parents</strong> – A pointer to a <code class="docutils literal notranslate"><span class="pre">tsk_id</span></code> array representing the parents of the new individual. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">parents_length</span></code> is 0. </p></li>
<li><p><strong>parents_length</strong> – The number of parents. Note this the number of elements in the corresponding <code class="docutils literal notranslate"><span class="pre">tsk_id</span></code> array not the number of bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new individual. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added individual on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_update_row">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga97a513bdca2ac504f093ae25bd84c16b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">location_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parents_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. Copies of the <code class="docutils literal notranslate"><span class="pre">location</span></code>, <code class="docutils literal notranslate"><span class="pre">parents</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code>
parameters are taken immediately. See the <a class="reference internal" href="data-model.html#sec-individual-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>flags</strong> – The bitwise flags for the individual. </p></li>
<li><p><strong>location</strong> – A pointer to a double array representing the spatial location of the new individual. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">location_length</span></code> is 0. </p></li>
<li><p><strong>location_length</strong> – The number of dimensions in the locations position. Note this the number of elements in the corresponding double array not the number of bytes. </p></li>
<li><p><strong>parents</strong> – A pointer to a <code class="docutils literal notranslate"><span class="pre">tsk_id</span></code> array representing the parents of the new individual. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">parents_length</span></code> is 0. </p></li>
<li><p><strong>parents_length</strong> – The number of parents. Note this the number of elements in the corresponding <code class="docutils literal notranslate"><span class="pre">tsk_id</span></code> array not the number of bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new individual. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_clear">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga688dc929c2f2f8904c1a9b49af92609a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_individual_table_free" title="tsk_individual_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_individual_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_truncate">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6b1367a92112d60c249e0dce3737a668"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_extend">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga29d55ed5dcaf7d19847d2be01105f03e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_keep_rows">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab0f6a3b8a53528ba25ddac55f537cf5e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
<p>The values in the <code class="docutils literal notranslate"><span class="pre">parents</span></code> column are updated according to this map, so that
reference integrity within the table is maintained. As a consequence of this,
the values in the <code class="docutils literal notranslate"><span class="pre">parents</span></code> column for kept rows are bounds-checked and an
error raised if they are not valid. Rows that are deleted are not checked for
parent ID integrity.</p>
<p>If an attempt is made to delete rows that are referred to by the <code class="docutils literal notranslate"><span class="pre">parents</span></code>
column of rows that are retained, an error is raised.</p>
<p>These error conditions are checked before any alterations to the table are
made.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_equals">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaab0702e937c3dcccd707b947dca973f3"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_copy">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga385b22df74db453d03f62c55aded5915"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p><p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<p>Indexes that are present are also copied to the destination table.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised individual table. If not, it must be an uninitialised individual table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_get_row">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga5ccc3a52754aefd0ddd73a13a87fe132"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_individual_t" title="tsk_individual_t"><span class="n"><span class="pre">tsk_individual_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified individual struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__t"><span class="std std-ref">tsk_individual_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_metadata_schema">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga76065e9c9209a67e67dc2684353e8dca"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p>Copies the metadata schema string to this table, replacing any existing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_print_state">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga2ea47a01a2e6a8ff54709315ce2632bb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_columns">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1gad4e5c3e20857993c5509c9fc9081252f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>flags</strong> – The array of tsk_flag_t flag values to be copied. </p></li>
<li><p><strong>location</strong> – The array of double location values to be copied. </p></li>
<li><p><strong>location_offset</strong> – The array of tsk_size_t location offset values to be copied. </p></li>
<li><p><strong>parents</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>parents_offset</strong> – The array of tsk_size_t parent offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_append_columns">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1bb66d8026e4a9ecc93a21168b46cdc6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">location_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parents_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays </p></li>
<li><p><strong>flags</strong> – The array of tsk_flag_t flag values to be copied. </p></li>
<li><p><strong>location</strong> – The array of double location values to be copied. </p></li>
<li><p><strong>location_offset</strong> – The array of tsk_size_t location offset values to be copied. </p></li>
<li><p><strong>parents</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>parents_offset</strong> – The array of tsk_size_t parent offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_max_rows_increment">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga9ef701e1ee1be61bcecfa6c6af5e01a8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_max_metadata_length_increment">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga610f2c956c9a8e99066456fdc8a2ae75"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_max_location_length_increment">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga310bb5b37ec1763e83afc26b7d09cc82"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_max_location_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_location_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_max_location_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the location column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>max_location_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_individual_table_set_max_parents_length_increment">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa87661b116dcaf271b2f3f4739f3570a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_individual_table_set_max_parents_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_individual_table_t" title="tsk_individual_table_t"><span class="n"><span class="pre">tsk_individual_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_parents_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_individual_table_set_max_parents_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the parents column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__table__t"><span class="std std-ref">tsk_individual_table_t</span></a> object. </p></li>
<li><p><strong>max_parents_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="nodes">
<h3>Nodes<a class="headerlink" href="#nodes" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_node_t">
<span class="target" id="structtsk__node__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_t</span></span></span><a class="headerlink" href="#c.tsk_node_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single node defined by a row in the node table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a node and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.id">
<span class="target" id="structtsk__node__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_node_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.flags">
<span class="target" id="structtsk__node__t_1a8c1a775f6bf2ddb0a918f9ed205aa079"></span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.tsk_node_t.flags" title="Link to this definition">#</a><br /></dt>
<dd><p>Bitwise flags. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.time">
<span class="target" id="structtsk__node__t_1ab2d5aa7fce1a14d8bddfb2c333ea9679"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_node_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>Time. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.population">
<span class="target" id="structtsk__node__t_1a203762bc953fc408e687939f6f3c14dc"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">population</span></span></span><a class="headerlink" href="#c.tsk_node_t.population" title="Link to this definition">#</a><br /></dt>
<dd><p>Population ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.individual">
<span class="target" id="structtsk__node__t_1a7eebd48ac12d959154e6a97101460426"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">individual</span></span></span><a class="headerlink" href="#c.tsk_node_t.individual" title="Link to this definition">#</a><br /></dt>
<dd><p>Individual ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.metadata">
<span class="target" id="structtsk__node__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_node_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_t.metadata_length">
<span class="target" id="structtsk__node__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_node_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the metadata in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_node_table_t">
<span class="target" id="structtsk__node__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_t</span></span></span><a class="headerlink" href="#c.tsk_node_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The node table. </p>
<p>See the node <a class="reference internal" href="data-model.html#sec-node-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.num_rows">
<span class="target" id="structtsk__node__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.metadata_length">
<span class="target" id="structtsk__node__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.flags">
<span class="target" id="structtsk__node__table__t_1a78463db8ca13e5df2899da0788a1115e"></span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">flags</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.flags" title="Link to this definition">#</a><br /></dt>
<dd><p>The flags column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.time">
<span class="target" id="structtsk__node__table__t_1aa8ee7f1ed4f29ac1aadd955e247641e6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>The time column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.population">
<span class="target" id="structtsk__node__table__t_1a3e3ac25fab6b4622f2c2d65801e23643"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">population</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.population" title="Link to this definition">#</a><br /></dt>
<dd><p>The population column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.individual">
<span class="target" id="structtsk__node__table__t_1aa4aaed679c5ccf576e0e5ab24a0b59b9"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">individual</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.individual" title="Link to this definition">#</a><br /></dt>
<dd><p>The individual column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.metadata">
<span class="target" id="structtsk__node__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.metadata_offset">
<span class="target" id="structtsk__node__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_node_table_t.metadata_schema">
<span class="target" id="structtsk__node__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_node_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_init">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga017b17813e7bf628fad8078563e6207c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_free">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gadca336714a2278b6197aeb563d274311"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_add_row">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga31ae095f44e97a644e8a03eecf506cff"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">population</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">individual</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this node table. </p>
<p>Add a new node with the specified <code class="docutils literal notranslate"><span class="pre">flags</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code>, <code class="docutils literal notranslate"><span class="pre">population</span></code>,
<code class="docutils literal notranslate"><span class="pre">individual</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. A copy of the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameter
is taken immediately. See the <a class="reference internal" href="data-model.html#sec-node-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>flags</strong> – The bitwise flags for the new node. </p></li>
<li><p><strong>time</strong> – The time for the new node. </p></li>
<li><p><strong>population</strong> – The population for the new node. Set to TSK_NULL if not known. </p></li>
<li><p><strong>individual</strong> – The individual for the new node. Set to TSK_NULL if not known. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new node. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added node on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_update_row">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab1dcba9f2ac995feee0f535f23058c17"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">flags</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">population</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">individual</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. A copy of the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameter is taken immediately. See the
<a class="reference internal" href="data-model.html#sec-node-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns
in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>flags</strong> – The bitwise flags for the node. </p></li>
<li><p><strong>time</strong> – The time for the node. </p></li>
<li><p><strong>population</strong> – The population for the node. Set to TSK_NULL if not known. </p></li>
<li><p><strong>individual</strong> – The individual for the node. Set to TSK_NULL if not known. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the node. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_clear">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1a521685265e8cbbb3f100dd7742f557"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_node_table_free" title="tsk_node_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_node_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_truncate">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa097a679dc1cddb6bf696943dea5e035"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_extend">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6b4411e9dae7f0862d0547c3037a0417"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_keep_rows">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6b57414e03276f5a6af85c9e1b914908"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_equals">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gadb1592e64cc97dacc629f89a7828d164"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_copy">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga11f7e120a0b63e6443df956e894d4b80"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the TSK_NO_INIT option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised node table. If not, it must be an uninitialised node table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_get_row">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaceb59be6993da7413e00122dbf8ffde9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_node_t" title="tsk_node_t"><span class="n"><span class="pre">tsk_node_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified node struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__t"><span class="std std-ref">tsk_node_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_set_metadata_schema">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga5505f0e95dca0acbdf2be9e6df201b4f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_print_state">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga7dfbc51f03eccdc0c5e35887445a3946"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_set_columns">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga9a22e69a6f1cbb693d95a235c99b1141"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">population</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">individual</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>flags</strong> – The array of tsk_flag_t values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>population</strong> – The array of tsk_id_t population values to be copied. </p></li>
<li><p><strong>individual</strong> – The array of tsk_id_t individual values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_append_columns">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gae6969939182d5865f632da2fd46a1766"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">flags</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">population</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">individual</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays </p></li>
<li><p><strong>flags</strong> – The array of tsk_flag_t values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>population</strong> – The array of tsk_id_t population values to be copied. </p></li>
<li><p><strong>individual</strong> – The array of tsk_id_t individual values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_set_max_rows_increment">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga50ffb853fbfe8c132d69721cc17a5020"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_node_table_set_max_metadata_length_increment">
<span class="target" id="group___n_o_d_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6dab1bd3451369ec9ba2746e6b931646"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_node_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_node_table_t" title="tsk_node_table_t"><span class="n"><span class="pre">tsk_node_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_node_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__table__t"><span class="std std-ref">tsk_node_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="edges">
<h3>Edges<a class="headerlink" href="#edges" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_edge_t">
<span class="target" id="structtsk__edge__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_t</span></span></span><a class="headerlink" href="#c.tsk_edge_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single edge defined by a row in the edge table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
an edge and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.id">
<span class="target" id="structtsk__edge__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_edge_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.parent">
<span class="target" id="structtsk__edge__t_1acc72dc73b5119cdc54a99c9d847f4b55"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#c.tsk_edge_t.parent" title="Link to this definition">#</a><br /></dt>
<dd><p>Parent node ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.child">
<span class="target" id="structtsk__edge__t_1ad7dee2f317a94d811d4bb46f3cfed3ae"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">child</span></span></span><a class="headerlink" href="#c.tsk_edge_t.child" title="Link to this definition">#</a><br /></dt>
<dd><p>Child node ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.left">
<span class="target" id="structtsk__edge__t_1a5eeeb20fab9ff0f54568882b94d57921"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">left</span></span></span><a class="headerlink" href="#c.tsk_edge_t.left" title="Link to this definition">#</a><br /></dt>
<dd><p>Left coordinate. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.right">
<span class="target" id="structtsk__edge__t_1ab833bacb3fa8d1a189efcbba74f10fa1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">right</span></span></span><a class="headerlink" href="#c.tsk_edge_t.right" title="Link to this definition">#</a><br /></dt>
<dd><p>Right coordinate. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.metadata">
<span class="target" id="structtsk__edge__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_edge_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_t.metadata_length">
<span class="target" id="structtsk__edge__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_edge_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the metadata in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_edge_table_t">
<span class="target" id="structtsk__edge__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_t</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge table. </p>
<p>See the edge <a class="reference internal" href="data-model.html#sec-edge-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.num_rows">
<span class="target" id="structtsk__edge__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.metadata_length">
<span class="target" id="structtsk__edge__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.left">
<span class="target" id="structtsk__edge__table__t_1a39c7d5c86d4a9e9a5e4577b377fd21b2"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">left</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.left" title="Link to this definition">#</a><br /></dt>
<dd><p>The left column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.right">
<span class="target" id="structtsk__edge__table__t_1ad2e19c1329a6cba985b8c57f8d1884d9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">right</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.right" title="Link to this definition">#</a><br /></dt>
<dd><p>The right column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.parent">
<span class="target" id="structtsk__edge__table__t_1a46da4afff95627d99f17ba698625383b"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.parent" title="Link to this definition">#</a><br /></dt>
<dd><p>The parent column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.child">
<span class="target" id="structtsk__edge__table__t_1a842327e523cdc7979e8f3824d16a0d8d"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">child</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.child" title="Link to this definition">#</a><br /></dt>
<dd><p>The child column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.metadata">
<span class="target" id="structtsk__edge__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.metadata_offset">
<span class="target" id="structtsk__edge__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.metadata_schema">
<span class="target" id="structtsk__edge__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_edge_table_t.options">
<span class="target" id="structtsk__edge__table__t_1a7152ba5ac5b8e91c7afee6ff9f57e1d1"></span><a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">options</span></span></span><a class="headerlink" href="#c.tsk_edge_table_t.options" title="Link to this definition">#</a><br /></dt>
<dd><p>Flags for this table. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_init">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gae16e2d666bfa74df4f7e778bfc9019cc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p><p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<p><strong>Options</strong></p>
<p>Options can be specified by providing one or more of the following bitwise
flags:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_TABLE_NO_METADATA" title="TSK_TABLE_NO_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_TABLE_NO_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_free">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga7c3542085050715bec079ed81f83da55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_add_row">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga3544f9fcefe390960b348c10192b8367"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">left</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">right</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parent</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">child</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this edge table. </p>
<p>Add a new edge with the specified <code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">parent</span></code>, <code class="docutils literal notranslate"><span class="pre">child</span></code> and
<code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. See the <a class="reference internal" href="data-model.html#sec-edge-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>left</strong> – The left coordinate for the new edge. </p></li>
<li><p><strong>right</strong> – The right coordinate for the new edge. </p></li>
<li><p><strong>parent</strong> – The parent node for the new edge. </p></li>
<li><p><strong>child</strong> – The child node for the new edge. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new edge. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added edge on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_update_row">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga59cd280235f233ceebadaf64efac17ad"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">left</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">right</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parent</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">child</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. A copy of the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameter is taken immediately. See the
<a class="reference internal" href="data-model.html#sec-edge-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns
in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>left</strong> – The left coordinate for the edge. </p></li>
<li><p><strong>right</strong> – The right coordinate for the edge. </p></li>
<li><p><strong>parent</strong> – The parent node for the edge. </p></li>
<li><p><strong>child</strong> – The child node for the edge. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the edge. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_clear">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga45b71f963e14afe9fe30c65c74afafda"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_edge_table_free" title="tsk_edge_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_edge_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_truncate">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6820ef622c99eb48903c66edf804c364"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_extend">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga2ca8c07ac114db22f6a9e113e51f195c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code>,
append the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied
as-is and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_keep_rows">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga0047e6cf3f9688de71e87acfc6a92ed8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_equals">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1f316daa2bcd350ef63ac6586bc90514"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_copy">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga73e2d206d48688404688b12ba3378db3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised edge table. If not, it must be an uninitialised edge table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_get_row">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga165018253df9a53c78bf593d68bd8b9f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_edge_t" title="tsk_edge_t"><span class="n"><span class="pre">tsk_edge_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified edge struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__t"><span class="std std-ref">tsk_edge_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_set_metadata_schema">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaaf309a042a9b2851b5236fee4925e6d9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_print_state">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga4d43f0d9aac7d4afa190b72f7ffd97ca"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_set_columns">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga758ef2a75c22cd3b476177dc5c47466e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">left</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">right</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">child</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>left</strong> – The array of double left values to be copied. </p></li>
<li><p><strong>right</strong> – The array of double right values to be copied. </p></li>
<li><p><strong>parent</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>child</strong> – The array of tsk_id_t child values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_append_columns">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gafa3f70caef3bff7f6271e60150525279"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">left</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">right</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">child</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>left</strong> – The array of double left values to be copied. </p></li>
<li><p><strong>right</strong> – The array of double right values to be copied. </p></li>
<li><p><strong>parent</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>child</strong> – The array of tsk_id_t child values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_set_max_rows_increment">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaeed70ec6a8a52684ffcbbff54ec0a7ba"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_set_max_metadata_length_increment">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga536e18a86da307bb4f09a3015e0b3450"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_edge_table_squash">
<span class="target" id="group___e_d_g_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga7a70642d0860c2ffd743984859ebf324"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_edge_table_squash</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_edge_table_t" title="tsk_edge_table_t"><span class="n"><span class="pre">tsk_edge_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_edge_table_squash" title="Link to this definition">#</a><br /></dt>
<dd><p>Squash adjacent edges in-place. </p>
<p>Sorts, then condenses the table into the smallest possible number of rows by
combining any adjacent edges. A pair of edges is said to be <cite>adjacent</cite> if
they have the same parent and child nodes, and if the left coordinate of
one of the edges is equal to the right coordinate of the other edge.
This process is performed in-place so that any set of adjacent edges is
replaced by a single edge. The new edge will have the same parent and child
node, a left coordinate equal to the smallest left coordinate in the set,
and a right coordinate equal to the largest right coordinate in the set.
The new edge table will be sorted in the canonical order (P, C, L, R).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that this method will fail if any edges have non-empty metadata.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__table__t"><span class="std std-ref">tsk_edge_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="migrations">
<h3>Migrations<a class="headerlink" href="#migrations" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_migration_t">
<span class="target" id="structtsk__migration__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_t</span></span></span><a class="headerlink" href="#c.tsk_migration_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single migration defined by a row in the migration table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a migration and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.id">
<span class="target" id="structtsk__migration__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_migration_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.source">
<span class="target" id="structtsk__migration__t_1a9bbc47bb873e7bbebdae7fb13bbfbaf5"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">source</span></span></span><a class="headerlink" href="#c.tsk_migration_t.source" title="Link to this definition">#</a><br /></dt>
<dd><p>Source population ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.dest">
<span class="target" id="structtsk__migration__t_1a4e61de85b750055c3367de5a0ece4b94"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dest</span></span></span><a class="headerlink" href="#c.tsk_migration_t.dest" title="Link to this definition">#</a><br /></dt>
<dd><p>Destination population ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.node">
<span class="target" id="structtsk__migration__t_1af64ab3493d08c85b22b2de0096fedfbe"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">node</span></span></span><a class="headerlink" href="#c.tsk_migration_t.node" title="Link to this definition">#</a><br /></dt>
<dd><p>Node ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.left">
<span class="target" id="structtsk__migration__t_1a5eeeb20fab9ff0f54568882b94d57921"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">left</span></span></span><a class="headerlink" href="#c.tsk_migration_t.left" title="Link to this definition">#</a><br /></dt>
<dd><p>Left coordinate. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.right">
<span class="target" id="structtsk__migration__t_1ab833bacb3fa8d1a189efcbba74f10fa1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">right</span></span></span><a class="headerlink" href="#c.tsk_migration_t.right" title="Link to this definition">#</a><br /></dt>
<dd><p>Right coordinate. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.time">
<span class="target" id="structtsk__migration__t_1ab2d5aa7fce1a14d8bddfb2c333ea9679"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_migration_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>Time. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.metadata">
<span class="target" id="structtsk__migration__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_migration_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_t.metadata_length">
<span class="target" id="structtsk__migration__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_migration_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the metadata in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_migration_table_t">
<span class="target" id="structtsk__migration__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_t</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The migration table. </p>
<p>See the migration <a class="reference internal" href="data-model.html#sec-migration-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.num_rows">
<span class="target" id="structtsk__migration__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.metadata_length">
<span class="target" id="structtsk__migration__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.source">
<span class="target" id="structtsk__migration__table__t_1a85366ec92c3d98ad6a40e1493d7b6133"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">source</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.source" title="Link to this definition">#</a><br /></dt>
<dd><p>The source column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.dest">
<span class="target" id="structtsk__migration__table__t_1a5b7bc1a4ff844510ec14a612004328a7"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">dest</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.dest" title="Link to this definition">#</a><br /></dt>
<dd><p>The dest column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.node">
<span class="target" id="structtsk__migration__table__t_1a3e07850653d519f910c6fea18c217a4b"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">node</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.node" title="Link to this definition">#</a><br /></dt>
<dd><p>The node column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.left">
<span class="target" id="structtsk__migration__table__t_1a39c7d5c86d4a9e9a5e4577b377fd21b2"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">left</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.left" title="Link to this definition">#</a><br /></dt>
<dd><p>The left column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.right">
<span class="target" id="structtsk__migration__table__t_1ad2e19c1329a6cba985b8c57f8d1884d9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">right</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.right" title="Link to this definition">#</a><br /></dt>
<dd><p>The right column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.time">
<span class="target" id="structtsk__migration__table__t_1aa8ee7f1ed4f29ac1aadd955e247641e6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>The time column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.metadata">
<span class="target" id="structtsk__migration__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.metadata_offset">
<span class="target" id="structtsk__migration__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_migration_table_t.metadata_schema">
<span class="target" id="structtsk__migration__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_migration_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_init">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga58c26ae70770f6bd776adb481c7123ba"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_free">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gadec40b2946fbb8a8165d9c8d9568c592"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_add_row">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaac2340cea3bb2e7531435abe537d07dc"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">left</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">right</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">node</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">source</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">dest</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this migration table. </p>
<p>Add a new migration with the specified <code class="docutils literal notranslate"><span class="pre">left</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code>, <code class="docutils literal notranslate"><span class="pre">node</span></code>,
<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">dest</span></code>, <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table.
See the <a class="reference internal" href="data-model.html#sec-migration-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>left</strong> – The left coordinate for the new migration. </p></li>
<li><p><strong>right</strong> – The right coordinate for the new migration. </p></li>
<li><p><strong>node</strong> – The node ID for the new migration. </p></li>
<li><p><strong>source</strong> – The source population ID for the new migration. </p></li>
<li><p><strong>dest</strong> – The destination population ID for the new migration. </p></li>
<li><p><strong>time</strong> – The time for the new migration. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new migration. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added migration on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_update_row">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa0350c071ab0d98e737ede1450e94d8f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">left</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">right</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">node</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">source</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">dest</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. A copy of the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameter is taken immediately. See the
<a class="reference internal" href="data-model.html#sec-migration-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns
in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>left</strong> – The left coordinate for the migration. </p></li>
<li><p><strong>right</strong> – The right coordinate for the migration. </p></li>
<li><p><strong>node</strong> – The node ID for the migration. </p></li>
<li><p><strong>source</strong> – The source population ID for the migration. </p></li>
<li><p><strong>dest</strong> – The destination population ID for the migration. </p></li>
<li><p><strong>time</strong> – The time for the migration. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the migration. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_clear">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6d2172167ea1cb9d4966ccbdca5b99ea"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_migration_table_free" title="tsk_migration_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_migration_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_truncate">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaddedae20a5662e360d26543c1d054275"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_extend">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa606e8f16c54661b237c1ff8ac8ff4db"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_keep_rows">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga872621ede094f9a95c72aa3d5c2575cd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_equals">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga865d27b31803be545e62c8b9c5df766b"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_copy">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga89fcfa9ca79d04969a0cac72c5d9d27b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised migration table. If not, it must be an uninitialised migration table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_get_row">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gae79b258003dd27c7a379a976a09257a2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_migration_t" title="tsk_migration_t"><span class="n"><span class="pre">tsk_migration_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified migration struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__t"><span class="std std-ref">tsk_migration_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_set_metadata_schema">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga26f0a24d11cb3b3b47a278645edf16b4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_print_state">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga65f083124978b87b6fde760f2db27463"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_set_columns">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga656f40af6477f19a0422cf8682c3b0a5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">left</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">right</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">source</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>left</strong> – The array of double left values to be copied. </p></li>
<li><p><strong>right</strong> – The array of double right values to be copied. </p></li>
<li><p><strong>node</strong> – The array of tsk_id_t node values to be copied. </p></li>
<li><p><strong>source</strong> – The array of tsk_id_t source values to be copied. </p></li>
<li><p><strong>dest</strong> – The array of tsk_id_t dest values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_append_columns">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1589feaa96c5ebfc5078cd7d469e4b4c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">left</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">right</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">source</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays </p></li>
<li><p><strong>left</strong> – The array of double left values to be copied. </p></li>
<li><p><strong>right</strong> – The array of double right values to be copied. </p></li>
<li><p><strong>node</strong> – The array of tsk_id_t node values to be copied. </p></li>
<li><p><strong>source</strong> – The array of tsk_id_t source values to be copied. </p></li>
<li><p><strong>dest</strong> – The array of tsk_id_t dest values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_set_max_rows_increment">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga8a0c0a681db4d6caf0f88a0a14c22915"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_migration_table_set_max_metadata_length_increment">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga7dd25c9bfc372b17de33be535c50d44c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_migration_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_migration_table_t" title="tsk_migration_table_t"><span class="n"><span class="pre">tsk_migration_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_migration_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__table__t"><span class="std std-ref">tsk_migration_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="sites">
<h3>Sites<a class="headerlink" href="#sites" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_site_t">
<span class="target" id="structtsk__site__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_t</span></span></span><a class="headerlink" href="#c.tsk_site_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single site defined by a row in the site table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a site and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.id">
<span class="target" id="structtsk__site__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_site_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.position">
<span class="target" id="structtsk__site__t_1aa1b2c258efdc9e057ee99a45179692fd"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">position</span></span></span><a class="headerlink" href="#c.tsk_site_t.position" title="Link to this definition">#</a><br /></dt>
<dd><p>Position coordinate. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.ancestral_state">
<span class="target" id="structtsk__site__t_1ab0b846dbaca79ffdda4423174af410bb"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ancestral_state</span></span></span><a class="headerlink" href="#c.tsk_site_t.ancestral_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Ancestral state. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.ancestral_state_length">
<span class="target" id="structtsk__site__t_1a7e0662aab2294edb07616abfc1b57ae2"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ancestral_state_length</span></span></span><a class="headerlink" href="#c.tsk_site_t.ancestral_state_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Ancestral state length in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.metadata">
<span class="target" id="structtsk__site__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_site_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.metadata_length">
<span class="target" id="structtsk__site__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_site_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata length in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.mutations">
<span class="target" id="structtsk__site__t_1a10ba40cf9b9bf34fc6c669d8d0676616"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_t" title="tsk_mutation_t"><span class="n"><span class="pre">tsk_mutation_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">mutations</span></span></span><a class="headerlink" href="#c.tsk_site_t.mutations" title="Link to this definition">#</a><br /></dt>
<dd><p>An array of this site’s mutations. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_t.mutations_length">
<span class="target" id="structtsk__site__t_1abe11f9fd8eb3630740b546b1da782c61"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mutations_length</span></span></span><a class="headerlink" href="#c.tsk_site_t.mutations_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of mutations at this site. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_site_table_t">
<span class="target" id="structtsk__site__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_t</span></span></span><a class="headerlink" href="#c.tsk_site_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The site table. </p>
<p>See the site <a class="reference internal" href="data-model.html#sec-site-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.num_rows">
<span class="target" id="structtsk__site__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.metadata_length">
<span class="target" id="structtsk__site__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.position">
<span class="target" id="structtsk__site__table__t_1a49ce4805ac4c02f4893ab4e3bcc5fcd5"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">position</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.position" title="Link to this definition">#</a><br /></dt>
<dd><p>The position column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.ancestral_state">
<span class="target" id="structtsk__site__table__t_1abc33aa1eb9a0944c6bec7c5e6fbc4bf0"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ancestral_state</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.ancestral_state" title="Link to this definition">#</a><br /></dt>
<dd><p>The ancestral_state column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.ancestral_state_offset">
<span class="target" id="structtsk__site__table__t_1a28a17f95825cf5ab4d571dbf82cd68fd"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ancestral_state_offset</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.ancestral_state_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The ancestral_state_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.metadata">
<span class="target" id="structtsk__site__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.metadata_offset">
<span class="target" id="structtsk__site__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_site_table_t.metadata_schema">
<span class="target" id="structtsk__site__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_site_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_init">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga3f1b13f5569d4691feb22a5b8f740dca"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_free">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa90311da1c67ad3e991992dd864fe347"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_add_row">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab3636bc6764a3a3c139957a6ef9dc366"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">position</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">ancestral_state_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this site table. </p>
<p>Add a new site with the specified <code class="docutils literal notranslate"><span class="pre">position</span></code>, <code class="docutils literal notranslate"><span class="pre">ancestral_state</span></code>
and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. Copies of <code class="docutils literal notranslate"><span class="pre">ancestral_state</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code>
are immediately taken. See the <a class="reference internal" href="data-model.html#sec-site-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>position</strong> – The position coordinate for the new site. </p></li>
<li><p><strong>ancestral_state</strong> – The ancestral_state for the new site. </p></li>
<li><p><strong>ancestral_state_length</strong> – The length of the ancestral_state in bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new site. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added site on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_update_row">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga26f15ce556940dc42465886b2c3999ad"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">position</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">ancestral_state_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. Copies of the <code class="docutils literal notranslate"><span class="pre">ancestral_state</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameters are taken
immediately. See the <a class="reference internal" href="data-model.html#sec-site-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>position</strong> – The position coordinate for the site. </p></li>
<li><p><strong>ancestral_state</strong> – The ancestral_state for the site. </p></li>
<li><p><strong>ancestral_state_length</strong> – The length of the ancestral_state in bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the site. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_clear">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab656ed0190bf14773dd8e2ec6e2f18c8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_site_table_free" title="tsk_site_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_site_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_truncate">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga8eefa959331c35f735693014acafdbd7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_extend">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga84a6a852375480727701fd7eb4c645b6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_keep_rows">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaebe40e489dd9fc53d6564b9b704e4183"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_equals">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab65b03d951e2d3a8b7b71fbf981563af"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_copy">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa8eca89206e605d446c4e049dc8da331"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised site table. If not, it must be an uninitialised site table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_get_row">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga5a97a7f688c91138de2bdaea05e308cd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><span class="n"><span class="pre">tsk_site_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p><p>Updates the specified site struct to reflect the values in the specified row.</p>
<p>This function always sets the <code class="docutils literal notranslate"><span class="pre">mutations</span></code> and <code class="docutils literal notranslate"><span class="pre">mutations_length</span></code>
fields in the parameter <a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">tsk_site_t</span></code></a> to <code class="docutils literal notranslate"><span class="pre">NULL</span></code> and <code class="docutils literal notranslate"><span class="pre">0</span></code> respectively.
To get access to the mutations for a particular site, please use the
tree sequence method, <a class="reference internal" href="#c.tsk_treeseq_get_site" title="tsk_treeseq_get_site"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_get_site()</span></code></a>.</p>
<p>Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__t"><span class="std std-ref">tsk_site_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_set_metadata_schema">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga8c3f965577226ebf73b2529eab0e7c25"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_print_state">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaeafea0eacf0a8b13bb86aa005c6546d4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_set_columns">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga203e1dc21a0d8b32e8aad0fbe34c41c6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">position</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>position</strong> – The array of double position values to be copied. </p></li>
<li><p><strong>ancestral_state</strong> – The array of char ancestral state values to be copied. </p></li>
<li><p><strong>ancestral_state_offset</strong> – The array of tsk_size_t ancestral state offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_append_columns">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga4471707a26ff6378f00ecd426cd468a3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">position</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ancestral_state_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>position</strong> – The array of double position values to be copied. </p></li>
<li><p><strong>ancestral_state</strong> – The array of char ancestral state values to be copied. </p></li>
<li><p><strong>ancestral_state_offset</strong> – The array of tsk_size_t ancestral state offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_set_max_rows_increment">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6d8f0704c6c1a11ce8cc6399fce8839c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_set_max_metadata_length_increment">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gac189a1ce8e1e4579a4530f880be8388c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_site_table_set_max_ancestral_state_length_increment">
<span class="target" id="group___s_i_t_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga277b26960de98ab6078dcc3b8c57151b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_site_table_set_max_ancestral_state_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_site_table_t" title="tsk_site_table_t"><span class="n"><span class="pre">tsk_site_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_ancestral_state_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_site_table_set_max_ancestral_state_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the ancestral_state column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__table__t"><span class="std std-ref">tsk_site_table_t</span></a> object. </p></li>
<li><p><strong>max_ancestral_state_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="mutations">
<h3>Mutations<a class="headerlink" href="#mutations" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_mutation_t">
<span class="target" id="structtsk__mutation__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_t</span></span></span><a class="headerlink" href="#c.tsk_mutation_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single mutation defined by a row in the mutation table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a mutation and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.id">
<span class="target" id="structtsk__mutation__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.site">
<span class="target" id="structtsk__mutation__t_1a068348b2e16a6b66c1ba2891a888d654"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">site</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.site" title="Link to this definition">#</a><br /></dt>
<dd><p>Site ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.node">
<span class="target" id="structtsk__mutation__t_1af64ab3493d08c85b22b2de0096fedfbe"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">node</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.node" title="Link to this definition">#</a><br /></dt>
<dd><p>Node ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.parent">
<span class="target" id="structtsk__mutation__t_1acc72dc73b5119cdc54a99c9d847f4b55"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.parent" title="Link to this definition">#</a><br /></dt>
<dd><p>Parent mutation ID. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.time">
<span class="target" id="structtsk__mutation__t_1ab2d5aa7fce1a14d8bddfb2c333ea9679"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>Mutation time. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.derived_state">
<span class="target" id="structtsk__mutation__t_1a5a6c0dfb2f6d0097055f720fb98e7724"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">derived_state</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.derived_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Derived state. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.derived_state_length">
<span class="target" id="structtsk__mutation__t_1afbbd5cb9c071918542fb045a43956f14"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">derived_state_length</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.derived_state_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the derived state in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.metadata">
<span class="target" id="structtsk__mutation__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.metadata_length">
<span class="target" id="structtsk__mutation__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the metadata in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.edge">
<span class="target" id="structtsk__mutation__t_1a662f1120b8767e7f15000417d2277208"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">edge</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.edge" title="Link to this definition">#</a><br /></dt>
<dd><p>The ID of the edge that this mutation lies on, or TSK_NULL if there is no corresponding edge. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.inherited_state">
<span class="target" id="structtsk__mutation__t_1a0ce4472104fe859899bce8b2b775bc56"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">inherited_state</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.inherited_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Inherited state. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_t.inherited_state_length">
<span class="target" id="structtsk__mutation__t_1ada8ec19455f37bff614656a848d4a928"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inherited_state_length</span></span></span><a class="headerlink" href="#c.tsk_mutation_t.inherited_state_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Size of the inherited state in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t">
<span class="target" id="structtsk__mutation__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The mutation table. </p>
<p>See the mutation <a class="reference internal" href="data-model.html#sec-mutation-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.num_rows">
<span class="target" id="structtsk__mutation__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.metadata_length">
<span class="target" id="structtsk__mutation__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.node">
<span class="target" id="structtsk__mutation__table__t_1a3e07850653d519f910c6fea18c217a4b"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">node</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.node" title="Link to this definition">#</a><br /></dt>
<dd><p>The node column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.site">
<span class="target" id="structtsk__mutation__table__t_1a936151a4c5fd785fdea6a38d820df516"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">site</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.site" title="Link to this definition">#</a><br /></dt>
<dd><p>The site column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.parent">
<span class="target" id="structtsk__mutation__table__t_1a46da4afff95627d99f17ba698625383b"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.parent" title="Link to this definition">#</a><br /></dt>
<dd><p>The parent column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.time">
<span class="target" id="structtsk__mutation__table__t_1aa8ee7f1ed4f29ac1aadd955e247641e6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">time</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.time" title="Link to this definition">#</a><br /></dt>
<dd><p>The time column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.derived_state">
<span class="target" id="structtsk__mutation__table__t_1a269482e2c79a26c604fc12a532d496c1"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">derived_state</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.derived_state" title="Link to this definition">#</a><br /></dt>
<dd><p>The derived_state column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.derived_state_offset">
<span class="target" id="structtsk__mutation__table__t_1a30669e654a87451f4617f61307fa5866"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">derived_state_offset</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.derived_state_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The derived_state_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.metadata">
<span class="target" id="structtsk__mutation__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.metadata_offset">
<span class="target" id="structtsk__mutation__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_mutation_table_t.metadata_schema">
<span class="target" id="structtsk__mutation__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_mutation_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_init">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga60a288581b2ba94eaf8dbbfc165f63cc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_free">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gae2bfa4bfecec62b9e922982ea4a117e2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_add_row">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga055423976922f10308777164fb400ad4"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">site</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">node</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parent</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">derived_state_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this mutation table. </p>
<p>Add a new mutation with the specified <code class="docutils literal notranslate"><span class="pre">site</span></code>, <code class="docutils literal notranslate"><span class="pre">parent</span></code>, <code class="docutils literal notranslate"><span class="pre">derived_state</span></code>
and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. Copies of <code class="docutils literal notranslate"><span class="pre">derived_state</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code>
are immediately taken. See the <a class="reference internal" href="data-model.html#sec-mutation-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>site</strong> – The site ID for the new mutation. </p></li>
<li><p><strong>node</strong> – The ID of the node this mutation occurs over. </p></li>
<li><p><strong>parent</strong> – The ID of the parent mutation. </p></li>
<li><p><strong>time</strong> – The time of the mutation. </p></li>
<li><p><strong>derived_state</strong> – The derived_state for the new mutation. </p></li>
<li><p><strong>derived_state_length</strong> – The length of the derived_state in bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new mutation. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added mutation on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_update_row">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gad88a409903d940b2affb03617f5d0455"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">site</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">node</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">parent</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">derived_state_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. Copies of the <code class="docutils literal notranslate"><span class="pre">derived_state</span></code> and <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameters are taken
immediately. See the <a class="reference internal" href="data-model.html#sec-mutation-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>site</strong> – The site ID for the mutation. </p></li>
<li><p><strong>node</strong> – The ID of the node this mutation occurs over. </p></li>
<li><p><strong>parent</strong> – The ID of the parent mutation. </p></li>
<li><p><strong>time</strong> – The time of the mutation. </p></li>
<li><p><strong>derived_state</strong> – The derived_state for the mutation. </p></li>
<li><p><strong>derived_state_length</strong> – The length of the derived_state in bytes. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the mutation. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_clear">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga3035aa39b6bf5f9c7222b8bc79be892e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_mutation_table_free" title="tsk_mutation_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_mutation_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_truncate">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab776160fbea97c5b744065376426c98e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_extend">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6487cbbe30a74f2fe2da251be5775bae"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_keep_rows">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga7ad8fb6d761f617746044b8aa7aa2d55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
<p>The values in the <code class="docutils literal notranslate"><span class="pre">parent</span></code> column are updated according to this map, so that
reference integrity within the table is maintained. As a consequence of this,
the values in the <code class="docutils literal notranslate"><span class="pre">parent</span></code> column for kept rows are bounds-checked and an
error raised if they are not valid. Rows that are deleted are not checked for
parent ID integrity.</p>
<p>If an attempt is made to delete rows that are referred to by the <code class="docutils literal notranslate"><span class="pre">parent</span></code>
column of rows that are retained, an error is raised.</p>
<p>These error conditions are checked before any alterations to the table are
made.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_equals">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gae213161b1403a6a78b1ac9230564bb77"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_copy">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga5585d28044b7bc03e79b504b23347134"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised mutation table. If not, it must be an uninitialised mutation table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_get_row">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gad4b28b260021620c2ff3feb9bc645da0"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_mutation_t" title="tsk_mutation_t"><span class="n"><span class="pre">tsk_mutation_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p><p>Updates the specified mutation struct to reflect the values in the specified row.</p>
<p>This function always sets the <code class="docutils literal notranslate"><span class="pre">edge</span></code> field in parameter
<a class="reference internal" href="#c.tsk_mutation_t" title="tsk_mutation_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">tsk_mutation_t</span></code></a> to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code>. To determine the ID of
the edge associated with a particular mutation, please use the
tree sequence method, <a class="reference internal" href="#c.tsk_treeseq_get_mutation" title="tsk_treeseq_get_mutation"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_get_mutation()</span></code></a>.</p>
<p>Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__t"><span class="std std-ref">tsk_mutation_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_set_metadata_schema">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga45ce223f538dfe0a9f4bcbfe814f053b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_print_state">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga974b34df3d4b0ebfb8d7cfe0b61f7d0e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_set_columns">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaeaa8d90c1067451997031470617d77cc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">site</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>site</strong> – The array of tsk_id_t site values to be copied. </p></li>
<li><p><strong>node</strong> – The array of tsk_id_t node values to be copied. </p></li>
<li><p><strong>parent</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>derived_state</strong> – The array of char derived_state values to be copied. </p></li>
<li><p><strong>derived_state_offset</strong> – The array of tsk_size_t derived state offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_append_columns">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gad6382953e118c4fcefaf5c4f9ef08673"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">site</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">time</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">derived_state_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>site</strong> – The array of tsk_id_t site values to be copied. </p></li>
<li><p><strong>node</strong> – The array of tsk_id_t node values to be copied. </p></li>
<li><p><strong>parent</strong> – The array of tsk_id_t parent values to be copied. </p></li>
<li><p><strong>time</strong> – The array of double time values to be copied. </p></li>
<li><p><strong>derived_state</strong> – The array of char derived_state values to be copied. </p></li>
<li><p><strong>derived_state_offset</strong> – The array of tsk_size_t derived state offset values to be copied. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_set_max_rows_increment">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga77f489f0f314e9fd9effca834b9a53f2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_set_max_metadata_length_increment">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga35fab58f5b7a34a25429bdfd85c78a98"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_mutation_table_set_max_derived_state_length_increment">
<span class="target" id="group___m_u_t_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga09636ac2386b831b1a2cde1578d5c6c0"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_mutation_table_set_max_derived_state_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_mutation_table_t" title="tsk_mutation_table_t"><span class="n"><span class="pre">tsk_mutation_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_derived_state_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_mutation_table_set_max_derived_state_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the derived_state column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__table__t"><span class="std std-ref">tsk_mutation_table_t</span></a> object. </p></li>
<li><p><strong>max_derived_state_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="populations">
<h3>Populations<a class="headerlink" href="#populations" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_population_t">
<span class="target" id="structtsk__population__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_t</span></span></span><a class="headerlink" href="#c.tsk_population_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single population defined by a row in the population table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a population and its properties.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_t.id">
<span class="target" id="structtsk__population__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_population_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_t.metadata">
<span class="target" id="structtsk__population__t_1ade9c5680dc51a034ceb679fc61f025c1"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_population_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_t.metadata_length">
<span class="target" id="structtsk__population__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_population_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata length in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_population_table_t">
<span class="target" id="structtsk__population__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_t</span></span></span><a class="headerlink" href="#c.tsk_population_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The population table. </p>
<p>See the population <a class="reference internal" href="data-model.html#sec-population-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_table_t.num_rows">
<span class="target" id="structtsk__population__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_population_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_table_t.metadata_length">
<span class="target" id="structtsk__population__table__t_1a8baafcbd9877860fcad02f9350a0b2b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">metadata_length</span></span></span><a class="headerlink" href="#c.tsk_population_table_t.metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_table_t.metadata">
<span class="target" id="structtsk__population__table__t_1ace70beae1a71187d5961a8d7c0dafb7b"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata</span></span></span><a class="headerlink" href="#c.tsk_population_table_t.metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_table_t.metadata_offset">
<span class="target" id="structtsk__population__table__t_1aa5d4b8d0fd9121dcd7618098bfdd9a50"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_offset</span></span></span><a class="headerlink" href="#c.tsk_population_table_t.metadata_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_population_table_t.metadata_schema">
<span class="target" id="structtsk__population__table__t_1ae529f60b9eb4e1faaca99066fa4da00f"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">metadata_schema</span></span></span><a class="headerlink" href="#c.tsk_population_table_t.metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>The metadata schema. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_init">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gafa0a0d65882859c2fa43ebf7e27b6726"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_free">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga87388a76d20cbb7e41bd3cb345b6f54d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_add_row">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga3c611bd13db95fecf350927e7443b7bc"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this population table. </p>
<p>Add a new population with the specified <code class="docutils literal notranslate"><span class="pre">metadata</span></code> to the table. A copy of the
<code class="docutils literal notranslate"><span class="pre">metadata</span></code> is immediately taken. See the <a class="reference internal" href="data-model.html#sec-population-table-definition"><span class="std std-ref">table definition</span></a> for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the new population. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added population on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_update_row">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa2d3c1ed8fe11491e5de7e835f7bee41"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. A copy of the <code class="docutils literal notranslate"><span class="pre">metadata</span></code> parameter is taken immediately. See the
<a class="reference internal" href="data-model.html#sec-population-table-definition"><span class="std std-ref">table definition</span></a> for details of the
columns in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>metadata</strong> – The metadata to be associated with the population. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">metadata_length</span></code> is 0. </p></li>
<li><p><strong>metadata_length</strong> – The size of the metadata array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_clear">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga6fbe36e37b7c9806313f544a51b3c1a1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_population_table_free" title="tsk_population_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_population_table_free()</span></code></a> to free the table’s internal resources. Note that the
metadata schema is not cleared.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_truncate">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga696532046bf846a7fdbcba9155ef7954"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_extend">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga0ceb9c1da00c161b9a49c7919704f5f4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table. Note that metadata is copied as-is
and is not checked for compatibility with any existing schema on this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_keep_rows">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaba57e26231d1e1d9a68f009173ca260d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_equals">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga866101c6d56b2c8704b34a2917f8360d"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns,
and their metadata schemas are byte-wise identical.</p>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#c.TSK_CMP_IGNORE_METADATA" title="TSK_CMP_IGNORE_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_METADATA</span></code></a></dt><dd><p>Do not include metadata in the comparison. Note that as metadata is the
only column in the population table, two population tables are considered
equal if they have the same number of rows if this flag is specified.</p>
</dd>
</dl>
</li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_copy">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaf0757459b5b340a0ed2c459f36f5fe4f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised population table. If not, it must be an uninitialised population table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_get_row">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga88172fd1154cced0a9a47f596ff3de33"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_population_t" title="tsk_population_t"><span class="n"><span class="pre">tsk_population_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified population struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__t"><span class="std std-ref">tsk_population_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_set_metadata_schema">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaec2fbbc8abbe76a66110f31bf0e951e6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_set_metadata_schema</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_schema</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">metadata_schema_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_set_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the metadata schema. </p>
<p><p>Copies the metadata schema string to this table, replacing any existing.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>metadata_schema</strong> – A pointer to a char array. </p></li>
<li><p><strong>metadata_schema_length</strong> – The size of the metadata schema in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_print_state">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaee39efba7ce5980dffd699e02381017d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_set_columns">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga56bcabe201641526d1beba40034e465e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_append_columns">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1f8a70077a1965419fd5f440dfcfff02"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">metadata_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>metadata</strong> – The array of char metadata values to be copied. </p></li>
<li><p><strong>metadata_offset</strong> – The array of tsk_size_t metadata offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_set_max_rows_increment">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaf1415cad7439d82170e65aebe4189458"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_population_table_set_max_metadata_length_increment">
<span class="target" id="group___p_o_p_u_l_a_t_i_o_n___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaf56c07c69078e46501ec3cfeb93f6872"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_population_table_set_max_metadata_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_population_table_t" title="tsk_population_table_t"><span class="n"><span class="pre">tsk_population_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_metadata_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_population_table_set_max_metadata_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the metadata column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__table__t"><span class="std std-ref">tsk_population_table_t</span></a> object. </p></li>
<li><p><strong>max_metadata_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="provenances">
<h3>Provenances<a class="headerlink" href="#provenances" title="Link to this heading">#</a></h3>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_provenance_t">
<span class="target" id="structtsk__provenance__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_t</span></span></span><a class="headerlink" href="#c.tsk_provenance_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single provenance defined by a row in the provenance table. </p>
<p>See the <a class="reference internal" href="glossary.html#sec-data-model-definitions"><span class="std std-ref">data model</span></a> section for the definition of
a provenance object and its properties. See the <a class="reference internal" href="provenance.html#sec-provenance"><span class="std std-ref">Provenance</span></a> section
for more information on how provenance records should be structured.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_t.id">
<span class="target" id="structtsk__provenance__t_1a098a09783c1c67c9fe7474239a0187bb"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">id</span></span></span><a class="headerlink" href="#c.tsk_provenance_t.id" title="Link to this definition">#</a><br /></dt>
<dd><p>Non-negative ID value corresponding to table row. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_t.timestamp">
<span class="target" id="structtsk__provenance__t_1a93415088ede748a8e674a0034c98226c"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">timestamp</span></span></span><a class="headerlink" href="#c.tsk_provenance_t.timestamp" title="Link to this definition">#</a><br /></dt>
<dd><p>The timestamp. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_t.timestamp_length">
<span class="target" id="structtsk__provenance__t_1abf05381ceeac287190b7f619459b3d92"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">timestamp_length</span></span></span><a class="headerlink" href="#c.tsk_provenance_t.timestamp_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The timestamp length in bytes. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_t.record">
<span class="target" id="structtsk__provenance__t_1a2e878c32422bd2fe3717769dc0600694"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">record</span></span></span><a class="headerlink" href="#c.tsk_provenance_t.record" title="Link to this definition">#</a><br /></dt>
<dd><p>The record. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_t.record_length">
<span class="target" id="structtsk__provenance__t_1ad19ce499587af4198c28e6d9a08799d2"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">record_length</span></span></span><a class="headerlink" href="#c.tsk_provenance_t.record_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The record length in bytes. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t">
<span class="target" id="structtsk__provenance__table__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The provenance table. </p>
<p>See the provenance <a class="reference internal" href="data-model.html#sec-provenance-table-definition"><span class="std std-ref">table definition</span></a> for
details of the columns in this table.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.num_rows">
<span class="target" id="structtsk__provenance__table__t_1a9a204d42ae303fd917987ad0c580ab59"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_rows</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.num_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of rows in this table. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.timestamp_length">
<span class="target" id="structtsk__provenance__table__t_1abf05381ceeac287190b7f619459b3d92"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">timestamp_length</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.timestamp_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the timestamp column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.record_length">
<span class="target" id="structtsk__provenance__table__t_1ad19ce499587af4198c28e6d9a08799d2"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">record_length</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.record_length" title="Link to this definition">#</a><br /></dt>
<dd><p>The total length of the record column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.timestamp">
<span class="target" id="structtsk__provenance__table__t_1a2f26eae919bf9f5656b4250df8743e28"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">timestamp</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.timestamp" title="Link to this definition">#</a><br /></dt>
<dd><p>The timestamp column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.timestamp_offset">
<span class="target" id="structtsk__provenance__table__t_1a331b222440b0e0089521b09df7136f19"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">timestamp_offset</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.timestamp_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The timestamp_offset column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.record">
<span class="target" id="structtsk__provenance__table__t_1a4dc403c4cf8abce2f2c972f8304c1edd"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">record</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.record" title="Link to this definition">#</a><br /></dt>
<dd><p>The record column. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_provenance_table_t.record_offset">
<span class="target" id="structtsk__provenance__table__t_1ade28a0eba93e209bcea2eea4b9cd145f"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">record_offset</span></span></span><a class="headerlink" href="#c.tsk_provenance_table_t.record_offset" title="Link to this definition">#</a><br /></dt>
<dd><p>The record_offset column. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_init">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gacb30f6a667f5703e4fb3a4bc15435710"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the table by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the table.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_free">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaae2752601bef22155a116ba4b1783622"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_add_row">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga1bcc15e57632a6cfa778b7e5f3c91f72"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_add_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">timestamp_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">record_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_add_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Adds a row to this provenance table. </p>
<p>Add a new provenance with the specified <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">record</span></code> to the table.
Copies of the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">record</span></code> are immediately taken.
See the <a class="reference internal" href="data-model.html#sec-provenance-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>timestamp</strong> – The timestamp to be associated with the new provenance. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">timestamp_length</span></code> is 0. </p></li>
<li><p><strong>timestamp_length</strong> – The size of the timestamp array in bytes. </p></li>
<li><p><strong>record</strong> – The record to be associated with the new provenance. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">record_length</span></code> is 0. </p></li>
<li><p><strong>record_length</strong> – The size of the record array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return the ID of the newly added provenance on success, or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_update_row">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa45ce004508b06f8ed690c2aabec4519"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_update_row</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">timestamp_length</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">record_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_update_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Updates the row at the specified index. </p>
<p>Rewrite the row at the specified index in this table to use the specified
values. Copies of the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> and <code class="docutils literal notranslate"><span class="pre">record</span></code> parameters are taken
immediately. See the <a class="reference internal" href="data-model.html#sec-provenance-table-definition"><span class="std std-ref">table definition</span></a>
for details of the columns in this table.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the way that ragged columns are encoded, this method requires a
full rewrite of the internal column memory in worst case, and would
therefore be inefficient for bulk updates for such columns. However, if the
sizes of all ragged column values are unchanged in the updated row, this
method is guaranteed to only update the memory for the row in question.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The row to update. </p></li>
<li><p><strong>timestamp</strong> – The timestamp to be associated with new provenance. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">timestamp_length</span></code> is 0. </p></li>
<li><p><strong>timestamp_length</strong> – The size of the timestamp array in bytes. </p></li>
<li><p><strong>record</strong> – The record to be associated with the provenance. This is a pointer to arbitrary memory. Can be <code class="docutils literal notranslate"><span class="pre">NULL</span></code> if <code class="docutils literal notranslate"><span class="pre">record_length</span></code> is 0. </p></li>
<li><p><strong>record_length</strong> – The size of the record array in bytes. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_clear">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga8be37ce453361594d48ebfdd28d3a1d8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Clears this table, setting the number of rows to zero. </p>
<p>No memory is freed as a result of this operation; please use
<a class="reference internal" href="#c.tsk_provenance_table_free" title="tsk_provenance_table_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_provenance_table_free()</span></code></a> to free the table’s internal resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_truncate">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab6b094540d626f9ff4f3697c6ea57c19"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_truncate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_truncate" title="Link to this definition">#</a><br /></dt>
<dd><p>Truncates this table so that only the first num_rows are retained. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to retain in the table. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_extend">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gadcc5857a93903c3175fd47c5c8137d51"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_extend</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row_indexes</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_extend" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by appending rows copied from another table. </p>
<p>Appends the rows at the specified indexes from the table <code class="docutils literal notranslate"><span class="pre">other</span></code> to the end of this
table. Row indexes can be repeated and in any order. If <code class="docutils literal notranslate"><span class="pre">row_indexes</span></code> is NULL, append
the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> from <code class="docutils literal notranslate"><span class="pre">other</span></code> to this table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object where rows are to be added. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object where rows are copied from. </p></li>
<li><p><strong>num_rows</strong> – The number of rows from <code class="docutils literal notranslate"><span class="pre">other</span></code> to append to this table. </p></li>
<li><p><strong>row_indexes</strong> – Array of row indexes in <code class="docutils literal notranslate"><span class="pre">other</span></code>. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> is passed then the first <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> of <code class="docutils literal notranslate"><span class="pre">other</span></code> are used. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_keep_rows">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga2b4115d644dff2d9d48585ba04038495"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_keep_rows</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bool_t" title="tsk_bool_t"><span class="n"><span class="pre">tsk_bool_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">keep</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">id_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_keep_rows" title="Link to this definition">#</a><br /></dt>
<dd><p>Subset this table by keeping rows according to a boolean mask. </p>
<p><p>Deletes rows from this table and optionally return the mapping from IDs in
the current table to the updated table. Rows are kept or deleted according to
the specified boolean array <code class="docutils literal notranslate"><span class="pre">keep</span></code> such that for each row <code class="docutils literal notranslate"><span class="pre">j</span></code> if
<code class="docutils literal notranslate"><span class="pre">keep[j]</span></code> is false (zero) the row is deleted, and otherwise the row is
retained. Thus, <code class="docutils literal notranslate"><span class="pre">keep</span></code> must be an array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code>
<code class="xref c c-type docutils literal notranslate"><span class="pre">bool</span></code> values.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">id_map</span></code> argument is non-null, this array will be updated to represent
the mapping between IDs before and after row deletion. For row <code class="docutils literal notranslate"><span class="pre">j</span></code>,
<code class="docutils literal notranslate"><span class="pre">id_map[j]</span></code> will contain the new ID for row <code class="docutils literal notranslate"><span class="pre">j</span></code> if it is retained, or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> if the row has been removed. Thus, <code class="docutils literal notranslate"><span class="pre">id_map</span></code> must be an
array of at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><code class="xref c c-type docutils literal notranslate"><span class="pre">tsk_id_t</span></code></a> values.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>C++ users need to be careful to specify the correct type when
passing in values for the <code class="docutils literal notranslate"><span class="pre">keep</span></code> array,
using <code class="docutils literal notranslate"><span class="pre">std::vector&lt;tsk_bool_t&gt;</span></code> and not <code class="docutils literal notranslate"><span class="pre">std::vector&lt;bool&gt;</span></code>,
as the latter may not be correct size.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>keep</strong> – Array of boolean flags describing whether a particular row should be kept or not. Must be at least <code class="docutils literal notranslate"><span class="pre">num_rows</span></code> long. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
<li><p><strong>id_map</strong> – An array in which to store the mapping between new and old IDs. If NULL, this will be ignored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_equals">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaadb808274f22704319f1b29c23358854"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_equals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_equals" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if the data in the specified table is identical to the data in this table. </p>
<p><p><strong>Options</strong></p>
<p>Options to control the comparison can be specified by providing one or
more of the following bitwise flags. By default (options=0) tables are
considered equal if they are byte-wise identical in all columns.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_CMP_IGNORE_TIMESTAMPS" title="TSK_CMP_IGNORE_TIMESTAMPS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_TIMESTAMPS</span></code></a></p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Bitwise comparison options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return true if the specified table is equal to this table. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_copy">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga9d358ddade2400e684d30a3bc4f1334c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this table into the specified destination. </p>
<p>By default the method initialises the specified destination table. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised provenance table. If not, it must be an uninitialised provenance table. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_get_row">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gab72d0f8e4db6f3c37c513125af8247eb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_get_row</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_provenance_t" title="tsk_provenance_t"><span class="n"><span class="pre">tsk_provenance_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">row</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_get_row" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the row at the specified index. </p>
<p>Updates the specified provenance struct to reflect the values in the specified row.
Pointers to memory within this struct are handled by the table and should <strong>not</strong>
be freed by client code. These pointers are guaranteed to be valid until the
next operation that modifies the table (e.g., by adding a new row), but not afterwards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The requested table row. </p></li>
<li><p><strong>row</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__t"><span class="std std-ref">tsk_provenance_t</span></a> struct that is updated to reflect the values in the specified row. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_print_state">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga82802daf957621a62ec9f5c65896fc60"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this table to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_set_columns">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1gaa32df76e706f2ac7f7e9eb9efce519ee"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_set_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_set_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Replace this table’s data by copying from a set of column arrays. </p>
<p>Clears the data columns of this table and then copies column data from the specified
set of arrays. The supplied arrays should all contain data on the same number of rows.
The metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>timestamp</strong> – The array of char timestamp values to be copied. </p></li>
<li><p><strong>timestamp_offset</strong> – The array of tsk_size_t timestamp offset values to be copied. </p></li>
<li><p><strong>record</strong> – The array of char record values to be copied. </p></li>
<li><p><strong>record_offset</strong> – The array of tsk_size_t record offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_append_columns">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga76f7b5532bd38cf4f14312a74669a01f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_append_columns</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">timestamp_offset</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">record_offset</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_append_columns" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends this table by copying from a set of column arrays. </p>
<p>Copies column data from the specified set of arrays to create new rows at the end of the
table. The supplied arrays should all contain data on the same number of rows. The
metadata schema is not affected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>num_rows</strong> – The number of rows to copy from the specifed arrays. </p></li>
<li><p><strong>timestamp</strong> – The array of char timestamp values to be copied. </p></li>
<li><p><strong>timestamp_offset</strong> – The array of tsk_size_t timestamp offset values to be copied. </p></li>
<li><p><strong>record</strong> – The array of char record values to be copied. </p></li>
<li><p><strong>record_offset</strong> – The array of tsk_size_t record offset values to be copied. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_set_max_rows_increment">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga423472b0e02e4217c1de4f8b43f488b1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_set_max_rows_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_rows_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_set_max_rows_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for this table. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>max_rows_increment</strong> – The number of rows to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_set_max_timestamp_length_increment">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga97cda37d8221b4aad0ef7e2362693344"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_set_max_timestamp_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_timestamp_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_set_max_timestamp_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the timestamp column. </p>
<p>Set a fixed pre-allocation size, or use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>max_timestamp_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_provenance_table_set_max_record_length_increment">
<span class="target" id="group___p_r_o_v_e_n_a_n_c_e___t_a_b_l_e___a_p_i___g_r_o_u_p_1ga47ccbc86a9e21c8e46e3fc3b55db40f9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_provenance_table_set_max_record_length_increment</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_provenance_table_t" title="tsk_provenance_table_t"><span class="n"><span class="pre">tsk_provenance_table_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">max_record_length_increment</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_provenance_table_set_max_record_length_increment" title="Link to this definition">#</a><br /></dt>
<dd><p>Controls the pre-allocation strategy for the record column. </p>
<p>Set a fixed pre-allocation size, use the default doubling strategy.
See <a class="reference internal" href="#sec-c-api-memory-allocation-strategy"><span class="std std-ref">Memory allocation strategy</span></a> for details on the default
pre-allocation strategy,</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__table__t"><span class="std std-ref">tsk_provenance_table_t</span></a> object. </p></li>
<li><p><strong>max_record_length_increment</strong> – The number of bytes to pre-allocate, or zero for the default doubling strategy. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="table-indexes">
<span id="sec-c-api-table-indexes"></span><h3>Table indexes<a class="headerlink" href="#table-indexes" title="Link to this heading">#</a></h3>
<p>Along with the tree sequence <a class="reference internal" href="data-model.html#sec-valid-tree-sequence-requirements"><span class="std std-ref">ordering requirements</span></a>, the <a class="reference internal" href="data-model.html#sec-table-indexes"><span class="std std-ref">Table indexes</span></a>
allow us to take a table collection and efficiently operate
on the trees defined within it. This section defines the rules
for safely operating on table indexes and their life-cycle.</p>
<p>The edge index used for tree generation consists of two arrays,
each holding <code class="docutils literal notranslate"><span class="pre">N</span></code> edge IDs (where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the size of the edge
table). When the index is computed using
<a class="reference internal" href="#c.tsk_table_collection_build_index" title="tsk_table_collection_build_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_build_index()</span></code></a>, we store the current size
of the edge table along with the two arrays of edge IDs. The
function <a class="reference internal" href="#c.tsk_table_collection_has_index" title="tsk_table_collection_has_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_has_index()</span></code></a> then returns true
iff (a) both of these arrays are not NULL and (b) the stored
number of edges is the same as the current size of the edge table.</p>
<p>Updating the edge table does not automatically invalidate the indexes.
Thus, if we call <a class="reference internal" href="#c.tsk_edge_table_clear" title="tsk_edge_table_clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_edge_table_clear()</span></code></a> on an edge table
which has an index, this index will still exist. However, it will
not be considered a valid index by
<a class="reference internal" href="#c.tsk_table_collection_has_index" title="tsk_table_collection_has_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_has_index()</span></code></a> because of the size mismatch.
Similarly for functions that increase the size of the table.
Note that it is possible then to have
<a class="reference internal" href="#c.tsk_table_collection_has_index" title="tsk_table_collection_has_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_has_index()</span></code></a> return true, but the index
is not actually valid, if, for example, the user has manipulated the
node and edge tables to describe a different topology, which happens
to have the same number of edges. The behaviour of methods that
use the indexes will be undefined in this case.</p>
<p>Thus, if you are manipulating an existing table collection that may
be indexed, it is always recommended to call
<a class="reference internal" href="#c.tsk_table_collection_drop_index" title="tsk_table_collection_drop_index"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_drop_index()</span></code></a> first.</p>
</section>
</section>
<section id="tree-sequences">
<span id="sec-c-api-tree-sequences"></span><h2>Tree sequences<a class="headerlink" href="#tree-sequences" title="Link to this heading">#</a></h2>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_treeseq_t">
<span class="target" id="structtsk__treeseq__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_t</span></span></span><a class="headerlink" href="#c.tsk_treeseq_t" title="Link to this definition">#</a><br /></dt>
<dd><p>The tree sequence object. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_treeseq_t.tables">
<span class="target" id="structtsk__treeseq__t_1a7f5f04d836d6cafb7c24ff7df5fb54d9"></span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tables</span></span></span><a class="headerlink" href="#c.tsk_treeseq_t.tables" title="Link to this definition">#</a><br /></dt>
<dd><p>The table collection underlying this tree sequence, This table collection must be treated as read-only, and any changes to it will lead to undefined behaviour. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_init">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga35344b1bc96605a2046b64ac80b9205d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tables</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the tree sequence based on the specified table collection. </p>
<p><p>This method will copy the supplied table collection unless <a class="reference internal" href="#c.TSK_TAKE_OWNERSHIP" title="TSK_TAKE_OWNERSHIP"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_TAKE_OWNERSHIP</span></code></a>
is specified. The table collection will be checked for integrity and index maps built.</p>
<p>This must be called before any operations are performed on the tree sequence.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<p>If specified, TSK_TAKE_OWNERSHIP takes immediate ownership of the tables, regardless
of error conditions.</p>
<p><strong>Options</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_TS_INIT_BUILD_INDEXES" title="TSK_TS_INIT_BUILD_INDEXES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_TS_INIT_BUILD_INDEXES</span></code></a></p></li>
<li><p><a class="reference internal" href="#c.TSK_TAKE_OWNERSHIP" title="TSK_TAKE_OWNERSHIP"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_TAKE_OWNERSHIP</span></code></a> (applies to the table collection).</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>tables</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. See above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_load">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga0f21fed1ef9b98429f4e6e6286cb8187"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_load</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">filename</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_load" title="Link to this definition">#</a><br /></dt>
<dd><p>Load a tree sequence from a file path. </p>
<p><p>Loads the data from the specified file into this tree sequence.
The tree sequence is also initialised.
The resources allocated must be freed using
<a class="reference internal" href="#c.tsk_treeseq_free" title="tsk_treeseq_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_free()</span></code></a> even in error conditions.</p>
<p>Works similarly to <a class="reference internal" href="#c.tsk_table_collection_load" title="tsk_table_collection_load"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_load()</span></code></a> please see
that function’s documentation for details and options.</p>
<p><strong>Examples</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="n">tsk_treeseq_t</span><span class="w"> </span><span class="n">ts</span><span class="p">;</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;data.trees&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Load error:%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tsk_strerror</span><span class="p">(</span><span class="n">ret</span><span class="p">));</span>
<span class="w">    </span><span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object </p></li>
<li><p><strong>filename</strong> – A NULL terminated string containing the filename. </p></li>
<li><p><strong>options</strong> – Bitwise options. See above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_loadf">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gad393f5920b5fc7b5c1e2b3a2aa3212cf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_loadf</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_loadf" title="Link to this definition">#</a><br /></dt>
<dd><p>Load a tree sequence from a stream. </p>
<p><p>Loads a tree sequence from the specified file stream. The tree sequence
is also initialised. The resources allocated must be freed using
<a class="reference internal" href="#c.tsk_treeseq_free" title="tsk_treeseq_free"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_free()</span></code></a> even in error conditions.</p>
<p>Works similarly to <a class="reference internal" href="#c.tsk_table_collection_loadf" title="tsk_table_collection_loadf"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_loadf()</span></code></a> please
see that function’s documentation for details and options.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>file</strong> – A FILE stream opened in an appropriate mode for reading (e.g. “r”, “r+” or “w+”) positioned at the beginning of a tree sequence definition. </p></li>
<li><p><strong>options</strong> – Bitwise options. See above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_dump">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gad31cdd291a831a9d6fde9bd88cdbe144"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_dump</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">filename</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_dump" title="Link to this definition">#</a><br /></dt>
<dd><p>Write a tree sequence to file. </p>
<p><p>Writes the data from this tree sequence to the specified file.</p>
<p>If an error occurs the file path is deleted, ensuring that only complete
and well formed files will be written.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>filename</strong> – A NULL terminated string containing the filename. </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_dumpf">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gae59d951da1712f8ad37e2ace830d260b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_dumpf</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">file</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_dumpf" title="Link to this definition">#</a><br /></dt>
<dd><p>Write a tree sequence to a stream. </p>
<p><p>Writes the data from this tree sequence to the specified FILE stream.
Semantics are identical to <a class="reference internal" href="#c.tsk_treeseq_dump" title="tsk_treeseq_dump"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_dump()</span></code></a>.</p>
<p>Please see the <a class="reference internal" href="#sec-c-api-examples-file-streaming"><span class="std std-ref">File streaming</span></a> section for an example
of how to sequentially dump and load tree sequences from a stream.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>file</strong> – A FILE stream opened in an appropriate mode for writing (e.g. “w”, “a”, “r+” or “w+”). </p></li>
<li><p><strong>options</strong> – Bitwise options. Currently unused; should be set to zero to ensure compatibility with later versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_copy_tables">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gab51142c1466339407b5c759337af1261"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_copy_tables</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tables</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_copy_tables" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of the table collection underlying this tree sequence into the specified destination table collection. </p>
<p>By default the method initialises the specified destination table collection. If the
destination is already initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should
be supplied to avoid leaking memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>tables</strong> – A pointer to a <a class="reference internal" href="#structtsk__table__collection__t"><span class="std std-ref">tsk_table_collection_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised table collection. If not, it must be an uninitialised table collection. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_free">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga394bc462e51fccc90a6fd599065e16c4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified tree sequence. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_print_state">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gab94d9da672de8d05e167d71c86abeec1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this tree sequence to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_nodes">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gacc2ab69c3972c3c6ea810919568a2067"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_nodes</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_nodes" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of nodes. </p>
<p>Returns the number of nodes in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of nodes. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_edges">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga261764355b8cd3bbce142b706356fa25"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_edges</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_edges" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of edges. </p>
<p>Returns the number of edges in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of edges. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_migrations">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga230ec70a93b5b19fb05be008618d7ab6"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_migrations</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_migrations" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of migrations. </p>
<p>Returns the number of migrations in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of migrations. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_sites">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga4a7f8a83b2a8c479e0239266d1f439fa"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_sites</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_sites" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of sites. </p>
<p>Returns the number of sites in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of sites. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_mutations">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gabe62cabd608ab33cfd8fadfeeca42c14"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_mutations</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_mutations" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of mutations. </p>
<p>Returns the number of mutations in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of mutations. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_provenances">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga8fcdf97fc0e81080939f24e8e9a21f9f"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_provenances</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_provenances" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of provenances. </p>
<p>Returns the number of provenances in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of provenances. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_populations">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga6963112fe856ec4bc85d49d30756c757"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_populations</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_populations" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of populations. </p>
<p>Returns the number of populations in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of populations. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_individuals">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga8f22de131c36a3ab6c22d2a805c2fd1d"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_individuals</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_individuals" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of individuals. </p>
<p>Returns the number of individuals in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of individuals. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_trees">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga561ad98238bd83463a6cd518070ceb4b"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_trees</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_trees" title="Link to this definition">#</a><br /></dt>
<dd><p>Return the number of trees in this tree sequence. </p>
<p>This is a constant time operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of trees in the tree sequence. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_num_samples">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga34bbd686d6a65c7cd92a5e3b2cfb7805"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_num_samples</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_num_samples" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the number of samples. </p>
<p>Returns the number of nodes marked as samples in this tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number of samples. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_metadata">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga9b833596a42feeb6abd7d656cad8c118"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_metadata</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_metadata" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the top-level tree sequence metadata. </p>
<p>Returns a pointer to the metadata string, which is owned by the tree sequence and
not null-terminated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a pointer to the metadata. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_metadata_length">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga9c5e131f7b9736ed9f33b74edfe96f08"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_metadata_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_metadata_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the length of top-level tree sequence metadata. </p>
<p>Returns the length of the metadata string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the length of the metadata. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_metadata_schema">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gafb74d9aae19e133501ac9be7e688a843"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_metadata_schema</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_metadata_schema" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the top-level tree sequence metadata schema. </p>
<p>Returns a pointer to the metadata schema string, which is owned by the tree sequence and
not null-terminated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a pointer to the metadata schema. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_metadata_schema_length">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gab04d70485d6007a566377e55a2e563b3"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_metadata_schema_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_metadata_schema_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the length of the top-level tree sequence metadata schema. </p>
<p>Returns the length of the metadata schema string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the length of the metadata schema. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_time_units">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga55f709c7d3168bf010c7d69b1d2be4da"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_time_units</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_time_units" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the time units string. </p>
<p>Returns a pointer to the time units string, which is owned by the tree sequence and
not null-terminated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a pointer to the time units. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_time_units_length">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gae8c528bc545fc96b93bba87b34baf577"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_time_units_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_time_units_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the length of time units string. </p>
<p>Returns the length of the time units string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the length of the time units. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_file_uuid">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga75c5afb8607b2f9c815c410b082a81fe"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_file_uuid</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_file_uuid" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the file uuid. </p>
<p>Returns a pointer to the null-terminated file uuid string, which is owned by the tree
sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns a pointer to the time units. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_sequence_length">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gaaff54cc49b0c6bff96f7afcdb40e8630"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_sequence_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_sequence_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the sequence length. </p>
<p>Returns the sequence length of this tree sequence</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the sequence length. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_breakpoints">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga21b35a1d2abd33ae9291a16364ca66db"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_breakpoints</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_breakpoints" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the breakpoints. </p>
<p>Returns an array of breakpoint locations, the array is owned by the tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pointer to the breakpoint array. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_samples">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gaaaaf825e7e1583461a08f91b7641901e"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_samples</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_samples" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the samples. </p>
<p>Returns an array of ids of sample nodes in this tree sequence.
I.e. nodes that have the <a class="reference internal" href="#c.TSK_NODE_IS_SAMPLE" title="TSK_NODE_IS_SAMPLE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NODE_IS_SAMPLE</span></code></a> flag set.
The array is owned by the tree sequence and should not be modified or free’d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pointer to the sample node id array. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_sample_index_map">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga8a92580f2a3c86e6d1672e825aaf0058"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_sample_index_map</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_sample_index_map" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the map of node id to sample index. </p>
<p>Returns the location of each node in the list of samples or
<a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> for nodes that are not samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the pointer to the array of sample indexes. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_is_sample">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gad8d132a6ed0453c3da4c9bc83e65eca4"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_is_sample</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_is_sample" title="Link to this definition">#</a><br /></dt>
<dd><p>Check if a node is a sample. </p>
<p><p>Returns the sample status of a given node id.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The id of the node to be checked. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns true if the node is a sample. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_discrete_genome">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gaa5ff4bbf9955f50c0edf36ff0896b1b7"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_discrete_genome</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_discrete_genome" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the discrete genome status. </p>
<p><p>If all the genomic locations in the tree sequence are discrete integer values
then this flag will be true.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns true if all genomic locations are discrete. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_discrete_time">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga05190bf0f52f1a970db1ad003317e6ff"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_discrete_time</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_discrete_time" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the discrete time status. </p>
<p><p>If all times in the tree sequence are discrete integer values
then this flag will be true</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns true if all times are discrete. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_min_time">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gaf4d1439c0beedde583457cc1919702df"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_min_time</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_min_time" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the min time in node table and mutation table. </p>
<p>The times stored in both the node and mutation tables are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the min time of all nodes and mutations. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_max_time">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gaecdfa712a36530495aabe53fa0dba6d1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_max_time</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_max_time" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the max time in node table and mutation table. </p>
<p>The times stored in both the node and mutation tables are considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the max time of all nodes and mutations. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_node">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga6ef089fb74e2f0601e6a4d5d499e569b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_node</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_node_t" title="tsk_node_t"><span class="n"><span class="pre">tsk_node_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_node" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a node by its index. </p>
<p><p>Copies a node from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The node index to copy </p></li>
<li><p><strong>node</strong> – A pointer to a <a class="reference internal" href="#structtsk__node__t"><span class="std std-ref">tsk_node_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_edge">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga4e66cf7d1d5a2878275a746df1317581"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_edge</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_edge_t" title="tsk_edge_t"><span class="n"><span class="pre">tsk_edge_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">edge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_edge" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a edge by its index. </p>
<p><p>Copies a edge from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The edge index to copy </p></li>
<li><p><strong>edge</strong> – A pointer to a <a class="reference internal" href="#structtsk__edge__t"><span class="std std-ref">tsk_edge_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_migration">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gae613a4a633935b50924da0d7b6295a5e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_migration</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_migration_t" title="tsk_migration_t"><span class="n"><span class="pre">tsk_migration_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">migration</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_migration" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a edge by its index. </p>
<p><p>Copies a migration from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The migration index to copy </p></li>
<li><p><strong>migration</strong> – A pointer to a <a class="reference internal" href="#structtsk__migration__t"><span class="std std-ref">tsk_migration_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_site">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gabb8a27b5396734625f63d3f56b9abf71"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_site</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><span class="n"><span class="pre">tsk_site_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">site</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_site" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a site by its index. </p>
<p><p>Copies a site from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The site index to copy </p></li>
<li><p><strong>site</strong> – A pointer to a <a class="reference internal" href="#structtsk__site__t"><span class="std std-ref">tsk_site_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_mutation">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga8a14ba5bd730b75a335e859efc1ecd28"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_mutation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_mutation_t" title="tsk_mutation_t"><span class="n"><span class="pre">tsk_mutation_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mutation</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_mutation" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a mutation by its index. </p>
<p><p>Copies a mutation from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The mutation index to copy </p></li>
<li><p><strong>mutation</strong> – A pointer to a <a class="reference internal" href="#structtsk__mutation__t"><span class="std std-ref">tsk_mutation_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_provenance">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga30940388f4d617497577179ff1ae5925"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_provenance</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_provenance_t" title="tsk_provenance_t"><span class="n"><span class="pre">tsk_provenance_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">provenance</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_provenance" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a provenance by its index. </p>
<p><p>Copies a provenance from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The provenance index to copy </p></li>
<li><p><strong>provenance</strong> – A pointer to a <a class="reference internal" href="#structtsk__provenance__t"><span class="std std-ref">tsk_provenance_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_population">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1gacf2386108099cdd5dfa0650437b28131"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_population</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_population_t" title="tsk_population_t"><span class="n"><span class="pre">tsk_population_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">population</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_population" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a population by its index. </p>
<p><p>Copies a population from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The population index to copy </p></li>
<li><p><strong>population</strong> – A pointer to a <a class="reference internal" href="#structtsk__population__t"><span class="std std-ref">tsk_population_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_get_individual">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga282ffedd97ba05cab0edf25950cd60f1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_get_individual</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">index</span></span>, <a class="reference internal" href="#c.tsk_individual_t" title="tsk_individual_t"><span class="n"><span class="pre">tsk_individual_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">individual</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_get_individual" title="Link to this definition">#</a><br /></dt>
<dd><p>Get a individual by its index. </p>
<p><p>Copies a individual from this tree sequence to the specified destination.</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>index</strong> – The individual index to copy </p></li>
<li><p><strong>individual</strong> – A pointer to a <a class="reference internal" href="#structtsk__individual__t"><span class="std std-ref">tsk_individual_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_simplify">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga7891e9d75e9de842d6a390e05b6d1963"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_simplify</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">samples</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_samples</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">output</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">node_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_simplify" title="Link to this definition">#</a><br /></dt>
<dd><p>Create a simplified instance of this tree sequence. </p>
<p><p><p>Copies this tree sequence to the specified destination and performs simplification.
The destination tree sequence should be uninitialised.
Simplification transforms the tables to remove redundancy and canonicalise
tree sequence data. See the <a class="reference external" href="https://tskit.dev/tutorials/simplification.html#sec-simplification" title="(in Project name not set)"><span class="xref std std-ref">simplification</span></a> tutorial for
more details.</p>
<p>For full details and flags see <a class="reference internal" href="#c.tsk_table_collection_simplify" title="tsk_table_collection_simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_simplify()</span></code></a> which performs
the same operation in place.</p>
</p>
 </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a uninitialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>samples</strong> – Either NULL or an array of num_samples distinct and valid node IDs. If non-null the nodes in this array will be marked as samples in the output. If NULL, the num_samples parameter is ignored and the samples in the output will be the same as the samples in the input. This is equivalent to populating the samples array with all of the sample nodes in the input in increasing order of ID. </p></li>
<li><p><strong>num_samples</strong> – The number of node IDs in the input samples array. Ignored if the samples array is NULL. </p></li>
<li><p><strong>options</strong> – Simplify options; see above for the available bitwise flags. For the default behaviour, a value of 0 should be provided. </p></li>
<li><p><strong>output</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>node_map</strong> – If not NULL, this array will be filled to define the mapping between nodes IDs in the table collection before and after simplification. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_treeseq_extend_haplotypes">
<span class="target" id="group___t_r_e_e_s_e_q___a_p_i___g_r_o_u_p_1ga6f2802c3377fa2ff6f7b4813a4c32a10"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_treeseq_extend_haplotypes</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">max_iter</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span>, <a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">output</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_treeseq_extend_haplotypes" title="Link to this definition">#</a><br /></dt>
<dd><p>Extends haplotypes. </p>
<p>Returns a new tree sequence in which the span covered by ancestral nodes is “extended” to regions of the genome according to the following rule: If an ancestral segment corresponding to node <code class="docutils literal notranslate"><span class="pre">n</span></code> has ancestor <code class="docutils literal notranslate"><span class="pre">p</span></code> and descendant <code class="docutils literal notranslate"><span class="pre">c</span></code> on some portion of the genome, and on an adjacent segment of genome <code class="docutils literal notranslate"><span class="pre">p</span></code> is still an ancestor of <code class="docutils literal notranslate"><span class="pre">c</span></code>, then <code class="docutils literal notranslate"><span class="pre">n</span></code> is inserted into the path from <code class="docutils literal notranslate"><span class="pre">p</span></code> to <code class="docutils literal notranslate"><span class="pre">c</span></code>. For instance, if <code class="docutils literal notranslate"><span class="pre">p</span></code> is the parent of <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the parent of <code class="docutils literal notranslate"><span class="pre">c</span></code>, then the span of the edges from <code class="docutils literal notranslate"><span class="pre">p</span></code> to <code class="docutils literal notranslate"><span class="pre">n</span></code> and <code class="docutils literal notranslate"><span class="pre">n</span></code> to <code class="docutils literal notranslate"><span class="pre">c</span></code> are extended, and the span of the edge from <code class="docutils literal notranslate"><span class="pre">p</span></code> to <code class="docutils literal notranslate"><span class="pre">c</span></code> is reduced. However, any edges whose child node is a sample are not modified. See Fritze et al. (2025): <a class="reference external" href="https://doi.org/10.1093/genetics/iyaf198">https://doi.org/10.1093/genetics/iyaf198</a> for more details.</p>
<p>The method works by iterating over the genome to look for edges that can be extended in this way; the maximum number of such iterations is controlled by <code class="docutils literal notranslate"><span class="pre">max_iter</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">node</span></code> of certain mutations may also be remapped; to do this unambiguously we need to know mutation times. If mutations times are unknown, use <code class="docutils literal notranslate"><span class="pre">tsk_table_collection_compute_mutation_times</span></code> first.</p>
<p>The method will not affect any tables except the edge table, or the node column in the mutation table.</p>
<p><strong>Options</strong>: None currently defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>max_iter</strong> – The maximum number of iterations over the tree sequence. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. (UNUSED) </p></li>
<li><p><strong>output</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="trees">
<span id="sec-c-api-trees"></span><h2>Trees<a class="headerlink" href="#trees" title="Link to this heading">#</a></h2>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_tree_t">
<span class="target" id="structtsk__tree__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_t</span></span></span><a class="headerlink" href="#c.tsk_tree_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A single tree in a tree sequence. </p>
<p><p>A <code class="docutils literal notranslate"><span class="pre">tsk_tree_t</span></code> object has two basic functions:</p>
<ol class="arabic simple">
<li><p>Represent the state of a single tree in a tree sequence;</p></li>
<li><p>Provide methods to transform this state into different trees in the sequence.</p></li>
</ol>
<p>The state of a single tree in the tree sequence is represented using the
quintuply linked encoding: please see the
<a class="reference internal" href="data-model.html#sec-data-model-tree-structure"><span class="std std-ref">data model</span></a> section for details on
how this works. The left-to-right ordering of nodes in this encoding
is arbitrary, and may change depending on the order in which trees are
accessed within the sequence. Please see the
<a class="reference internal" href="#sec-c-api-examples-tree-traversals"><span class="std std-ref">Tree traversals</span></a> examples for recommended
usage.</p>
<p>On initialisation, a tree is in the <a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> and
we must call one of the <a class="reference internal" href="#sec-c-api-trees-seeking"><span class="std std-ref">seeking</span></a> methods to make
the state of the tree object correspond to a particular tree in the sequence.
Please see the <a class="reference internal" href="#sec-c-api-examples-tree-iteration"><span class="std std-ref">Tree iteration</span></a> examples for
recommended usage.</p>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.tree_sequence">
<span class="target" id="structtsk__tree__t_1a251d481df680bad0d57e696681cb400a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tree_sequence</span></span></span><a class="headerlink" href="#c.tsk_tree_t.tree_sequence" title="Link to this definition">#</a><br /></dt>
<dd><p>The parent tree sequence. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.virtual_root">
<span class="target" id="structtsk__tree__t_1acb0222bd754e20c2a5b97550e24a7b2f"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">virtual_root</span></span></span><a class="headerlink" href="#c.tsk_tree_t.virtual_root" title="Link to this definition">#</a><br /></dt>
<dd><p>The ID of the “virtual root” whose children are the roots of the tree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.parent">
<span class="target" id="structtsk__tree__t_1a46da4afff95627d99f17ba698625383b"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">parent</span></span></span><a class="headerlink" href="#c.tsk_tree_t.parent" title="Link to this definition">#</a><br /></dt>
<dd><p>The parent of node u is parent[u]. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node u is a root or is not a node in the current tree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.left_child">
<span class="target" id="structtsk__tree__t_1a4e73edd2f3c0098809ff29b2f8b25fab"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">left_child</span></span></span><a class="headerlink" href="#c.tsk_tree_t.left_child" title="Link to this definition">#</a><br /></dt>
<dd><p>The leftmost child of node u is left_child[u]. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node u is a leaf or is not a node in the current tree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.right_child">
<span class="target" id="structtsk__tree__t_1a4f67f15f9a4aeb95e2b0fb6becb24541"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">right_child</span></span></span><a class="headerlink" href="#c.tsk_tree_t.right_child" title="Link to this definition">#</a><br /></dt>
<dd><p>The rightmost child of node u is right_child[u]. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node u is a leaf or is not a node in the current tree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.left_sib">
<span class="target" id="structtsk__tree__t_1aea3a2306461842fa6684d0b39b4a611e"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">left_sib</span></span></span><a class="headerlink" href="#c.tsk_tree_t.left_sib" title="Link to this definition">#</a><br /></dt>
<dd><p>The sibling to the left of node u is left_sib[u]. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node u has no siblings to its left. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.right_sib">
<span class="target" id="structtsk__tree__t_1a583f0d4f0339db2fca190287c89fc4ec"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">right_sib</span></span></span><a class="headerlink" href="#c.tsk_tree_t.right_sib" title="Link to this definition">#</a><br /></dt>
<dd><p>The sibling to the right of node u is right_sib[u]. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node u has no siblings to its right. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.num_children">
<span class="target" id="structtsk__tree__t_1a449f58f128ffc77500b515206f2df605"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">num_children</span></span></span><a class="headerlink" href="#c.tsk_tree_t.num_children" title="Link to this definition">#</a><br /></dt>
<dd><p>The number of children of node u is num_children[u]. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.edge">
<span class="target" id="structtsk__tree__t_1aa2996827573f53b786f1b2a9f884d996"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">edge</span></span></span><a class="headerlink" href="#c.tsk_tree_t.edge" title="Link to this definition">#</a><br /></dt>
<dd><p>Array of edge ids where <code class="docutils literal notranslate"><span class="pre">edge[u]</span></code> is the edge that encodes the relationship between the child node <code class="docutils literal notranslate"><span class="pre">u</span></code> and its parent. Equal to <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> if node <code class="docutils literal notranslate"><span class="pre">u</span></code> is a root, virtual root or is not a node in the current tree. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.num_edges">
<span class="target" id="structtsk__tree__t_1ae085467c5ea84ff75730c58176bf69ec"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_edges</span></span></span><a class="headerlink" href="#c.tsk_tree_t.num_edges" title="Link to this definition">#</a><br /></dt>
<dd><p>The total number of edges defining the topology of this tree. This is equal to the number of tree sequence edges that intersect with the tree’s genomic interval. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.interval">
<span class="target" id="structtsk__tree__t_1a25ed7d68a17518a49e158567aa3e90b8"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interval</span></span></span><a class="headerlink" href="#c.tsk_tree_t.interval" title="Link to this definition">#</a><br /></dt>
<dd><p>Left and right coordinates of the genomic interval that this tree covers. The left coordinate is inclusive and the right coordinate exclusive. </p>
<p><p>Example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="c1">// initialise etc</span>
<span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_first</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>
<span class="c1">// Check for error</span>
<span class="n">assert</span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSK_TREE_OK</span><span class="p">);</span>
<span class="n">printf</span><span class="p">(</span><span class="s">&quot;Coordinates covered by first tree are left=%f, right=%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">tree</span><span class="p">.</span><span class="n">interval</span><span class="p">.</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">interval</span><span class="p">.</span><span class="n">right</span><span class="p">);</span>
</pre></div>
</div>
</p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_tree_t.index">
<span class="target" id="structtsk__tree__t_1aac4b3335d7c1b66dcb0a6fa41fa68cce"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index</span></span></span><a class="headerlink" href="#c.tsk_tree_t.index" title="Link to this definition">#</a><br /></dt>
<dd><p>The index of this tree in the tree sequence. </p>
<p>This attribute provides the zero-based index of the tree represented by the
current state of the struct within the parent tree sequence. For example,
immediately after we call <code class="docutils literal notranslate"><span class="pre">tsk_tree_first(&amp;tree)</span></code>, <code class="docutils literal notranslate"><span class="pre">tree.index</span></code> will
be zero, and after we call <code class="docutils literal notranslate"><span class="pre">tsk_tree_last(&amp;tree)</span></code>, <code class="docutils literal notranslate"><span class="pre">tree.index</span></code> will
be the number of trees - 1 (see <a class="reference internal" href="#c.tsk_treeseq_get_num_trees" title="tsk_treeseq_get_num_trees"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_get_num_trees()</span></code></a>)
When the tree is in the null state (immediately after initialisation,
or after, e.g., calling <a class="reference internal" href="#c.tsk_tree_prev" title="tsk_tree_prev"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_prev()</span></code></a> on the first tree)
the value of the <code class="docutils literal notranslate"><span class="pre">index</span></code> is -1.</p>
</dd></dl>

</div>
</dd></dl>

<section id="lifecycle">
<h3>Lifecycle<a class="headerlink" href="#lifecycle" title="Link to this heading">#</a></h3>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_init">
<span class="target" id="group___t_r_e_e___a_p_i___l_i_f_e_c_y_c_l_e___g_r_o_u_p_1ga389f1da76d28c98fd7043d796ba9f20c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tree_sequence</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the tree by allocating internal memory and associating with the specified tree sequence. </p>
<p><p>This must be called before any operations are performed on the tree.</p>
<p>The specified tree sequence object must be initialised, and must be
valid for the full lifetime of this tree.</p>
<p>See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> parameter is provided to support future expansions
of the API. A number of undocumented internal features are controlled
via this parameter, and it <strong>must</strong> be set to 0 to ensure that operations
work as expected and for compatibility with future versions of tskit.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>tree_sequence</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__treeseq__t"><span class="std std-ref">tsk_treeseq_t</span></a> object. </p></li>
<li><p><strong>options</strong> – Allocation time options. Must be 0, or behaviour is undefined. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_free">
<span class="target" id="group___t_r_e_e___a_p_i___l_i_f_e_c_y_c_l_e___g_r_o_u_p_1ga14193fa5e4fda6368b01401a668bb191"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified tree. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_copy">
<span class="target" id="group___t_r_e_e___a_p_i___l_i_f_e_c_y_c_l_e___g_r_o_u_p_1ga0e162de427d096636b662c4044630e26"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">dest</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this tree into the specified destination. </p>
<p><p>By default (<code class="docutils literal notranslate"><span class="pre">options</span></code> = 0) the method initialises the specified destination
tree by calling <a class="reference internal" href="#c.tsk_tree_init" title="tsk_tree_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_init()</span></code></a>. If the destination is already
initialised, the <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> option should be supplied to avoid
leaking memory. If <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> is supplied and the tree sequence associated
with the <code class="docutils literal notranslate"><span class="pre">dest</span></code> tree is not equal to the tree sequence associated
with <code class="docutils literal notranslate"><span class="pre">self</span></code>, an error is raised.</p>
<p>The destination tree will keep a reference to the tree sequence object
associated with the source tree, and this tree sequence must be
valid for the full lifetime of the destination tree.</p>
<p><strong>Options</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a></p></li>
</ul>
<p>If <a class="reference internal" href="#c.TSK_NO_INIT" title="TSK_NO_INIT"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NO_INIT</span></code></a> is not specified, options for <a class="reference internal" href="#c.tsk_tree_init" title="tsk_tree_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_init()</span></code></a>
can be provided and will be passed on.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>dest</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. If the TSK_NO_INIT option is specified, this must be an initialised tree. If not, it must be an uninitialised tree. </p></li>
<li><p><strong>options</strong> – Copy and allocation time options. See the notes above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="null-state">
<span id="sec-c-api-trees-null"></span><h3>Null state<a class="headerlink" href="#null-state" title="Link to this heading">#</a></h3>
<p>Trees are initially in a “null state” where each sample is a
root and there are no branches. The <code class="docutils literal notranslate"><span class="pre">index</span></code> of a tree in the
null state is <code class="docutils literal notranslate"><span class="pre">-1</span></code>.</p>
<p>We must call one of the
<a class="reference internal" href="#sec-c-api-trees-seeking"><span class="std std-ref">seeking</span></a> methods
to make the state of the tree object correspond to a particular tree
in the sequence.</p>
</section>
<section id="seeking">
<span id="sec-c-api-trees-seeking"></span><h3>Seeking<a class="headerlink" href="#seeking" title="Link to this heading">#</a></h3>
<p>When we are examining many trees along a tree sequence,
we usually allocate a single <a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">tsk_tree_t</span></code></a> object
and update its state. This allows us to efficiently transform
the state of a tree into nearby trees, using the underlying succinct tree
sequence data structure.</p>
<p>The simplest example to visit trees left-to-right along the genome:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kt">int</span>
<span class="linenos"> 2</span><span class="nf">visit_trees</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_treeseq_t</span><span class="w"> </span><span class="o">*</span><span class="n">ts</span><span class="p">)</span>
<span class="linenos"> 3</span><span class="p">{</span>
<span class="linenos"> 4</span><span class="w">    </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="linenos"> 8</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos"> 9</span><span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>
<span class="linenos">10</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">11</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_first</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSK_TREE_OK</span><span class="p">;</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">12</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">tree %lld covers interval left=%f right=%f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="linenos">13</span><span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">interval</span><span class="p">.</span><span class="n">left</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">interval</span><span class="p">.</span><span class="n">right</span><span class="p">);</span>
<span class="linenos">14</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">15</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="linenos">16</span><span class="w">        </span><span class="k">goto</span><span class="w"> </span><span class="n">out</span><span class="p">;</span>
<span class="linenos">17</span><span class="w">    </span><span class="p">}</span>
<span class="linenos">18</span><span class="w">    </span><span class="c1">// Do other things in the function...</span>
<span class="linenos">19</span><span class="nl">out</span><span class="p">:</span>
<span class="linenos">20</span><span class="w">    </span><span class="n">tsk_tree_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>
<span class="linenos">21</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="linenos">22</span><span class="p">}</span>
</pre></div>
</div>
<p>In this example we first initialise a <a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">tsk_tree_t</span></code></a> object,
associating it with the input tree sequence. We then iterate over the
trees along the sequence using a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop, with the <code class="docutils literal notranslate"><span class="pre">ret</span></code> variable
controlling iteration. The usage of <code class="docutils literal notranslate"><span class="pre">ret</span></code> here follows a slightly
different pattern to other functions in the tskit C API
(see the <a class="reference internal" href="#sec-c-api-error-handling"><span class="std std-ref">Error handling</span></a> section).
The interaction between error handling and states
of the <code class="docutils literal notranslate"><span class="pre">tree</span></code> object here is somewhat subtle, and is worth explaining
in detail.</p>
<p>After successful initialisation (after line 10), the tree is in the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> where all samples are roots.
The <code class="docutils literal notranslate"><span class="pre">for</span></code> loop begins by calling <a class="reference internal" href="#c.tsk_tree_first" title="tsk_tree_first"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_first()</span></code></a> which
transforms the state of the tree into the first (leftmost) tree in
the sequence. If this operation is successful, <a class="reference internal" href="#c.tsk_tree_first" title="tsk_tree_first"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_first()</span></code></a>
returns <a class="reference internal" href="#c.TSK_TREE_OK" title="TSK_TREE_OK"><code class="xref c c-data docutils literal notranslate"><span class="pre">TSK_TREE_OK</span></code></a>. We then check the value of <code class="docutils literal notranslate"><span class="pre">ret</span></code>
in the loop condition to see if it is equal
to <a class="reference internal" href="#c.TSK_TREE_OK" title="TSK_TREE_OK"><code class="xref c c-data docutils literal notranslate"><span class="pre">TSK_TREE_OK</span></code></a> and execute the loop body for the
first tree in the sequence.</p>
<p>On completing the loop body for the first tree in the sequence,
we then execute the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop increment operation, which
calls <a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a> and assigns the returned value to
<code class="docutils literal notranslate"><span class="pre">ret</span></code>. This function efficiently transforms the current state
of <code class="docutils literal notranslate"><span class="pre">tree</span></code> so that it represents the next tree along the genome,
and returns <a class="reference internal" href="#c.TSK_TREE_OK" title="TSK_TREE_OK"><code class="xref c c-data docutils literal notranslate"><span class="pre">TSK_TREE_OK</span></code></a> if the operation succeeds.
When <a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a> is called on the last tree in the
sequence, the state of <code class="docutils literal notranslate"><span class="pre">tree</span></code> is set back to the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> and the return value is 0.</p>
<p>Thus, the loop on lines 11-14 can exit in two ways:</p>
<ol class="arabic simple">
<li><p>Either we successfully iterate over all trees in the sequence and
<code class="docutils literal notranslate"><span class="pre">ret</span></code> has the value <code class="docutils literal notranslate"><span class="pre">0</span></code> at line 15; or</p></li>
<li><p>An error occurs during <a class="reference internal" href="#c.tsk_tree_first" title="tsk_tree_first"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_first()</span></code></a> or
<a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a>, and ret contains a negative value.</p></li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is <strong>vital</strong> that you check the value of <code class="docutils literal notranslate"><span class="pre">ret</span></code> immediately
after the loop exits like we do here at line 15, or errors can be silently
lost. (Although it’s redundant here, as we don’t do anything else in the
function.)</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the <a class="reference internal" href="#sec-c-api-examples-tree-iteration"><span class="std std-ref">examples</span></a> section for
more examples of sequential seeking, including
an example of using
use <a class="reference internal" href="#c.tsk_tree_last" title="tsk_tree_last"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_last()</span></code></a> and <a class="reference internal" href="#c.tsk_tree_prev" title="tsk_tree_prev"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_prev()</span></code></a>
to iterate from right-to-left.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Seeking functions
<a class="reference internal" href="#c.tsk_tree_first" title="tsk_tree_first"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_first()</span></code></a>,
<a class="reference internal" href="#c.tsk_tree_last" title="tsk_tree_last"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_last()</span></code></a>,
<a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a>
<a class="reference internal" href="#c.tsk_tree_prev" title="tsk_tree_prev"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_prev()</span></code></a>,
and <a class="reference internal" href="#c.tsk_tree_seek" title="tsk_tree_seek"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_seek()</span></code></a>
can be called in any order and from any non-error state.</p>
</div>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_first">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga4cea7b312cc66ce4ffca196e9529d299"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_first</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_first" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to the first tree in the sequence. </p>
<p>Set the state of this tree to reflect the first tree in parent
tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return TSK_TREE_OK on success; or a negative value if an error occurs. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_last">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga11db51cf63331fa0511c753d1e97b6d0"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_last</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_last" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to the last tree in the sequence. </p>
<p>Set the state of this tree to reflect the last tree in parent
tree sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return TSK_TREE_OK on success; or a negative value if an error occurs. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_next">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1gad6ddc60657369251437a18ca85a969a9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_next</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_next" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to the next tree in the sequence. </p>
<p><p>Set the state of this tree to reflect the next tree in parent
tree sequence. If the index of the current tree is <code class="docutils literal notranslate"><span class="pre">j</span></code>,
then the after this operation the index will be <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
<p>Calling <a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a> a tree in the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> is equivalent to calling
<a class="reference internal" href="#c.tsk_tree_first" title="tsk_tree_first"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_first()</span></code></a>.</p>
<p>Calling <a class="reference internal" href="#c.tsk_tree_next" title="tsk_tree_next"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_next()</span></code></a> on the last tree in the
sequence will transform it into the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> (equivalent to
calling <a class="reference internal" href="#c.tsk_tree_clear" title="tsk_tree_clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_clear()</span></code></a>).</p>
<p>Please see the <a class="reference internal" href="#sec-c-api-examples-tree-iteration"><span class="std std-ref">Tree iteration</span></a> examples for
recommended usage.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return TSK_TREE_OK on successfully transforming to a non-null tree; 0 on successfully transforming into the null tree; or a negative value if an error occurs. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_prev">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga5bfd6bd7dd1aca258fcc0d636f60f58e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_prev</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_prev" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to the previous tree in the sequence. </p>
<p><p>Set the state of this tree to reflect the previous tree in parent
tree sequence. If the index of the current tree is <code class="docutils literal notranslate"><span class="pre">j</span></code>,
then the after this operation the index will be <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p>
<p>Calling <a class="reference internal" href="#c.tsk_tree_prev" title="tsk_tree_prev"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_prev()</span></code></a> a tree in the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> is equivalent to calling
<a class="reference internal" href="#c.tsk_tree_last" title="tsk_tree_last"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_last()</span></code></a>.</p>
<p>Calling <a class="reference internal" href="#c.tsk_tree_prev" title="tsk_tree_prev"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_prev()</span></code></a> on the first tree in the
sequence will transform it into the
<a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a> (equivalent to
calling <a class="reference internal" href="#c.tsk_tree_clear" title="tsk_tree_clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_clear()</span></code></a>).</p>
<p>Please see the <a class="reference internal" href="#sec-c-api-examples-tree-iteration"><span class="std std-ref">Tree iteration</span></a> examples for
recommended usage.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return TSK_TREE_OK on successfully transforming to a non-null tree; 0 on successfully transforming into the null tree; or a negative value if an error occurs. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_clear">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga76c78f0831f23002866813a6e170f56a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_clear</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_clear" title="Link to this definition">#</a><br /></dt>
<dd><p>Set the tree into the null state. </p>
<p>Transform this tree into the <a class="reference internal" href="#sec-c-api-trees-null"><span class="std std-ref">null state</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_seek">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga01cfb2c796607a6ebefa1f0dba5335f4"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_seek</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">position</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_seek" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to a particular position on the genome. </p>
<p><p>Set the state of this tree to reflect the tree in parent
tree sequence covering the specified <code class="docutils literal notranslate"><span class="pre">position</span></code>. That is, on success
we will have <code class="docutils literal notranslate"><span class="pre">tree.interval.left</span> <span class="pre">&lt;=</span> <span class="pre">position</span></code> and
we will have <code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">&lt;</span> <span class="pre">tree.interval.right</span></code>.</p>
<p>Seeking to a position currently covered by the tree is
a constant time operation.</p>
<p>Seeking to a position from a non-null tree uses a linear time
algorithm by default, unless the option <a class="reference internal" href="#c.TSK_SEEK_SKIP" title="TSK_SEEK_SKIP"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SEEK_SKIP</span></code></a>
is specified. In this case, a faster algorithm is employed which skips
to the target tree by removing and adding the minimal number of edges
possible. However, this approach does not guarantee that edges are
inserted and removed in time-sorted order.</p>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using the <a class="reference internal" href="#c.TSK_SEEK_SKIP" title="TSK_SEEK_SKIP"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SEEK_SKIP</span></code></a> option
may lead to edges not being inserted or removed in time-sorted order.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>position</strong> – The position in genome coordinates </p></li>
<li><p><strong>options</strong> – Seek options. See the notes above for details. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_seek_index">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga9548d37349a4d264f3ab0b2f01275399"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_seek_index</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">tree</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_seek_index" title="Link to this definition">#</a><br /></dt>
<dd><p>Seek to a specific tree in a tree sequence. </p>
<p>Set the state of this tree to reflect the tree in parent
tree sequence whose index is <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">tree</span> <span class="pre">&lt;</span> <span class="pre">num_trees</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>tree</strong> – The target tree index. </p></li>
<li><p><strong>options</strong> – Seek options. Currently unused. Set to 0 for compatibility with future versions of tskit. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TREE_OK">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga85a0da1fc2f20612303dcb78d2d99fbf"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TREE_OK</span></span></span> <span class="pre">1</span><a class="headerlink" href="#c.TSK_TREE_OK" title="Link to this definition">#</a><br /></dt>
<dd><p>Value returned by seeking methods when they have successfully seeked to a non-null tree. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SEEK_SKIP">
<span class="target" id="group___t_r_e_e___a_p_i___s_e_e_k_i_n_g___g_r_o_u_p_1ga25583f863d888d83f075acdce7b8f858"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SEEK_SKIP</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_SEEK_SKIP" title="Link to this definition">#</a><br /></dt>
<dd><p>Option to seek by skipping to the target tree, adding and removing as few edges as possible. If not specified, a linear time algorithm is used instead. </p>
</dd></dl>

</section>
<section id="tree-queries">
<h3>Tree queries<a class="headerlink" href="#tree-queries" title="Link to this heading">#</a></h3>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_num_roots">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1ga0d916ba54955223a427edc66c0b002b2"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_num_roots</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_num_roots" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns the number of roots in this tree. </p>
<p>See the <a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">Roots</span></a> section for more information
on how the roots of a tree are defined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the number roots in this tree. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_left_root">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1ga3105c67412710f4e4fe78ac446abec8c"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_left_root</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_left_root" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns the leftmost root in this tree. </p>
<p><p>See the <a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">Roots</span></a> section for more information
on how the roots of a tree are defined.</p>
<p>This function is equivalent to <code class="docutils literal notranslate"><span class="pre">tree.left_child[tree.virtual_root]</span></code>.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the leftmost root in the tree. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_right_root">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1ga8ad3f7f4cf7720cd9598f4a09cebf024"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_right_root</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_right_root" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns the rightmost root in this tree. </p>
<p><p>See the <a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">Roots</span></a> section for more information
on how the roots of a tree are defined.</p>
<p>This function is equivalent to <code class="docutils literal notranslate"><span class="pre">tree.right_child[tree.virtual_root]</span></code>.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the rightmost root in the tree. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_sites">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1gae78a6fb62063c3f799eebb3c66bc57ce"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_sites</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><span class="n"><span class="pre">tsk_site_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sites</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">sites_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_sites" title="Link to this definition">#</a><br /></dt>
<dd><p>Get the list of sites for this tree. </p>
<p><p>Gets the list of <a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><code class="xref c c-data docutils literal notranslate"><span class="pre">tsk_site_t</span></code></a> objects in the parent tree sequence
for which the position lies within this tree’s genomic interval.</p>
<p>The memory pointed to by the <code class="docutils literal notranslate"><span class="pre">sites</span></code> parameter is managed by the
<code class="docutils literal notranslate"><span class="pre">tsk_tree_t</span></code> object and must not be altered or freed by client code.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">print_sites</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">num_sites</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">tsk_site_t</span><span class="w"> </span><span class="o">*</span><span class="n">sites</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_get_sites</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sites</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_sites</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_sites</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;position = %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sites</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">position</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is a constant time operation.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>sites</strong> – The destination pointer for the list of sites. </p></li>
<li><p><strong>sites_length</strong> – A pointer to a tsk_size_t value in which the number of sites is stored. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_size_bound">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1ga29dbf9410e027981f30b298503058e73"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_size_bound</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_size_bound" title="Link to this definition">#</a><br /></dt>
<dd><p>Return an upper bound on the number of nodes reachable from the roots of this tree. </p>
<p>This function provides an upper bound on the number of nodes that
can be reached in tree traversals, and is intended to be used
for memory allocation purposes. If <code class="docutils literal notranslate"><span class="pre">num_nodes</span></code> is the number
of nodes visited in a tree traversal from the
<a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">virtual root</span></a>
(e.g., <code class="docutils literal notranslate"><span class="pre">tsk_tree_preorder_from(tree,</span> <span class="pre">tree-&gt;virtual_root,</span> <span class="pre">nodes,</span>
<span class="pre">&amp;num_nodes)</span></code>), the bound <code class="docutils literal notranslate"><span class="pre">N</span></code> returned here is guaranteed to
be greater than or equal to <code class="docutils literal notranslate"><span class="pre">num_nodes</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The precise value returned is not defined and should
not be depended on, as it may change from version-to-version.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An upper bound on the number nodes reachable from the roots of this tree, or zero if this tree has not been initialised. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_print_state">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_e_e___q_u_e_r_y___g_r_o_u_p_1ga780f2d0471fc0cba8057096fd169218a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this tree to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="node-queries">
<h3>Node queries<a class="headerlink" href="#node-queries" title="Link to this heading">#</a></h3>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_parent">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gaa59df58e963e7325c39362fa5e1f9872"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_parent</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">parent</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_parent" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns the parent of the specified node. </p>
<p>Equivalent to <code class="docutils literal notranslate"><span class="pre">tree.parent[u]</span></code> with bounds checking for the node u.
Performance sensitive code which can guarantee that the node u is
valid should use the direct array access in preference to this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The tree node. </p></li>
<li><p><strong>parent</strong> – A tsk_id_t pointer to store the returned parent node. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_time">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gab6f4d2983c9d3c633eebb7a925a96d4f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_time</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ret_time</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_time" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns the time of the specified node. </p>
<p><p>Equivalent to <code class="docutils literal notranslate"><span class="pre">tables-&gt;nodes.time[u]</span></code> with bounds checking for the node u.
Performance sensitive code which can guarantee that the node u is
valid should use the direct array access in preference to this method,
for example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">print_times</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="o">*</span><span class="n">node_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">tree_sequence</span><span class="o">-&gt;</span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">nodes</span><span class="p">.</span><span class="n">time</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tsk_tree_get_size_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_preorder</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;time = %f</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">node_time</span><span class="p">[</span><span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The tree node. </p></li>
<li><p><strong>ret_time</strong> – A double pointer to store the returned node time. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_depth">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gaea0b16dcdd180f36ff4cb1a998564ebb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_depth</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ret_depth</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_depth" title="Link to this definition">#</a><br /></dt>
<dd><p>Return number of nodes on the path from the specified node to root. </p>
<p><p>Return the number of nodes on the path from u to root, not including u.
The depth of a root is therefore zero.</p>
<p>As a special case, the depth of the
<a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">virtual root</span></a> is defined as -1.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The tree node. </p></li>
<li><p><strong>ret_depth</strong> – An int pointer to store the returned node depth. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_branch_length">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1ga53bcc4f92a479b48a38a4a59fa2073bc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_branch_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ret_branch_length</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_branch_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Return the length of the branch ancestral to the specified node. </p>
<p>Return the length of the branch ancestral to the specified node.
Branch length is defined as difference between the time
of a node and its parent. The branch length of a root is zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The tree node. </p></li>
<li><p><strong>ret_branch_length</strong> – A double pointer to store the returned branch length. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_total_branch_length">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gaa3f3cab8148a8f63f23e961c78fcdfae"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_total_branch_length</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ret_tbl</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_total_branch_length" title="Link to this definition">#</a><br /></dt>
<dd><p>Computes the sum of the lengths of all branches reachable from the specified node, or from all roots if <code class="docutils literal notranslate"><span class="pre">u=TSK_NULL</span></code>. </p>
<p><p>Return the total branch length in a particular subtree or of the
entire tree. If the specified node is <a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a> (or the
<a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">virtual root</span></a>)
the sum of the lengths of all branches reachable from roots
is returned. Branch length is defined as difference between the time
of a node and its parent. The branch length of a root is zero.</p>
<p>Note that if the specified node is internal its branch length is
<em>not</em> included, so that, e.g., the total branch length of a
leaf node is zero.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The root of the subtree of interest, or <code class="docutils literal notranslate"><span class="pre">TSK_NULL</span></code> to return the total branch length of the tree. </p></li>
<li><p><strong>ret_tbl</strong> – A double pointer to store the returned total branch length. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_num_samples">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1ga7d9caad9fc24424acf6711d97551f68e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_num_samples</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">ret_num_samples</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_num_samples" title="Link to this definition">#</a><br /></dt>
<dd><p>Counts the number of samples in the subtree rooted at a node. </p>
<p><p>Returns the number of samples descending from a particular node,
including the node itself.</p>
<p>This is a constant time operation.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The tree node. </p></li>
<li><p><strong>ret_num_samples</strong> – A tsk_size_t pointer to store the returned number of samples. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_get_mrca">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gaabe14a5c41891e84b00404d88959f5f3"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_get_mrca</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">v</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">mrca</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_get_mrca" title="Link to this definition">#</a><br /></dt>
<dd><p>Compute the most recent common ancestor of two nodes. </p>
<p>If two nodes do not share a common ancestor in the current tree, the MRCA
node is <a class="reference internal" href="#c.TSK_NULL" title="TSK_NULL"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_NULL</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – A tree node. </p></li>
<li><p><strong>v</strong> – A tree node. </p></li>
<li><p><strong>mrca</strong> – A tsk_id_t pointer to store the returned most recent common ancestor node. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_is_descendant">
<span class="target" id="group___t_r_e_e___a_p_i___n_o_d_e___q_u_e_r_y___g_r_o_u_p_1gac96efc541ed6917952821001f8bfcab5"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_is_descendant</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">u</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_is_descendant" title="Link to this definition">#</a><br /></dt>
<dd><p>Returns true if u is a descendant of v. </p>
<p><p>Returns true if u and v are both valid nodes in the tree sequence
and v lies on the path from u to root, and false otherwise.</p>
<p>Any node is a descendant of itself.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>u</strong> – The descendant node. </p></li>
<li><p><strong>v</strong> – The ancestral node. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true if u is a descendant of v, and false otherwise. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="traversal-orders">
<h3>Traversal orders<a class="headerlink" href="#traversal-orders" title="Link to this heading">#</a></h3>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_preorder">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_a_v_e_r_s_a_l___g_r_o_u_p_1gad1babc3691491b41c351d9080b15df89"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_preorder</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nodes</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">num_nodes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_preorder" title="Link to this definition">#</a><br /></dt>
<dd><p>Fill an array with the nodes of this tree in preorder. </p>
<p><p>Populate an array with the nodes in this tree in preorder. The array
must be pre-allocated and be sufficiently large to hold the array
of nodes visited. The recommended approach is to use the
<a class="reference internal" href="#c.tsk_tree_get_size_bound" title="tsk_tree_get_size_bound"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_get_size_bound()</span></code></a> function, as in the following example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">print_preorder</span><span class="p">(</span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tsk_tree_get_size_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_preorder</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit preorder %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the <a class="reference internal" href="#sec-c-api-examples-tree-traversals"><span class="std std-ref">Tree traversals</span></a> section for
more examples.</p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>nodes</strong> – The tsk_id_t array to store nodes in. See notes above for details. </p></li>
<li><p><strong>num_nodes</strong> – A pointer to a tsk_size_t value where we store the number of nodes in the traversal. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_preorder_from">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_a_v_e_r_s_a_l___g_r_o_u_p_1gaacc2b004d36ffba6e44725481e572da5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_preorder_from</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">root</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nodes</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">num_nodes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_preorder_from" title="Link to this definition">#</a><br /></dt>
<dd><p>Fill an array with the nodes of this tree starting from a particular node. </p>
<p><p>As for <a class="reference internal" href="#c.tsk_tree_preorder" title="tsk_tree_preorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_preorder()</span></code></a> but starting the traversal at a particular node
(which will be the first node in the traversal list). The
<a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">virtual root</span></a> is a valid input for this function
and will be treated like any other tree node. The value <code class="docutils literal notranslate"><span class="pre">-1</span></code> is a special case,
in which we visit all nodes reachable from the roots, and equivalent to
calling <a class="reference internal" href="#c.tsk_tree_preorder" title="tsk_tree_preorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_preorder()</span></code></a>.</p>
<p>See <a class="reference internal" href="#c.tsk_tree_preorder" title="tsk_tree_preorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_preorder()</span></code></a> for details the requirements for the <code class="docutils literal notranslate"><span class="pre">nodes</span></code>
array.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>root</strong> – The root of the subtree to traverse, or -1 to visit all nodes. </p></li>
<li><p><strong>nodes</strong> – The tsk_id_t array to store nodes in. </p></li>
<li><p><strong>num_nodes</strong> – A pointer to a tsk_size_t value where we store the number of nodes in the traversal. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_postorder">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_a_v_e_r_s_a_l___g_r_o_u_p_1ga7ca7721373eca07f34e7ba7c47114338"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_postorder</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nodes</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">num_nodes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_postorder" title="Link to this definition">#</a><br /></dt>
<dd><p>Fill an array with the nodes of this tree in postorder. </p>
<p><p>Populate an array with the nodes in this tree in postorder. The array
must be pre-allocated and be sufficiently large to hold the array
of nodes visited. The recommended approach is to use the
<a class="reference internal" href="#c.tsk_tree_get_size_bound" title="tsk_tree_get_size_bound"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_get_size_bound()</span></code></a> function, as in the following example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">print_postorder</span><span class="p">(</span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tsk_tree_get_size_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_postorder</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit postorder %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See the <a class="reference internal" href="#sec-c-api-examples-tree-traversals"><span class="std std-ref">Tree traversals</span></a> section for
more examples.</p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>nodes</strong> – The tsk_id_t array to store nodes in. See notes above for details. </p></li>
<li><p><strong>num_nodes</strong> – A pointer to a tsk_size_t value where we store the number of nodes in the traversal. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_tree_postorder_from">
<span class="target" id="group___t_r_e_e___a_p_i___t_r_a_v_e_r_s_a_l___g_r_o_u_p_1gafe95abca954fe1d15c31c86b9ca7817e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_tree_postorder_from</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_tree_t" title="tsk_tree_t"><span class="n"><span class="pre">tsk_tree_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">root</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">nodes</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">num_nodes</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_tree_postorder_from" title="Link to this definition">#</a><br /></dt>
<dd><p>Fill an array with the nodes of this tree starting from a particular node. </p>
<p><p>As for <a class="reference internal" href="#c.tsk_tree_postorder" title="tsk_tree_postorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_postorder()</span></code></a> but starting the traversal at a particular node
(which will be the last node in the traversal list). The
<a class="reference internal" href="data-model.html#sec-data-model-tree-roots"><span class="std std-ref">virtual root</span></a> is a valid input for this function
and will be treated like any other tree node. The value <code class="docutils literal notranslate"><span class="pre">-1</span></code> is a special case,
in which we visit all nodes reachable from the roots, and equivalent to
calling <a class="reference internal" href="#c.tsk_tree_postorder" title="tsk_tree_postorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_postorder()</span></code></a>.</p>
<p>See <a class="reference internal" href="#c.tsk_tree_postorder" title="tsk_tree_postorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_postorder()</span></code></a> for details the requirements for the <code class="docutils literal notranslate"><span class="pre">nodes</span></code>
array.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__tree__t"><span class="std std-ref">tsk_tree_t</span></a> object. </p></li>
<li><p><strong>root</strong> – The root of the subtree to traverse, or -1 to visit all nodes. </p></li>
<li><p><strong>nodes</strong> – The tsk_id_t array to store nodes in. See :c:func:<code class="docutils literal notranslate"><span class="pre">tsk_tree_postorder</span></code> for more details. </p></li>
<li><p><strong>num_nodes</strong> – A pointer to a tsk_size_t value where we store the number of nodes in the traversal. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="low-level-sorting">
<span id="sec-c-api-low-level-sorting"></span><h2>Low-level sorting<a class="headerlink" href="#low-level-sorting" title="Link to this heading">#</a></h2>
<p>In some highly performance sensitive cases it can be useful to
have more control over the process of sorting tables. This low-level
API allows a user to provide their own edge sorting function.
This can be useful, for example, to use parallel sorting algorithms,
or to take advantage of the more efficient sorting procedures
available in C++. It is the user’s responsibility to ensure that the
edge sorting requirements are fulfilled by this function.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Create an idiomatic C++11 example where we load a table collection
file from argv[1], and sort the edges  using std::sort, based
on the example in tests/test_minimal_cpp.cpp. We can include
this in the examples below, and link to it here.</p>
</div>
<dl class="c struct">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t">
<span class="target" id="struct__tsk__table__sorter__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></span><a class="headerlink" href="#c._tsk_table_sorter_t" title="Link to this definition">#</a><br /></dt>
<dd><p>Low-level table sorting method. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.tables">
<span class="target" id="struct__tsk__table__sorter__t_1a7f5f04d836d6cafb7c24ff7df5fb54d9"></span><a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tables</span></span></span><a class="headerlink" href="#c._tsk_table_sorter_t.tables" title="Link to this definition">#</a><br /></dt>
<dd><p>The input tables that are being sorted. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.sort_edges">
<span class="target" id="struct__tsk__table__sorter__t_1a79880a1028fbc8d6b5346c60b0127e4e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">sort_edges</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c._tsk_table_sorter_t.sort_edges" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge sorting function. If set to NULL, edges are not sorted. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.sort_mutations">
<span class="target" id="struct__tsk__table__sorter__t_1a239b1abf5c3df536952022f20a395be2"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">sort_mutations</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c._tsk_table_sorter_t.sort_mutations" title="Link to this definition">#</a><br /></dt>
<dd><p>The mutation sorting function. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.sort_individuals">
<span class="target" id="struct__tsk__table__sorter__t_1ae6c5e1af55d897976eaf0efe530368bb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">sort_individuals</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#c._tsk_table_sorter_t.sort_individuals" title="Link to this definition">#</a><br /></dt>
<dd><p>The individual sorting function. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.user_data">
<span class="target" id="struct__tsk__table__sorter__t_1a0f53d287ac7c064d1a49d4bd93ca1cb9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">user_data</span></span></span><a class="headerlink" href="#c._tsk_table_sorter_t.user_data" title="Link to this definition">#</a><br /></dt>
<dd><p>An opaque pointer for use by client code. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c._tsk_table_sorter_t.site_id_map">
<span class="target" id="struct__tsk__table__sorter__t_1a3217405449e28b370cef18d2f5f508ca"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">site_id_map</span></span></span><a class="headerlink" href="#c._tsk_table_sorter_t.site_id_map" title="Link to this definition">#</a><br /></dt>
<dd><p>Mapping from input site IDs to output site IDs. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_sorter_init">
<span class="target" id="group___t_a_b_l_e___s_o_r_t_e_r___a_p_i___g_r_o_u_p_1ga0080b5e0ef3e2a96fe2cb271bb136fc8"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_sorter_init</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_table_collection_t" title="tsk_table_collection_t"><span class="n"><span class="pre">tsk_table_collection_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tables</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_sorter_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the memory for the sorter object. </p>
<p>This must be called before any operations are performed on the
table sorter and initialises all fields. The <code class="docutils literal notranslate"><span class="pre">edge_sort</span></code> function
is set to the default method using qsort. The <code class="docutils literal notranslate"><span class="pre">user_data</span></code>
field is set to NULL.
This method supports the same options as
<a class="reference internal" href="#c.tsk_table_collection_sort" title="tsk_table_collection_sort"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_sort()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised tsk_table_sorter_t object. </p></li>
<li><p><strong>tables</strong> – The table collection to sort. </p></li>
<li><p><strong>options</strong> – Sorting options. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_sorter_run">
<span class="target" id="group___t_a_b_l_e___s_o_r_t_e_r___a_p_i___g_r_o_u_p_1gaa76e4ac03b99f1fc23ad95d33727a20c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_sorter_run</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_bookmark_t" title="tsk_bookmark_t"><span class="n"><span class="pre">tsk_bookmark_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">start</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_sorter_run" title="Link to this definition">#</a><br /></dt>
<dd><p>Runs the sort using the configured functions. </p>
<p><p>Runs the sorting process:</p>
<ol class="arabic simple">
<li><p>Drop the table indexes.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">sort_edges</span></code> function pointer is not NULL, run it. The
first parameter to the called function will be a pointer to this
table_sorter_t object. The second parameter will be the value
<code class="docutils literal notranslate"><span class="pre">start.edges</span></code>. This specifies the offset at which sorting should
start in the edge table. This offset is guaranteed to be within the
bounds of the edge table.</p></li>
<li><p>Sort the site table, building the mapping between site IDs in the
current and sorted tables.</p></li>
<li><p>Sort the mutation table, using the <code class="docutils literal notranslate"><span class="pre">sort_mutations</span></code> pointer.</p></li>
</ol>
<p>If an error occurs during the execution of a user-supplied
sorting function a non-zero value must be returned. This value
will then be returned by <code class="docutils literal notranslate"><span class="pre">tsk_table_sorter_run</span></code>. The error
return value should be chosen to avoid conflicts with tskit error
codes.</p>
<p>See <a class="reference internal" href="#c.tsk_table_collection_sort" title="tsk_table_collection_sort"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_sort()</span></code></a> for details on the <code class="docutils literal notranslate"><span class="pre">start</span></code> parameter.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a tsk_table_sorter_t object. </p></li>
<li><p><strong>start</strong> – The position in the tables at which sorting starts. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_table_sorter_free">
<span class="target" id="group___t_a_b_l_e___s_o_r_t_e_r___a_p_i___g_r_o_u_p_1ga37f3b9ac24535e967ec07872053627e6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_table_sorter_free</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#c._tsk_table_sorter_t" title="_tsk_table_sorter_t"><span class="n"><span class="pre">_tsk_table_sorter_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_table_sorter_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified table sorter. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised tsk_table_sorter_t object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="decoding-genotypes">
<h2>Decoding genotypes<a class="headerlink" href="#decoding-genotypes" title="Link to this heading">#</a></h2>
<p>Obtaining genotypes for samples at specific sites is achieved via
<a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><code class="xref c c-struct docutils literal notranslate"><span class="pre">tsk_variant_t</span></code></a> and its methods.</p>
<dl class="c struct">
<dt class="sig sig-object c" id="c.tsk_variant_t">
<span class="target" id="structtsk__variant__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_t</span></span></span><a class="headerlink" href="#c.tsk_variant_t" title="Link to this definition">#</a><br /></dt>
<dd><p>A variant at a specific site. </p>
<p>Used to generate the genotypes for a given set of samples at a given
site.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.tree_sequence">
<span class="target" id="structtsk__variant__t_1a251d481df680bad0d57e696681cb400a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tree_sequence</span></span></span><a class="headerlink" href="#c.tsk_variant_t.tree_sequence" title="Link to this definition">#</a><br /></dt>
<dd><p>Unowned reference to the tree sequence of the variant. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.site">
<span class="target" id="structtsk__variant__t_1a7a97f74c20a5604c6777d316af4edb96"></span><a class="reference internal" href="#c.tsk_site_t" title="tsk_site_t"><span class="n"><span class="pre">tsk_site_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">site</span></span></span><a class="headerlink" href="#c.tsk_variant_t.site" title="Link to this definition">#</a><br /></dt>
<dd><p>The site this variant is currently decoded at. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.alleles">
<span class="target" id="structtsk__variant__t_1ae593119d74838dd22940dd1553b82c7a"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">alleles</span></span></span><a class="headerlink" href="#c.tsk_variant_t.alleles" title="Link to this definition">#</a><br /></dt>
<dd><p>Array of allele strings that the genotypes of the variant refer to These are not NULL terminated - use <code class="docutils literal notranslate"><span class="pre">allele_lengths</span></code> for example:. <code class="docutils literal notranslate"><span class="pre">printf(&quot;%.*s&quot;,</span> <span class="pre">(int)</span> <span class="pre">var-&gt;allele_lengths[j],</span> <span class="pre">var-&gt;alleles[j]);</span></code></p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.allele_lengths">
<span class="target" id="structtsk__variant__t_1ad0cbdc866c100feab3ac935e0d51eb2f"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">allele_lengths</span></span></span><a class="headerlink" href="#c.tsk_variant_t.allele_lengths" title="Link to this definition">#</a><br /></dt>
<dd><p>Lengths of the allele strings. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.num_alleles">
<span class="target" id="structtsk__variant__t_1a5c7ec2d258242cf4a9a160be3987b22e"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_alleles</span></span></span><a class="headerlink" href="#c.tsk_variant_t.num_alleles" title="Link to this definition">#</a><br /></dt>
<dd><p>Length of the allele array. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.has_missing_data">
<span class="target" id="structtsk__variant__t_1aafd3c7ca549211846989ae4ecd07ec06"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">has_missing_data</span></span></span><a class="headerlink" href="#c.tsk_variant_t.has_missing_data" title="Link to this definition">#</a><br /></dt>
<dd><p>If True the genotypes of isolated nodes have been decoded to the “missing” genotype. If False they are set to the ancestral state (in the absence of mutations above them) </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.genotypes">
<span class="target" id="structtsk__variant__t_1a7ae789be91d7f9b4d182a2dff2e56ed1"></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">genotypes</span></span></span><a class="headerlink" href="#c.tsk_variant_t.genotypes" title="Link to this definition">#</a><br /></dt>
<dd><p>Array of genotypes for the current site. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.num_samples">
<span class="target" id="structtsk__variant__t_1a70993c938b38b1aa49fe2ce1db9a59d8"></span><a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_samples</span></span></span><a class="headerlink" href="#c.tsk_variant_t.num_samples" title="Link to this definition">#</a><br /></dt>
<dd><p>Number of samples. </p>
</dd></dl>

<dl class="c var">
<dt class="sig sig-object c" id="c.tsk_variant_t.samples">
<span class="target" id="structtsk__variant__t_1a866c59eb222e9c9adbc57af93b3efe4a"></span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">samples</span></span></span><a class="headerlink" href="#c.tsk_variant_t.samples" title="Link to this definition">#</a><br /></dt>
<dd><p>Array of sample ids used. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_variant_init">
<span class="target" id="group___v_a_r_i_a_n_t___a_p_i___g_r_o_u_p_1gaf2cf098b428a2b0c240a4aa539d374eb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_treeseq_t" title="tsk_treeseq_t"><span class="n"><span class="pre">tsk_treeseq_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">tree_sequence</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">samples</span></span>, <a class="reference internal" href="#c.tsk_size_t" title="tsk_size_t"><span class="n"><span class="pre">tsk_size_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">num_samples</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">alleles</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_variant_init" title="Link to this definition">#</a><br /></dt>
<dd><p>Initialises the variant by allocating the internal memory. </p>
<p>This must be called before any operations are performed on the variant.
See the <a class="reference internal" href="#sec-c-api-overview-structure"><span class="std std-ref">API structure</span></a> for details on how objects
are initialised and freed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
<li><p><strong>tree_sequence</strong> – A pointer to the tree sequence from which this variant will decode genotypes. No copy is taken, so this tree sequence must persist for the lifetime of the variant. </p></li>
<li><p><strong>samples</strong> – Optional. Either <code class="docutils literal notranslate"><span class="pre">NULL</span></code> or an array of node ids of the samples that are to have their genotypes decoded. A copy of this array will be taken by the variant. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> then the samples from the tree sequence will be used. </p></li>
<li><p><strong>num_samples</strong> – The number of ids in the samples array, ignored if <code class="docutils literal notranslate"><span class="pre">samples</span></code> is <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></li>
<li><p><strong>alleles</strong> – Optional. Either <code class="docutils literal notranslate"><span class="pre">NULL</span></code> or an array of string alleles with a terminal <code class="docutils literal notranslate"><span class="pre">NULL</span></code> sentinel value. If specified, the genotypes will be decoded to match the index in this allele array. If <code class="docutils literal notranslate"><span class="pre">NULL</span></code> then alleles will be automatically determined from the mutations encountered. </p></li>
<li><p><strong>options</strong> – Variant options. Either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">TSK_ISOLATED_NOT_MISSING</span></code> which if specified indicates that isolated sample nodes should not be decoded as the “missing” state but as the ancestral state (or the state of any mutation above them). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_variant_restricted_copy">
<span class="target" id="group___v_a_r_i_a_n_t___a_p_i___g_r_o_u_p_1gadde312eb170517ec2be1d69c45c58ddf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_restricted_copy</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">other</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_variant_restricted_copy" title="Link to this definition">#</a><br /></dt>
<dd><p>Copies the state of this variant to another variant. </p>
<p>Copies the site, genotypes and alleles from this variant to another. Note that
the other variant should be uninitialised as this method does not free any
memory that the other variant owns. After copying <cite>other</cite> is frozen and
this restricts it from being further decoded at any site. <cite>self</cite> remains unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised and decoded <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
<li><p><strong>other</strong> – A pointer to an uninitialised <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_variant_decode">
<span class="target" id="group___v_a_r_i_a_n_t___a_p_i___g_r_o_u_p_1gaf259fb8df6eed0790541e353e3cfe610"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_decode</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <a class="reference internal" href="#c.tsk_id_t" title="tsk_id_t"><span class="n"><span class="pre">tsk_id_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">site_id</span></span>, <a class="reference internal" href="#c.tsk_flags_t" title="tsk_flags_t"><span class="n"><span class="pre">tsk_flags_t</span></span></a><span class="w"> </span><span class="n"><span class="pre">options</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_variant_decode" title="Link to this definition">#</a><br /></dt>
<dd><p>Decode the genotypes at the given site, storing them in this variant. </p>
<p>Decodes the genotypes for this variant’s samples, indexed to this variant’s alleles,
at the specified site.
This method is most efficient at decoding sites in-order, either forwards or backwards
along the tree sequence. Resulting genotypes are stored in the <code class="docutils literal notranslate"><span class="pre">genotypes</span></code> member of
this variant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
<li><p><strong>site_id</strong> – A valid site id for the tree sequence of this variant. </p></li>
<li><p><strong>options</strong> – Bitwise option flags. Currently unused; should be set to zero to ensure compatibility with later versions of <code class="docutils literal notranslate"><span class="pre">tskit</span></code>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return 0 on success or a negative value on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_variant_free">
<span class="target" id="group___v_a_r_i_a_n_t___a_p_i___g_r_o_u_p_1ga080945b2cc121dcd4c56e4fa57715a79"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_variant_free" title="Link to this definition">#</a><br /></dt>
<dd><p>Free the internal memory for the specified variant. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to an initialised <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Always returns 0. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_variant_print_state">
<span class="target" id="group___v_a_r_i_a_n_t___a_p_i___g_r_o_u_p_1ga1c42d097a28e506a5e9794d81e321385"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_variant_print_state</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#c.tsk_variant_t" title="tsk_variant_t"><span class="n"><span class="pre">tsk_variant_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">self</span></span>, <span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_variant_print_state" title="Link to this definition">#</a><br /></dt>
<dd><p>Print out the state of this variant to the specified stream. </p>
<p>This method is intended for debugging purposes and should not be used in production code. The format of the output should <strong>not</strong> be depended on and may change arbitrarily between versions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong> – A pointer to a <a class="reference internal" href="#structtsk__variant__t"><span class="std std-ref">tsk_variant_t</span></a> object. </p></li>
<li><p><strong>out</strong> – The stream to write the summary to. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="miscellaneous-functions">
<h2>Miscellaneous functions<a class="headerlink" href="#miscellaneous-functions" title="Link to this heading">#</a></h2>
<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_strerror">
<span class="target" id="core_8h_1aa8388d960de86063e69e5a75a3218ebe"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">tsk_strerror</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n"><span class="pre">err</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_strerror" title="Link to this definition">#</a><br /></dt>
<dd><p>Return a description of the specified error. </p>
<p>The memory for the returned string is handled by the library and should not be freed by client code.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err</strong> – A tskit error code. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A description of the error. </p>
</dd>
</dl>
</dd></dl>

<dl class="c function">
<dt class="sig sig-object c" id="c.tsk_is_unknown_time">
<span class="target" id="core_8h_1a94ec2bd684bd1bd46b8f391a1a62d046"></span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tsk_is_unknown_time</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tsk_is_unknown_time" title="Link to this definition">#</a><br /></dt>
<dd><p>Check if a number is <code class="docutils literal notranslate"><span class="pre">TSK_UNKNOWN_TIME</span></code></p>
<p>Unknown time values in tskit are represented by a particular NaN value. Since NaN values
are not equal to each other by definition, a simple comparison like
<code class="docutils literal notranslate"><span class="pre">mutation.time</span> <span class="pre">==</span> <span class="pre">TSK_UNKNOWN_TIME</span></code> will fail even if the mutation’s time is
TSK_UNKNOWN_TIME. This function compares the underlying bit representation of a double
value and returns true iff it is equal to the specific NaN value
<a class="reference internal" href="#c.TSK_UNKNOWN_TIME" title="TSK_UNKNOWN_TIME"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_UNKNOWN_TIME</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> – The number to check </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>true if the number is <code class="docutils literal notranslate"><span class="pre">TSK_UNKNOWN_TIME</span></code> else false </p>
</dd>
</dl>
</dd></dl>

</section>
<section id="function-specific-options">
<h2>Function Specific Options<a class="headerlink" href="#function-specific-options" title="Link to this heading">#</a></h2>
<section id="load-and-init">
<h3>Load and init<a class="headerlink" href="#load-and-init" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_LOAD_SKIP_TABLES">
<span class="target" id="group___a_p_i___f_l_a_g_s___l_o_a_d___i_n_i_t___g_r_o_u_p_1gadb22a395cb2de7cdc6745e86aa350584"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_LOAD_SKIP_TABLES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_LOAD_SKIP_TABLES" title="Link to this definition">#</a><br /></dt>
<dd><p>Skip reading tables, and only load top-level information. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE">
<span class="target" id="group___a_p_i___f_l_a_g_s___l_o_a_d___i_n_i_t___g_r_o_u_p_1ga7b73f8949c149f7a9772a28cf9946921"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_LOAD_SKIP_REFERENCE_SEQUENCE</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_LOAD_SKIP_REFERENCE_SEQUENCE" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not load reference sequence. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TABLE_NO_METADATA">
<span class="target" id="group___a_p_i___f_l_a_g_s___l_o_a_d___i_n_i_t___g_r_o_u_p_1gaf957f10cfde29413aa3546a039436900"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TABLE_NO_METADATA</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_TABLE_NO_METADATA" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not allocate space to store metadata in this table. Operations
attempting to add non-empty metadata to the table will fail
with error TSK_ERR_METADATA_DISABLED.</p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TC_NO_EDGE_METADATA">
<span class="target" id="group___a_p_i___f_l_a_g_s___l_o_a_d___i_n_i_t___g_r_o_u_p_1ga621f3782cb57639460e70b333ff1685b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TC_NO_EDGE_METADATA</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span><a class="headerlink" href="#c.TSK_TC_NO_EDGE_METADATA" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not allocate space to store metadata in the edge table. Operations
attempting to add non-empty metadata to the edge table will fail
with error TSK_ERR_METADATA_DISABLED.</p>
</dd></dl>

</section>
<section id="tsk-treeseq-init">
<h3><a class="reference internal" href="#c.tsk_treeseq_init" title="tsk_treeseq_init"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_init()</span></code></a><a class="headerlink" href="#tsk-treeseq-init" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TS_INIT_BUILD_INDEXES">
<span class="target" id="group___a_p_i___f_l_a_g_s___t_s___i_n_i_t___g_r_o_u_p_1gae6ada94499effdb2820555455ef868cb"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TS_INIT_BUILD_INDEXES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_TS_INIT_BUILD_INDEXES" title="Link to this definition">#</a><br /></dt>
<dd><p>If specified edge indexes will be built and stored in the table collection when the tree sequence is initialised. Indexes are required for a valid tree sequence, and are not built by default for performance reasons. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_TS_INIT_COMPUTE_MUTATION_PARENTS">
<span class="target" id="group___a_p_i___f_l_a_g_s___t_s___i_n_i_t___g_r_o_u_p_1gad4053ad806de5b49b7e3e874f0c471d7"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_TS_INIT_COMPUTE_MUTATION_PARENTS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_TS_INIT_COMPUTE_MUTATION_PARENTS" title="Link to this definition">#</a><br /></dt>
<dd><p>If specified, mutation parents in the table collection will be overwritten with those computed from the topology when the tree sequence is initialised. </p>
</dd></dl>

</section>
<section id="tsk-treeseq-simplify-tsk-table-collection-simplify">
<h3><a class="reference internal" href="#c.tsk_treeseq_simplify" title="tsk_treeseq_simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_simplify()</span></code></a>, <a class="reference internal" href="#c.tsk_table_collection_simplify" title="tsk_table_collection_simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_simplify()</span></code></a><a class="headerlink" href="#tsk-treeseq-simplify-tsk-table-collection-simplify" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_FILTER_SITES">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1gad5ad36ed81f563b03946a3312b85b162"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_FILTER_SITES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_FILTER_SITES" title="Link to this definition">#</a><br /></dt>
<dd><p>Remove sites from the output if there are no mutations that reference them. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_FILTER_POPULATIONS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga28650ac1287e9048bdde08c26d2d5068"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_FILTER_POPULATIONS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_FILTER_POPULATIONS" title="Link to this definition">#</a><br /></dt>
<dd><p>Remove populations from the output if there are no nodes or migrations that reference them. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_FILTER_INDIVIDUALS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga4f53b161cc4569a4471d6fea3e44a94d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_FILTER_INDIVIDUALS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_FILTER_INDIVIDUALS" title="Link to this definition">#</a><br /></dt>
<dd><p>Remove individuals from the output if there are no nodes that reference them. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_NO_FILTER_NODES">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga384f4fc4929e5a5cf2b0d996591a1a5a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_NO_FILTER_NODES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">7)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_NO_FILTER_NODES" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not remove nodes from the output if there are no edges that reference them and do not reorder nodes so that the samples are nodes 0 to num_samples - 1. Note that this flag is negated compared to other filtering options because the default behaviour is to filter unreferenced nodes and reorder to put samples first. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1gafc3e583e24e0e0023d8b884eba355f17"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">8)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not update the sample status of nodes as a result of simplification. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1gab168c97eba7e81e9aa8bca736587e9ef"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_REDUCE_TO_SITE_TOPOLOGY" title="Link to this definition">#</a><br /></dt>
<dd><p>Reduce the topological information in the tables to the minimum necessary to represent the trees that contain sites. If there are zero sites this will result in an zero output edges. When the number of sites is greater than zero, every tree in the output tree sequence will contain at least one site. For a given site, the topology of the tree containing that site will be identical (up to node ID remapping) to the topology of the corresponding tree in the input. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_KEEP_UNARY">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga299a6afe491ac53674356c26dc5db37b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_KEEP_UNARY</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">4)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_KEEP_UNARY" title="Link to this definition">#</a><br /></dt>
<dd><p>By default simplify removes unary nodes (i.e., nodes with exactly one child) along the path from samples to root. If this option is specified such unary nodes will be preserved in the output. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_KEEP_INPUT_ROOTS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga60c384693e14304a1b73ffe7df6bd57b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_KEEP_INPUT_ROOTS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">5)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_KEEP_INPUT_ROOTS" title="Link to this definition">#</a><br /></dt>
<dd><p>By default simplify removes all topology ancestral the MRCAs of the samples. This option inserts edges from these MRCAs back to the roots of the input trees. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_i_m_p_l_i_f_y___g_r_o_u_p_1ga721830f757329727d9fe018c78cfcb52"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">6)</span><a class="headerlink" href="#c.TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS" title="Link to this definition">#</a><br /></dt>
<dd><p>This acts like <a class="reference internal" href="#c.TSK_SIMPLIFY_KEEP_UNARY" title="TSK_SIMPLIFY_KEEP_UNARY"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_KEEP_UNARY</span></code></a> (and is mutually exclusive with that
flag). It keeps unary nodes, but only if the unary node is referenced from an individual.</p>
</dd></dl>

</section>
<section id="tsk-table-collection-check-integrity">
<h3><a class="reference internal" href="#c.tsk_table_collection_check_integrity" title="tsk_table_collection_check_integrity"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_check_integrity()</span></code></a><a class="headerlink" href="#tsk-table-collection-check-integrity" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_EDGE_ORDERING">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1gad05b41b6d497f799b9d9d6885c4d44b9"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_EDGE_ORDERING</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_CHECK_EDGE_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>Check edge ordering constraints for a tree sequence. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_SITE_ORDERING">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1ga29f0e5a2efd0821328f7151c88c7a43a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_SITE_ORDERING</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_CHECK_SITE_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>Check that sites are in non-decreasing position order. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_SITE_DUPLICATES">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1ga0de5e829e78e192915e8f13d94f96c5a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_SITE_DUPLICATES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_CHECK_SITE_DUPLICATES" title="Link to this definition">#</a><br /></dt>
<dd><p>Check for any duplicate site positions. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_MUTATION_ORDERING">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1ga7070b46bb017fde257db1c66196f809a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_MUTATION_ORDERING</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span><a class="headerlink" href="#c.TSK_CHECK_MUTATION_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>Check constraints on the ordering of mutations. Any non-null mutation parents and known times are checked for ordering constraints. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_INDIVIDUAL_ORDERING">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1ga7f3cb0ee34a036b333a5d2068189ed69"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_INDIVIDUAL_ORDERING</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">4)</span><a class="headerlink" href="#c.TSK_CHECK_INDIVIDUAL_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>Check individual parents are before children, where specified. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_MIGRATION_ORDERING">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1gaa13eb479727efb2744b29b2117c16b38"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_MIGRATION_ORDERING</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">5)</span><a class="headerlink" href="#c.TSK_CHECK_MIGRATION_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>Check migrations are ordered by time. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_INDEXES">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1ga07b2d6afd79b38e870b411fe473ef587"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_INDEXES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">6)</span><a class="headerlink" href="#c.TSK_CHECK_INDEXES" title="Link to this definition">#</a><br /></dt>
<dd><p>Check that the table indexes exist, and contain valid edge references. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_TREES">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1gac785e3a5fd6d94b845d15b6be14bb9ac"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_TREES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">7)</span><a class="headerlink" href="#c.TSK_CHECK_TREES" title="Link to this definition">#</a><br /></dt>
<dd><p>All checks needed to define a valid tree sequence. Note that this implies all of the above checks. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CHECK_MUTATION_PARENTS">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1gadf7a10d377d91b63c5a85eafb8f21c13"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CHECK_MUTATION_PARENTS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">8)</span><a class="headerlink" href="#c.TSK_CHECK_MUTATION_PARENTS" title="Link to this definition">#</a><br /></dt>
<dd><p>Check mutation parents are consistent with topology. Implies TSK_CHECK_TREES. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_NO_CHECK_POPULATION_REFS">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_h_e_c_k___i_n_t_e_g_r_i_t_y___g_r_o_u_p_1gaa9c69bca4422a4a7f9314e9709bc0bb6"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_NO_CHECK_POPULATION_REFS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">12)</span><a class="headerlink" href="#c.TSK_NO_CHECK_POPULATION_REFS" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not check integrity of references to populations. This can be safely combined with the other checks. </p>
</dd></dl>

</section>
<section id="tsk-table-collection-clear">
<h3><a class="reference internal" href="#c.tsk_table_collection_clear" title="tsk_table_collection_clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_clear()</span></code></a><a class="headerlink" href="#tsk-table-collection-clear" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CLEAR_METADATA_SCHEMAS">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_l_e_a_r___g_r_o_u_p_1gaa506d7f36ab994d685147c7c4ab44338"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CLEAR_METADATA_SCHEMAS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_CLEAR_METADATA_SCHEMAS" title="Link to this definition">#</a><br /></dt>
<dd><p>Additionally clear the table metadata schemas </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CLEAR_TS_METADATA_AND_SCHEMA">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_l_e_a_r___g_r_o_u_p_1ga98212175732cca9d5db9c5fea7c08409"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CLEAR_TS_METADATA_AND_SCHEMA</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_CLEAR_TS_METADATA_AND_SCHEMA" title="Link to this definition">#</a><br /></dt>
<dd><p>Additionally clear the tree-sequence metadata and schema </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CLEAR_PROVENANCE">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_l_e_a_r___g_r_o_u_p_1ga46e5fefb2c17b089dd7d714ee4f227e1"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CLEAR_PROVENANCE</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_CLEAR_PROVENANCE" title="Link to this definition">#</a><br /></dt>
<dd><p>Additionally clear the provenance table </p>
</dd></dl>

</section>
<section id="tsk-table-collection-copy">
<h3><a class="reference internal" href="#c.tsk_table_collection_copy" title="tsk_table_collection_copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_copy()</span></code></a><a class="headerlink" href="#tsk-table-collection-copy" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_COPY_FILE_UUID">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_o_p_y___g_r_o_u_p_1gaa22ff16a980e96a6774c38fff275a88e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_COPY_FILE_UUID</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_COPY_FILE_UUID" title="Link to this definition">#</a><br /></dt>
<dd><p>Copy the file uuid, by default this is not copied. </p>
</dd></dl>

</section>
<section id="all-equality-functions">
<h3>All equality functions<a class="headerlink" href="#all-equality-functions" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_TS_METADATA">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1ga16220f01dfb9210c61335d8766d4a992"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_TS_METADATA</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_TS_METADATA" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include the top-level tree sequence metadata and metadata schemas in the comparison. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_PROVENANCE">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1ga1756aaaa1a4948db25fffad77536866d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_PROVENANCE</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_PROVENANCE" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include the provenance table in comparison. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_METADATA">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1ga56d7bd0e7c2b279e1a606b4ac3e1583e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_METADATA</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_METADATA" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include metadata when comparing the table collections.
This includes both the top-level tree sequence metadata as well as the
metadata for each of the tables (i.e, <a class="reference internal" href="#c.TSK_CMP_IGNORE_TS_METADATA" title="TSK_CMP_IGNORE_TS_METADATA"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_TS_METADATA</span></code></a> is implied).
All metadata schemas are also ignored.</p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_TIMESTAMPS">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1gaed81d69d5fc90ed0324170f7932a6446"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_TIMESTAMPS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_TIMESTAMPS" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include the timestamp information when comparing the provenance
tables. This has no effect if <a class="reference internal" href="#c.TSK_CMP_IGNORE_PROVENANCE" title="TSK_CMP_IGNORE_PROVENANCE"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_CMP_IGNORE_PROVENANCE</span></code></a> is specified.</p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_TABLES">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1gaa4933c7e030b44973faddbb235e37293"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_TABLES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">4)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_TABLES" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include any tables in the comparison, thus comparing only the top-level information of the table collections being compared. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_CMP_IGNORE_REFERENCE_SEQUENCE">
<span class="target" id="group___a_p_i___f_l_a_g_s___c_m_p___g_r_o_u_p_1ga14ed7fb03b2a21507fdd87e33a2bd459"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_CMP_IGNORE_REFERENCE_SEQUENCE</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">5)</span><a class="headerlink" href="#c.TSK_CMP_IGNORE_REFERENCE_SEQUENCE" title="Link to this definition">#</a><br /></dt>
<dd><p>Do not include the reference sequence in the comparison. </p>
</dd></dl>

</section>
<section id="tsk-table-collection-subset">
<h3><a class="reference internal" href="#c.tsk_table_collection_subset" title="tsk_table_collection_subset"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_subset()</span></code></a><a class="headerlink" href="#tsk-table-collection-subset" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SUBSET_NO_CHANGE_POPULATIONS">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_u_b_s_e_t___g_r_o_u_p_1ga81fbc60f2a5e6d8b4fc04a47ab29d763"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SUBSET_NO_CHANGE_POPULATIONS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_SUBSET_NO_CHANGE_POPULATIONS" title="Link to this definition">#</a><br /></dt>
<dd><p>If this flag is provided, the population table will not be changed in any way. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_SUBSET_KEEP_UNREFERENCED">
<span class="target" id="group___a_p_i___f_l_a_g_s___s_u_b_s_e_t___g_r_o_u_p_1ga9a95acac64260346431c495838a4c53d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_SUBSET_KEEP_UNREFERENCED</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_SUBSET_KEEP_UNREFERENCED" title="Link to this definition">#</a><br /></dt>
<dd><p>If this flag is provided, then unreferenced sites, individuals, and populations
will not be removed. If so, the site and individual tables will not be changed,
and (unless <a class="reference internal" href="#c.TSK_SUBSET_NO_CHANGE_POPULATIONS" title="TSK_SUBSET_NO_CHANGE_POPULATIONS"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SUBSET_NO_CHANGE_POPULATIONS</span></code></a> is also provided) unreferenced
populations will be placed last, in their original order.</p>
</dd></dl>

</section>
<section id="tsk-table-collection-union">
<h3><a class="reference internal" href="#c.tsk_table_collection_union" title="tsk_table_collection_union"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_union()</span></code></a><a class="headerlink" href="#tsk-table-collection-union" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_UNION_NO_CHECK_SHARED">
<span class="target" id="group___a_p_i___f_l_a_g_s___u_n_i_o_n___g_r_o_u_p_1ga2c16c0a8ace9c13f9f4330ffc58a0ef2"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_UNION_NO_CHECK_SHARED</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">0)</span><a class="headerlink" href="#c.TSK_UNION_NO_CHECK_SHARED" title="Link to this definition">#</a><br /></dt>
<dd><p>By default, union checks that the portion of shared history between <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>, as implied by <code class="docutils literal notranslate"><span class="pre">other_node_mapping</span></code>, are indeed equivalent. It does so by subsetting both <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> on the equivalent nodes specified in <code class="docutils literal notranslate"><span class="pre">other_node_mapping</span></code>, and then checking for equality of the subsets. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_UNION_NO_ADD_POP">
<span class="target" id="group___a_p_i___f_l_a_g_s___u_n_i_o_n___g_r_o_u_p_1gadad11553a37c798272bff41088b9e4f1"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_UNION_NO_ADD_POP</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">1)</span><a class="headerlink" href="#c.TSK_UNION_NO_ADD_POP" title="Link to this definition">#</a><br /></dt>
<dd><p>By default, all nodes new to <code class="docutils literal notranslate"><span class="pre">self</span></code> are assigned new populations. If this option is specified, nodes that are added to <code class="docutils literal notranslate"><span class="pre">self</span></code> will retain the population IDs they have in <code class="docutils literal notranslate"><span class="pre">other</span></code>. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_UNION_ALL_EDGES">
<span class="target" id="group___a_p_i___f_l_a_g_s___u_n_i_o_n___g_r_o_u_p_1gae29fed1af50982178546046097b4b336"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_UNION_ALL_EDGES</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">2)</span><a class="headerlink" href="#c.TSK_UNION_ALL_EDGES" title="Link to this definition">#</a><br /></dt>
<dd><p>By default, union only adds edges adjacent to a newly added node; this option adds all edges. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_UNION_ALL_MUTATIONS">
<span class="target" id="group___a_p_i___f_l_a_g_s___u_n_i_o_n___g_r_o_u_p_1ga58247732f9ec6afbeb995b713fd51f2f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_UNION_ALL_MUTATIONS</span></span></span> <span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">3)</span><a class="headerlink" href="#c.TSK_UNION_ALL_MUTATIONS" title="Link to this definition">#</a><br /></dt>
<dd><p>By default, union only adds only mutations on newly added edges, and sites for those mutations; this option adds all mutations and all sites. </p>
</dd></dl>

</section>
</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">#</a></h2>
<section id="api-version">
<h3>API Version<a class="headerlink" href="#api-version" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_VERSION_MAJOR">
<span class="target" id="group___a_p_i___v_e_r_s_i_o_n___g_r_o_u_p_1gac9c5ebf4e4a81acdcc0efcd04895837e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_VERSION_MAJOR</span></span></span> <span class="pre">1</span><a class="headerlink" href="#c.TSK_VERSION_MAJOR" title="Link to this definition">#</a><br /></dt>
<dd><p>The library major version. Incremented when breaking changes to the API or ABI are introduced. This includes any changes to the signatures of functions and the sizes and types of externally visible structs. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_VERSION_MINOR">
<span class="target" id="group___a_p_i___v_e_r_s_i_o_n___g_r_o_u_p_1gae8c8dbba234b6a87c37d87a663cbf865"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_VERSION_MINOR</span></span></span> <span class="pre">3</span><a class="headerlink" href="#c.TSK_VERSION_MINOR" title="Link to this definition">#</a><br /></dt>
<dd><p>The library minor version. Incremented when non-breaking backward-compatible changes to the API or ABI are introduced, i.e., the addition of a new function. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_VERSION_PATCH">
<span class="target" id="group___a_p_i___v_e_r_s_i_o_n___g_r_o_u_p_1ga31b513d413786b7235c89a0b131505b1"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_VERSION_PATCH</span></span></span> <span class="pre">0</span><a class="headerlink" href="#c.TSK_VERSION_PATCH" title="Link to this definition">#</a><br /></dt>
<dd><p>The library patch version. Incremented when any changes not relevant to the to the API or ABI are introduced, i.e., internal refactors of bugfixes. </p>
</dd></dl>

</section>
<section id="common-constants">
<span id="sec-c-api-error-codes"></span><h3>Common constants<a class="headerlink" href="#common-constants" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_NODE_IS_SAMPLE">
<span class="target" id="group___g_e_n_e_r_i_c___c_o_n_s_t_a_n_t_s_1gab229408316a4729105a863f925f9ebfd"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_NODE_IS_SAMPLE</span></span></span> <span class="pre">1u</span><a class="headerlink" href="#c.TSK_NODE_IS_SAMPLE" title="Link to this definition">#</a><br /></dt>
<dd><p>Used in node flags to indicate that a node is a sample node. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_NULL">
<span class="target" id="group___g_e_n_e_r_i_c___c_o_n_s_t_a_n_t_s_1ga7f128a7cb642b012f7268fbdd1f336ca"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_NULL</span></span></span> <span class="pre">((</span><a class="reference internal" href="#core_8h_1ad11b8b1c1f56c700a6959e80417e4d53"><span class="std std-ref"><span class="pre">tsk_id_t</span></span></a><span class="pre">)</span> <span class="pre">-1)</span><a class="headerlink" href="#c.TSK_NULL" title="Link to this definition">#</a><br /></dt>
<dd><p>Null value used for cases such as absent id references. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_MISSING_DATA">
<span class="target" id="group___g_e_n_e_r_i_c___c_o_n_s_t_a_n_t_s_1ga5c2ad5bdcf60200acafeb4b02d20ceb0"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_MISSING_DATA</span></span></span> <span class="pre">(-1)</span><a class="headerlink" href="#c.TSK_MISSING_DATA" title="Link to this definition">#</a><br /></dt>
<dd><p>Value used for missing data in genotype arrays. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_UNKNOWN_TIME">
<span class="target" id="group___g_e_n_e_r_i_c___c_o_n_s_t_a_n_t_s_1gaa6ef94f967fefcdea723939e57bbe86c"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_UNKNOWN_TIME</span></span></span> <span class="pre">__tsk_nan_f()</span><a class="headerlink" href="#c.TSK_UNKNOWN_TIME" title="Link to this definition">#</a><br /></dt>
<dd><p>Value to indicate that a time is unknown. Note that this value is a non-signalling NAN whose representation differs from the NAN generated by computations such as divide by zeros. </p>
</dd></dl>

</section>
<section id="generic-errors">
<span id="sec-c-api-tables-api"></span><h3>Generic Errors<a class="headerlink" href="#generic-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_GENERIC">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1ga4218de76dd54ea450491d4b77f0f7560"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_GENERIC</span></span></span> <span class="pre">-1</span><a class="headerlink" href="#c.TSK_ERR_GENERIC" title="Link to this definition">#</a><br /></dt>
<dd><p>Generic error thrown when no other message can be generated. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_NO_MEMORY">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1gaed1ff903888bae689a733f98a1d50e0e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_NO_MEMORY</span></span></span> <span class="pre">-2</span><a class="headerlink" href="#c.TSK_ERR_NO_MEMORY" title="Link to this definition">#</a><br /></dt>
<dd><p>Memory could not be allocated. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_IO">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1gaa21fc9cb235a80e889810aebe164409b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_IO</span></span></span> <span class="pre">-3</span><a class="headerlink" href="#c.TSK_ERR_IO" title="Link to this definition">#</a><br /></dt>
<dd><p>An IO error occurred. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_PARAM_VALUE">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1ga8d108648302b0fb4100a771322e8b38e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_PARAM_VALUE</span></span></span> <span class="pre">-4</span><a class="headerlink" href="#c.TSK_ERR_BAD_PARAM_VALUE" title="Link to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BUFFER_OVERFLOW">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1gad9728476aa3292f83644b218d4e29314"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BUFFER_OVERFLOW</span></span></span> <span class="pre">-5</span><a class="headerlink" href="#c.TSK_ERR_BUFFER_OVERFLOW" title="Link to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNSUPPORTED_OPERATION">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1gab0ecb24690b1771074a4f9f675efcbc0"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNSUPPORTED_OPERATION</span></span></span> <span class="pre">-6</span><a class="headerlink" href="#c.TSK_ERR_UNSUPPORTED_OPERATION" title="Link to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_GENERATE_UUID">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1gaba956af06c25cb6a87f66334c5e7e49e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_GENERATE_UUID</span></span></span> <span class="pre">-7</span><a class="headerlink" href="#c.TSK_ERR_GENERATE_UUID" title="Link to this definition">#</a><br /></dt>
<dd></dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EOF">
<span class="target" id="group___g_e_n_e_r_a_l___e_r_r_o_r___g_r_o_u_p_1ga9eb77ba04c5ce2667aa4dc7a2cde8782"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EOF</span></span></span> <span class="pre">-8</span><a class="headerlink" href="#c.TSK_ERR_EOF" title="Link to this definition">#</a><br /></dt>
<dd><p>The file stream ended after reading zero bytes. </p>
</dd></dl>

</section>
<section id="file-format-errors">
<h3>File format errors<a class="headerlink" href="#file-format-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_FILE_FORMAT">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1ga1aadb65c19eaa70e590096a65bd715c7"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_FILE_FORMAT</span></span></span> <span class="pre">-100</span><a class="headerlink" href="#c.TSK_ERR_FILE_FORMAT" title="Link to this definition">#</a><br /></dt>
<dd><p>A file could not be read because it is in the wrong format </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_FILE_VERSION_TOO_OLD">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1gaa852249512d6dbd7070d82a8219455ae"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_FILE_VERSION_TOO_OLD</span></span></span> <span class="pre">-101</span><a class="headerlink" href="#c.TSK_ERR_FILE_VERSION_TOO_OLD" title="Link to this definition">#</a><br /></dt>
<dd><p>The file is in tskit format, but the version is too old for the library to read. The file should be upgraded to the latest version using the <code class="docutils literal notranslate"><span class="pre">tskit</span> <span class="pre">upgrade</span></code> command line utility from tskit version&lt;0.6.2. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_FILE_VERSION_TOO_NEW">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1ga5c1ffddfd2a4f080849e1ee7058a6a4e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_FILE_VERSION_TOO_NEW</span></span></span> <span class="pre">-102</span><a class="headerlink" href="#c.TSK_ERR_FILE_VERSION_TOO_NEW" title="Link to this definition">#</a><br /></dt>
<dd><p>The file is in tskit format, but the version is too new for the library to read. To read the file you must upgrade the version of tskit. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_REQUIRED_COL_NOT_FOUND">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1gae8dd6893ad4bb014c28109fc917b2f69"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_REQUIRED_COL_NOT_FOUND</span></span></span> <span class="pre">-103</span><a class="headerlink" href="#c.TSK_ERR_REQUIRED_COL_NOT_FOUND" title="Link to this definition">#</a><br /></dt>
<dd><p>A column that is a required member of a table was not found in the file. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BOTH_COLUMNS_REQUIRED">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1ga400852f527f177ff703e14aabfc93f7d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BOTH_COLUMNS_REQUIRED</span></span></span> <span class="pre">-104</span><a class="headerlink" href="#c.TSK_ERR_BOTH_COLUMNS_REQUIRED" title="Link to this definition">#</a><br /></dt>
<dd><p>One of a pair of columns that must be specified together was not found in the file. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_COLUMN_TYPE">
<span class="target" id="group___f_i_l_e___f_o_r_m_a_t___e_r_r_o_r___g_r_o_u_p_1ga5b52763b23798455720cd71949fa8ab3"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_COLUMN_TYPE</span></span></span> <span class="pre">-105</span><a class="headerlink" href="#c.TSK_ERR_BAD_COLUMN_TYPE" title="Link to this definition">#</a><br /></dt>
<dd><p>An unsupported type was provided for a column in the file. </p>
</dd></dl>

</section>
<section id="out-of-bounds-errors">
<h3>Out-of-bounds errors<a class="headerlink" href="#out-of-bounds-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_OFFSET">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga8d45c32bdc76a2e44204502c66571ce0"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_OFFSET</span></span></span> <span class="pre">-200</span><a class="headerlink" href="#c.TSK_ERR_BAD_OFFSET" title="Link to this definition">#</a><br /></dt>
<dd><p>A bad value was provided for a ragged column offset, values should start at zero and be monotonically increasing. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_SEEK_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga88a6a9625b18836ba387cc133a037c1a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_SEEK_OUT_OF_BOUNDS</span></span></span> <span class="pre">-201</span><a class="headerlink" href="#c.TSK_ERR_SEEK_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A position to seek to was less than zero or greater than the length of the genome </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_NODE_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga2e1e7dd1682b43d6cab29bb787336908"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_NODE_OUT_OF_BOUNDS</span></span></span> <span class="pre">-202</span><a class="headerlink" href="#c.TSK_ERR_NODE_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A node id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EDGE_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga2980c4cc9f5154de3e4776480c9c0a88"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EDGE_OUT_OF_BOUNDS</span></span></span> <span class="pre">-203</span><a class="headerlink" href="#c.TSK_ERR_EDGE_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A edge id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_POPULATION_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga85c1571a5a9b39df792c6013ec8d2591"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_POPULATION_OUT_OF_BOUNDS</span></span></span> <span class="pre">-204</span><a class="headerlink" href="#c.TSK_ERR_POPULATION_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A population id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_SITE_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1gaeb78146bed2b82a4fd1eee561ad500af"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_SITE_OUT_OF_BOUNDS</span></span></span> <span class="pre">-205</span><a class="headerlink" href="#c.TSK_ERR_SITE_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A site id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga4d75e86bd40d60f84a73f658eb6a9306"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_OUT_OF_BOUNDS</span></span></span> <span class="pre">-206</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_INDIVIDUAL_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga31d2a71ea64cede7b80a196617fba353"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_INDIVIDUAL_OUT_OF_BOUNDS</span></span></span> <span class="pre">-207</span><a class="headerlink" href="#c.TSK_ERR_INDIVIDUAL_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>An individual id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MIGRATION_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga798fd0e588c50e9e62d5b8235a8b2b93"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MIGRATION_OUT_OF_BOUNDS</span></span></span> <span class="pre">-208</span><a class="headerlink" href="#c.TSK_ERR_MIGRATION_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A migration id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_PROVENANCE_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga712580f004c547db3cb9a8e66ee31a2b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_PROVENANCE_OUT_OF_BOUNDS</span></span></span> <span class="pre">-209</span><a class="headerlink" href="#c.TSK_ERR_PROVENANCE_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A provenance id was less than zero or greater than the final index </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TIME_NONFINITE">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga70fa89925947a84503d5b059e58fe9f3"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TIME_NONFINITE</span></span></span> <span class="pre">-210</span><a class="headerlink" href="#c.TSK_ERR_TIME_NONFINITE" title="Link to this definition">#</a><br /></dt>
<dd><p>A time value was non-finite (NaN counts as finite) </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_GENOME_COORDS_NONFINITE">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1ga30e96998856a922fb8aff30fd9cebba8"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_GENOME_COORDS_NONFINITE</span></span></span> <span class="pre">-211</span><a class="headerlink" href="#c.TSK_ERR_GENOME_COORDS_NONFINITE" title="Link to this definition">#</a><br /></dt>
<dd><p>A genomic position was non-finite </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_KEEP_ROWS_MAP_TO_DELETED">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1gab944f08f8a97db544079af6310964e14"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_KEEP_ROWS_MAP_TO_DELETED</span></span></span> <span class="pre">-212</span><a class="headerlink" href="#c.TSK_ERR_KEEP_ROWS_MAP_TO_DELETED" title="Link to this definition">#</a><br /></dt>
<dd><p>One of the rows in the retained table refers to a row that has been deleted. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_POSITION_OUT_OF_BOUNDS">
<span class="target" id="group___o_o_b___e_r_r_o_r___g_r_o_u_p_1gada3799023be881659f1b6f0c11439e63"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_POSITION_OUT_OF_BOUNDS</span></span></span> <span class="pre">-213</span><a class="headerlink" href="#c.TSK_ERR_POSITION_OUT_OF_BOUNDS" title="Link to this definition">#</a><br /></dt>
<dd><p>A genomic position was less than zero or greater equal to the sequence length </p>
</dd></dl>

</section>
<section id="edge-errors">
<h3>Edge errors<a class="headerlink" href="#edge-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_NULL_PARENT">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga86e9408b2fb77b159846d8b76dab0dc8"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_NULL_PARENT</span></span></span> <span class="pre">-300</span><a class="headerlink" href="#c.TSK_ERR_NULL_PARENT" title="Link to this definition">#</a><br /></dt>
<dd><p>A parent node of an edge was TSK_NULL. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_NULL_CHILD">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1gaf6b0528a6d9beebe8f8d937a68e26304"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_NULL_CHILD</span></span></span> <span class="pre">-301</span><a class="headerlink" href="#c.TSK_ERR_NULL_CHILD" title="Link to this definition">#</a><br /></dt>
<dd><p>A child node of an edge was TSK_NULL. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EDGES_NOT_SORTED_PARENT_TIME">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga8486d7a31c75cb0b73d702718c411e13"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EDGES_NOT_SORTED_PARENT_TIME</span></span></span> <span class="pre">-302</span><a class="headerlink" href="#c.TSK_ERR_EDGES_NOT_SORTED_PARENT_TIME" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge table was not sorted by the time of each edge’s parent nodes. Sort order is (time[parent], child, left). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EDGES_NONCONTIGUOUS_PARENTS">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga33d6f5b32e8fb701e4bf27b53c598002"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EDGES_NONCONTIGUOUS_PARENTS</span></span></span> <span class="pre">-303</span><a class="headerlink" href="#c.TSK_ERR_EDGES_NONCONTIGUOUS_PARENTS" title="Link to this definition">#</a><br /></dt>
<dd><p>A parent node had edges that were non-contigious. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EDGES_NOT_SORTED_CHILD">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga0ce8a985f495ccec59e596c548bcd0c8"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EDGES_NOT_SORTED_CHILD</span></span></span> <span class="pre">-304</span><a class="headerlink" href="#c.TSK_ERR_EDGES_NOT_SORTED_CHILD" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge table was not sorted by the id of the child node of each edge. Sort order is (time[parent], child, left). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EDGES_NOT_SORTED_LEFT">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga56912a73b85a360ef0ab984347491879"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EDGES_NOT_SORTED_LEFT</span></span></span> <span class="pre">-305</span><a class="headerlink" href="#c.TSK_ERR_EDGES_NOT_SORTED_LEFT" title="Link to this definition">#</a><br /></dt>
<dd><p>The edge table was not sorted by the left coordinate each edge. Sort order is (time[parent], child, left). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_NODE_TIME_ORDERING">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1gadca1fb75bd0ea259928be29b38ca2ea6"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_NODE_TIME_ORDERING</span></span></span> <span class="pre">-306</span><a class="headerlink" href="#c.TSK_ERR_BAD_NODE_TIME_ORDERING" title="Link to this definition">#</a><br /></dt>
<dd><p>An edge had child node that was older than the parent. Parent times must be greater than the child time. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_EDGE_INTERVAL">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga35488dbce85c09af07392235aa0990da"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_EDGE_INTERVAL</span></span></span> <span class="pre">-307</span><a class="headerlink" href="#c.TSK_ERR_BAD_EDGE_INTERVAL" title="Link to this definition">#</a><br /></dt>
<dd><p>An edge had a genomic interval where right was greater or equal to left. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_DUPLICATE_EDGES">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1gadc182251e5f80492f6f2a7b1950feb4d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_DUPLICATE_EDGES</span></span></span> <span class="pre">-308</span><a class="headerlink" href="#c.TSK_ERR_DUPLICATE_EDGES" title="Link to this definition">#</a><br /></dt>
<dd><p>An edge was duplicated. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_RIGHT_GREATER_SEQ_LENGTH">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga1094c5e1992f7bcfb6c46095071b721f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_RIGHT_GREATER_SEQ_LENGTH</span></span></span> <span class="pre">-309</span><a class="headerlink" href="#c.TSK_ERR_RIGHT_GREATER_SEQ_LENGTH" title="Link to this definition">#</a><br /></dt>
<dd><p>An edge had a right coord greater than the genomic length. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_LEFT_LESS_ZERO">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga05562638891f7b6b1cfafdfb8d2c8fa2"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_LEFT_LESS_ZERO</span></span></span> <span class="pre">-310</span><a class="headerlink" href="#c.TSK_ERR_LEFT_LESS_ZERO" title="Link to this definition">#</a><br /></dt>
<dd><p>An edge had a left coord less than zero. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_EDGES_CONTRADICTORY_CHILDREN">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga8bebc3276beb576bbfafd382cf59e9f7"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_EDGES_CONTRADICTORY_CHILDREN</span></span></span> <span class="pre">-311</span><a class="headerlink" href="#c.TSK_ERR_BAD_EDGES_CONTRADICTORY_CHILDREN" title="Link to this definition">#</a><br /></dt>
<dd><p>A parent node had edges that were contradictory over an interval. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_CANT_PROCESS_EDGES_WITH_METADATA">
<span class="target" id="group___e_d_g_e___e_r_r_o_r___g_r_o_u_p_1ga3920e76b6d7cd279aaabef084f2786ec"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_CANT_PROCESS_EDGES_WITH_METADATA</span></span></span> <span class="pre">-312</span><a class="headerlink" href="#c.TSK_ERR_CANT_PROCESS_EDGES_WITH_METADATA" title="Link to this definition">#</a><br /></dt>
<dd><p>A method that doesn’t support edge metadata was attempted on an edge table containing metadata. </p>
</dd></dl>

</section>
<section id="site-errors">
<h3>Site errors<a class="headerlink" href="#site-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNSORTED_SITES">
<span class="target" id="group___s_i_t_e___e_r_r_o_r___g_r_o_u_p_1ga6b0af775724104345c0cda81cc69e566"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNSORTED_SITES</span></span></span> <span class="pre">-400</span><a class="headerlink" href="#c.TSK_ERR_UNSORTED_SITES" title="Link to this definition">#</a><br /></dt>
<dd><p>The site table was not in order of increasing genomic position. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_DUPLICATE_SITE_POSITION">
<span class="target" id="group___s_i_t_e___e_r_r_o_r___g_r_o_u_p_1ga1ddcc34ed9a291ff83987496d757d151"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_DUPLICATE_SITE_POSITION</span></span></span> <span class="pre">-401</span><a class="headerlink" href="#c.TSK_ERR_DUPLICATE_SITE_POSITION" title="Link to this definition">#</a><br /></dt>
<dd><p>The site table had more than one site at a single genomic position. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_SITE_POSITION">
<span class="target" id="group___s_i_t_e___e_r_r_o_r___g_r_o_u_p_1gab28e8905ba41bcf9579ff75e1036c891"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_SITE_POSITION</span></span></span> <span class="pre">-402</span><a class="headerlink" href="#c.TSK_ERR_BAD_SITE_POSITION" title="Link to this definition">#</a><br /></dt>
<dd><p>A site had a position that was less than zero or greater than the sequence length. </p>
</dd></dl>

</section>
<section id="mutation-errors">
<h3>Mutation errors<a class="headerlink" href="#mutation-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_PARENT_DIFFERENT_SITE">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaf31be365937dabdc07f86a5676e4e4e9"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_PARENT_DIFFERENT_SITE</span></span></span> <span class="pre">-500</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_PARENT_DIFFERENT_SITE" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation had a parent mutation that was at a different site. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_PARENT_EQUAL">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaa7180258793b6d91ba50b65aa8ee063e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_PARENT_EQUAL</span></span></span> <span class="pre">-501</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_PARENT_EQUAL" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation had a parent mutation that was itself. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_PARENT_AFTER_CHILD">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaee44ecfe90631cd17f85cd9c7117bee6"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_PARENT_AFTER_CHILD</span></span></span> <span class="pre">-502</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_PARENT_AFTER_CHILD" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation had a parent mutation that had a greater id. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_PARENT_INCONSISTENT">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga0851c303ad52bd1f73d194cc583c82bf"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_PARENT_INCONSISTENT</span></span></span> <span class="pre">-503</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_PARENT_INCONSISTENT" title="Link to this definition">#</a><br /></dt>
<dd><p>Two or more mutation parent references formed a loop </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNSORTED_MUTATIONS">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga18f8aec942bd8600a73a0c2db52f5c34"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNSORTED_MUTATIONS</span></span></span> <span class="pre">-504</span><a class="headerlink" href="#c.TSK_ERR_UNSORTED_MUTATIONS" title="Link to this definition">#</a><br /></dt>
<dd><p>The mutation table was not in the order of non-decreasing site id and non-increasing time within each site. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_TIME_YOUNGER_THAN_NODE">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaaa94d3fd0b0539d1b0cf02f8a81c0f05"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_TIME_YOUNGER_THAN_NODE</span></span></span> <span class="pre">-506</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_TIME_YOUNGER_THAN_NODE" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation’s time was younger (not &gt;=) the time of its node and wasn’t TSK_UNKNOWN_TIME. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_MUTATION">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaf97317373a48f9af0827e5ce701c8d2f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_MUTATION</span></span></span> <span class="pre">-507</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_MUTATION" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation’s time was older (not &lt;=) than the time of its parent mutation, and wasn’t TSK_UNKNOWN_TIME. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_NODE">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga29b96441d6c51c1e52dbda87ff7c7e2a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_NODE</span></span></span> <span class="pre">-508</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_TIME_OLDER_THAN_PARENT_NODE" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation’s time was older (not &lt;) than the time of the parent node of the edge on which it occurs, and wasn’t TSK_UNKNOWN_TIME. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUTATION_TIME_HAS_BOTH_KNOWN_AND_UNKNOWN">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga6ef7005651bb0017813e1f1c8d1b8faa"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUTATION_TIME_HAS_BOTH_KNOWN_AND_UNKNOWN</span></span></span> <span class="pre">-509</span><a class="headerlink" href="#c.TSK_ERR_MUTATION_TIME_HAS_BOTH_KNOWN_AND_UNKNOWN" title="Link to this definition">#</a><br /></dt>
<dd><p>A single site had a mixture of known mutation times and TSK_UNKNOWN_TIME </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_DISALLOWED_UNKNOWN_MUTATION_TIME">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1gaf8b460b436a841ebf7937c150dae2e2b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_DISALLOWED_UNKNOWN_MUTATION_TIME</span></span></span> <span class="pre">-510</span><a class="headerlink" href="#c.TSK_ERR_DISALLOWED_UNKNOWN_MUTATION_TIME" title="Link to this definition">#</a><br /></dt>
<dd><p>Some mutations have TSK_UNKNOWN_TIME in an algorithm where that’s disallowed (use compute_mutation_times?). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_MUTATION_PARENT">
<span class="target" id="group___m_u_t_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga848fa3d11a0ccba590d8372b5a93189b"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_MUTATION_PARENT</span></span></span> <span class="pre">-511</span><a class="headerlink" href="#c.TSK_ERR_BAD_MUTATION_PARENT" title="Link to this definition">#</a><br /></dt>
<dd><p>A mutation’s parent was not consistent with the topology of the tree. </p>
</dd></dl>

</section>
<section id="migration-errors">
<h3>Migration errors<a class="headerlink" href="#migration-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNSORTED_MIGRATIONS">
<span class="target" id="group___m_i_g_r_a_t_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga891d724835990ca3e2f70f89fb33db21"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNSORTED_MIGRATIONS</span></span></span> <span class="pre">-550</span><a class="headerlink" href="#c.TSK_ERR_UNSORTED_MIGRATIONS" title="Link to this definition">#</a><br /></dt>
<dd><p>The migration table was not sorted by time. </p>
</dd></dl>

</section>
<section id="sample-errors">
<h3>Sample errors<a class="headerlink" href="#sample-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_DUPLICATE_SAMPLE">
<span class="target" id="group___s_a_m_p_l_e___e_r_r_o_r___g_r_o_u_p_1gacf14462863027c0fef1b2ac68394abaf"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_DUPLICATE_SAMPLE</span></span></span> <span class="pre">-600</span><a class="headerlink" href="#c.TSK_ERR_DUPLICATE_SAMPLE" title="Link to this definition">#</a><br /></dt>
<dd><p>A duplicate sample was specified. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_SAMPLES">
<span class="target" id="group___s_a_m_p_l_e___e_r_r_o_r___g_r_o_u_p_1gadeb80bf81d15b625d154a2411d861980"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_SAMPLES</span></span></span> <span class="pre">-601</span><a class="headerlink" href="#c.TSK_ERR_BAD_SAMPLES" title="Link to this definition">#</a><br /></dt>
<dd><p>A sample id that was not valid was specified. </p>
</dd></dl>

</section>
<section id="table-errors">
<h3>Table errors<a class="headerlink" href="#table-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_TABLE_POSITION">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1ga6d345e58a0ebc34def4039996c83b8d6"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_TABLE_POSITION</span></span></span> <span class="pre">-700</span><a class="headerlink" href="#c.TSK_ERR_BAD_TABLE_POSITION" title="Link to this definition">#</a><br /></dt>
<dd><p>An invalid table position was specifed. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_SEQUENCE_LENGTH">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1gaf20d163e851e357ce01e4d0c618b2d03"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_SEQUENCE_LENGTH</span></span></span> <span class="pre">-701</span><a class="headerlink" href="#c.TSK_ERR_BAD_SEQUENCE_LENGTH" title="Link to this definition">#</a><br /></dt>
<dd><p>A sequence length equal to or less than zero was specified. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TABLES_NOT_INDEXED">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1gae768f8febd9f06f0d173efd3728a4e1d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TABLES_NOT_INDEXED</span></span></span> <span class="pre">-702</span><a class="headerlink" href="#c.TSK_ERR_TABLES_NOT_INDEXED" title="Link to this definition">#</a><br /></dt>
<dd><p>The table collection was not indexed. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TABLE_OVERFLOW">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1ga5d6f26e040b3e696d5152a793fce7d1d"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TABLE_OVERFLOW</span></span></span> <span class="pre">-703</span><a class="headerlink" href="#c.TSK_ERR_TABLE_OVERFLOW" title="Link to this definition">#</a><br /></dt>
<dd><p>Tables cannot be larger than 2**31 rows. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_COLUMN_OVERFLOW">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1ga60f98d282d16b9ec62c938a8400f065f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_COLUMN_OVERFLOW</span></span></span> <span class="pre">-704</span><a class="headerlink" href="#c.TSK_ERR_COLUMN_OVERFLOW" title="Link to this definition">#</a><br /></dt>
<dd><p>Ragged array columns cannot be larger than 2**64 bytes. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TREE_OVERFLOW">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1ga9ff1e54d16a4103ff4423f70cc55e3de"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TREE_OVERFLOW</span></span></span> <span class="pre">-705</span><a class="headerlink" href="#c.TSK_ERR_TREE_OVERFLOW" title="Link to this definition">#</a><br /></dt>
<dd><p>The table collection contains more than 2**31 trees. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_METADATA_DISABLED">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1ga98ec14a128bb14ffaf76e4424c56ad4f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_METADATA_DISABLED</span></span></span> <span class="pre">-706</span><a class="headerlink" href="#c.TSK_ERR_METADATA_DISABLED" title="Link to this definition">#</a><br /></dt>
<dd><p>Metadata was attempted to be set on a table where it is disabled. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TABLES_BAD_INDEXES">
<span class="target" id="group___t_a_b_l_e___e_r_r_o_r___g_r_o_u_p_1gacd20a3d1cd0272482c51aada0331d956"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TABLES_BAD_INDEXES</span></span></span> <span class="pre">-707</span><a class="headerlink" href="#c.TSK_ERR_TABLES_BAD_INDEXES" title="Link to this definition">#</a><br /></dt>
<dd><p>There was an error with the table’s indexes. </p>
</dd></dl>

</section>
<section id="genotype-decoding-errors">
<h3>Genotype decoding errors<a class="headerlink" href="#genotype-decoding-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MUST_IMPUTE_NON_SAMPLES">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1ga8fbe20c56d568c839ea669a007c19bf1"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MUST_IMPUTE_NON_SAMPLES</span></span></span> <span class="pre">-1100</span><a class="headerlink" href="#c.TSK_ERR_MUST_IMPUTE_NON_SAMPLES" title="Link to this definition">#</a><br /></dt>
<dd><p>Genotypes were requested for non-samples at the same time as asking that isolated nodes be marked as missing. This is not supported. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_ALLELE_NOT_FOUND">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1gab0243ff1aa159899d6c2fb3411d64bd4"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_ALLELE_NOT_FOUND</span></span></span> <span class="pre">-1101</span><a class="headerlink" href="#c.TSK_ERR_ALLELE_NOT_FOUND" title="Link to this definition">#</a><br /></dt>
<dd><p>A user-specified allele map was used, but didn’t contain an allele found in the tree sequence. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_TOO_MANY_ALLELES">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1gaa659af05f7844e780558019fbdb662f5"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_TOO_MANY_ALLELES</span></span></span> <span class="pre">-1102</span><a class="headerlink" href="#c.TSK_ERR_TOO_MANY_ALLELES" title="Link to this definition">#</a><br /></dt>
<dd><p>More than 2147483647 alleles were specified. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_ZERO_ALLELES">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1gabe3a1c554f74a81cc9eb612238e30d6f"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_ZERO_ALLELES</span></span></span> <span class="pre">-1103</span><a class="headerlink" href="#c.TSK_ERR_ZERO_ALLELES" title="Link to this definition">#</a><br /></dt>
<dd><p>A user-specified allele map was used, but it contained zero alleles. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_BAD_ALLELE_LENGTH">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1gafecb95a9376f2103ae19661bc1e2ab13"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_BAD_ALLELE_LENGTH</span></span></span> <span class="pre">-1104</span><a class="headerlink" href="#c.TSK_ERR_BAD_ALLELE_LENGTH" title="Link to this definition">#</a><br /></dt>
<dd><p>An allele used when decoding alignments had length other than one. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_MISSING_CHAR_COLLISION">
<span class="target" id="group___g_e_n_o_t_y_p_e___e_r_r_o_r___g_r_o_u_p_1ga0e37d82a65a03f94768310a9ba782ea1"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_MISSING_CHAR_COLLISION</span></span></span> <span class="pre">-1105</span><a class="headerlink" href="#c.TSK_ERR_MISSING_CHAR_COLLISION" title="Link to this definition">#</a><br /></dt>
<dd><p>An allele used when decoding alignments matched the missing data character. </p>
</dd></dl>

</section>
<section id="union-errors">
<h3>Union errors<a class="headerlink" href="#union-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNION_BAD_MAP">
<span class="target" id="group___u_n_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga739e09b860fd749e5eddd70211d31203"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNION_BAD_MAP</span></span></span> <span class="pre">-1400</span><a class="headerlink" href="#c.TSK_ERR_UNION_BAD_MAP" title="Link to this definition">#</a><br /></dt>
<dd><p>A node map was specified that contained a node not present in the specified table collection. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNION_DIFF_HISTORIES">
<span class="target" id="group___u_n_i_o_n___e_r_r_o_r___g_r_o_u_p_1ga0021d9bfbb65253dcf770a09796ca433"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNION_DIFF_HISTORIES</span></span></span> <span class="pre">-1401</span><a class="headerlink" href="#c.TSK_ERR_UNION_DIFF_HISTORIES" title="Link to this definition">#</a><br /></dt>
<dd><p>The shared portions of the specified tree sequences are not equal. Note that this may be the case if the table collections were not fully sorted before union was called. </p>
</dd></dl>

</section>
<section id="simplify-errors">
<h3>Simplify errors<a class="headerlink" href="#simplify-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_KEEP_UNARY_MUTUALLY_EXCLUSIVE">
<span class="target" id="group___s_i_m_p_l_i_f_y___e_r_r_o_r___g_r_o_u_p_1ga099a3dc9ec43134fe7ca5c3325320099"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_KEEP_UNARY_MUTUALLY_EXCLUSIVE</span></span></span> <span class="pre">-1600</span><a class="headerlink" href="#c.TSK_ERR_KEEP_UNARY_MUTUALLY_EXCLUSIVE" title="Link to this definition">#</a><br /></dt>
<dd><p>Both TSK_SIMPLIFY_KEEP_UNARY and TSK_SIMPLIFY_KEEP_UNARY_IN_INDIVIDUALS were specified. Only one can be used. </p>
</dd></dl>

</section>
<section id="individual-errors">
<h3>Individual errors<a class="headerlink" href="#individual-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_UNSORTED_INDIVIDUALS">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___e_r_r_o_r___g_r_o_u_p_1gaa5a3fedaae23700d1089376788926b75"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_UNSORTED_INDIVIDUALS</span></span></span> <span class="pre">-1700</span><a class="headerlink" href="#c.TSK_ERR_UNSORTED_INDIVIDUALS" title="Link to this definition">#</a><br /></dt>
<dd><p>Individuals were provided in an order where parents were after their children. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_INDIVIDUAL_SELF_PARENT">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___e_r_r_o_r___g_r_o_u_p_1gaa67f56e72e5cf17f2f77e42051988655"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_INDIVIDUAL_SELF_PARENT</span></span></span> <span class="pre">-1701</span><a class="headerlink" href="#c.TSK_ERR_INDIVIDUAL_SELF_PARENT" title="Link to this definition">#</a><br /></dt>
<dd><p>An individual was its own parent. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_INDIVIDUAL_PARENT_CYCLE">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___e_r_r_o_r___g_r_o_u_p_1ga8752eec7aebf113c929d845f538e685c"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_INDIVIDUAL_PARENT_CYCLE</span></span></span> <span class="pre">-1702</span><a class="headerlink" href="#c.TSK_ERR_INDIVIDUAL_PARENT_CYCLE" title="Link to this definition">#</a><br /></dt>
<dd><p>An individual was its own ancestor in a cycle of references. </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_INDIVIDUAL_POPULATION_MISMATCH">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___e_r_r_o_r___g_r_o_u_p_1gacd7caaf17c9c1c2178940981c2545665"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_INDIVIDUAL_POPULATION_MISMATCH</span></span></span> <span class="pre">-1703</span><a class="headerlink" href="#c.TSK_ERR_INDIVIDUAL_POPULATION_MISMATCH" title="Link to this definition">#</a><br /></dt>
<dd><p>An individual had nodes from more than one population (and only one was requested). </p>
</dd></dl>

<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_INDIVIDUAL_TIME_MISMATCH">
<span class="target" id="group___i_n_d_i_v_i_d_u_a_l___e_r_r_o_r___g_r_o_u_p_1gaf33ba9d58325edef253b81e49607979a"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_INDIVIDUAL_TIME_MISMATCH</span></span></span> <span class="pre">-1704</span><a class="headerlink" href="#c.TSK_ERR_INDIVIDUAL_TIME_MISMATCH" title="Link to this definition">#</a><br /></dt>
<dd><p>An individual had nodes from more than one time (and only one was requested). </p>
</dd></dl>

</section>
<section id="extend-edges-errors">
<h3>Extend edges errors<a class="headerlink" href="#extend-edges-errors" title="Link to this heading">#</a></h3>
<dl class="c macro">
<dt class="sig sig-object c" id="c.TSK_ERR_EXTEND_EDGES_BAD_MAXITER">
<span class="target" id="group___e_x_t_e_n_d___e_d_g_e_s___e_r_r_o_r___g_r_o_u_p_1ga80362b0f2ed51d1f1faebe50ef62e52e"></span><span class="sig-name descname"><span class="n"><span class="pre">TSK_ERR_EXTEND_EDGES_BAD_MAXITER</span></span></span> <span class="pre">-1800</span><a class="headerlink" href="#c.TSK_ERR_EXTEND_EDGES_BAD_MAXITER" title="Link to this definition">#</a><br /></dt>
<dd><p>Maximum iteration number (max_iter) must be positive. </p>
</dd></dl>

</section>
</section>
<section id="examples">
<span id="sec-c-api-examples"></span><h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<section id="basic-forwards-simulator">
<h3>Basic forwards simulator<a class="headerlink" href="#basic-forwards-simulator" title="Link to this heading">#</a></h3>
<p>This is an example of using the tables API to define a simple
haploid Wright-Fisher simulator. Because this simple example
repeatedly sorts the edge data, it is quite inefficient and
should not be used as the basis of a large-scale simulator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This example uses the C function <code class="docutils literal notranslate"><span class="pre">rand</span></code> and constant
<code class="docutils literal notranslate"><span class="pre">RAND_MAX</span></code> for random number generation.  These methods
are used for example purposes only and a high-quality
random number library should be preferred for code
used for research.  Examples include, but are not
limited to:</p>
<ol class="arabic simple">
<li><p>The <a class="reference external" href="https://www.gnu.org/software/gsl">GNU Scientific Library</a>,
which is licensed under the GNU General Public License, version
3 (<a class="reference external" href="https://www.gnu.org/licenses/gpl-3.0.en.html">GPL3+</a>.</p></li>
<li><p>For C++ projects using C++11 or later,
the built-in <a class="reference external" href="https://en.cppreference.com/w/cpp/numeric/random">random</a>
number library.</p></li>
<li><p>The <a class="reference external" href="https://numpy.org/devdocs/reference/random/c-api.html">numpy C API</a>
may be useful for those writing Python extension modules in C/C++.</p></li>
</ol>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Give a pointer to an example that caches and flushes edge data efficiently.
Probably using the C++ API?</p>
</div>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;err.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit/tables.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        errx(EXIT_FAILURE, &quot;line %d: %s&quot;, __LINE__, tsk_strerror(val));                 \</span>
<span class="cp">    }</span>

<span class="kt">void</span>
<span class="nf">simulate</span><span class="p">(</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">simplify_interval</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">parents</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">children</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="n">left_parent</span><span class="p">,</span><span class="w"> </span><span class="n">right_parent</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">breakpoint</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">simplify_interval</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// leads to division by zero</span>
<span class="w">    </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">tsk_id_t</span><span class="p">));</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">sequence_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">    </span><span class="n">parents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_node_table_add_row</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Alternate between using the first and last N values in the buffer */</span>
<span class="w">        </span><span class="n">parents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="n">children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_node_table_add_row</span><span class="p">(</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
<span class="w">            </span><span class="cm">/* NOTE: the use of rand() is discouraged for</span>
<span class="cm">             * research code and proper random number generator</span>
<span class="cm">             * libraries should be preferred.</span>
<span class="cm">             */</span>
<span class="w">            </span><span class="n">left_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parents</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)((</span><span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">RAND_MAX</span><span class="p">))</span><span class="o">*</span><span class="n">N</span><span class="p">)];</span>
<span class="w">            </span><span class="n">right_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parents</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)((</span><span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">RAND_MAX</span><span class="p">))</span><span class="o">*</span><span class="n">N</span><span class="p">)];</span>
<span class="w">            </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">breakpoint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">RAND_MAX</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">breakpoint</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="cm">/* tiny proba of breakpoint being 0 */</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_add_row</span><span class="p">(</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">breakpoint</span><span class="p">,</span><span class="w"> </span><span class="n">left_parent</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_add_row</span><span class="p">(</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">breakpoint</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">right_parent</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">            </span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">simplify_interval</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Simplify at generation %lld: (%lld nodes %lld edges)&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">t</span><span class="p">,</span>
<span class="w">                </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">nodes</span><span class="p">.</span><span class="n">num_rows</span><span class="p">,</span>
<span class="w">                </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>
<span class="w">            </span><span class="cm">/* Note: Edges must be sorted for simplify to work, and we use a brute force</span>
<span class="cm">             * approach of sorting each time here for simplicity. This is inefficient. */</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_sort</span><span class="p">(</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">            </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_simplify</span><span class="p">(</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="n">children</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot; -&gt; (%lld nodes %lld edges)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">nodes</span><span class="p">.</span><span class="n">num_rows</span><span class="p">,</span>
<span class="w">                </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tables</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;usage: N T simplify-interval output-file seed&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span>
<span class="w">    </span><span class="n">simulate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>

<span class="w">    </span><span class="cm">/* Sort and index so that the result can be opened as a tree sequence */</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_sort</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_build_index</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_dump</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="n">tsk_table_collection_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="tree-iteration">
<span id="sec-c-api-examples-tree-iteration"></span><h3>Tree iteration<a class="headerlink" href="#tree-iteration" title="Link to this heading">#</a></h3>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;err.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        errx(EXIT_FAILURE, &quot;line %d: %s&quot;, __LINE__, tsk_strerror(val));                 \</span>
<span class="cp">    }</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_treeseq_t</span><span class="w"> </span><span class="n">ts</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;usage: &lt;tree sequence file&gt;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Iterate forwards</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_first</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSK_TREE_OK</span><span class="p">;</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">tree %lld has %lld roots</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
<span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tsk_tree_get_num_roots</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Iterate backwards</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_last</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSK_TREE_OK</span><span class="p">;</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_prev</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">tree %lld has %lld roots</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
<span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tsk_tree_get_num_roots</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="n">tsk_tree_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>
<span class="w">    </span><span class="n">tsk_treeseq_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="tree-traversals">
<span id="sec-c-api-examples-tree-traversals"></span><h3>Tree traversals<a class="headerlink" href="#tree-traversals" title="Link to this heading">#</a></h3>
<p>In this example we load a tree sequence file, and then traverse the first
tree in four different ways:</p>
<ol class="arabic simple">
<li><p>We first traverse the tree in preorder and postorder using the
<a class="reference internal" href="#c.tsk_tree_preorder" title="tsk_tree_preorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_preorder()</span></code></a>
<a class="reference internal" href="#c.tsk_tree_postorder" title="tsk_tree_postorder"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_tree_postorder()</span></code></a> functions to fill an array of
nodes in the appropriate orders. This is the recommended approach
and will be convenient and efficient for most purposes.</p></li>
<li><p>As an example of how we might build our own traveral algorithms, we
then traverse the tree in preorder using recursion. This is a very
common way of navigating around trees and can be convenient for
some applications. For example, here we compute the depth of each node
(i.e., it’s distance from the root) and use this when printing out the
nodes as we visit them.</p></li>
<li><p>Then we traverse the tree in preorder using an iterative approach. This
is a little more efficient than using recursion, and is sometimes
more convenient than structuring the calculation recursively.</p></li>
<li><p>In the third example we iterate upwards from the samples rather than
downwards from the root.</p></li>
</ol>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;err.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        errx(EXIT_FAILURE, &quot;line %d: %s&quot;, __LINE__, tsk_strerror(val));                 \</span>
<span class="cp">    }</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">traverse_standard</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tsk_tree_get_size_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_preorder</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit preorder %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_postorder</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">num_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit postorder %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">nodes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">_traverse</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">depth</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">depth</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;    &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit recursive %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left_child</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right_sib</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_traverse</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">depth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">traverse_recursive</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">_traverse</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">virtual_root</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">traverse_stack</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">stack_top</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">tsk_tree_get_size_bound</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">stack</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stack</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">stack_top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">stack</span><span class="p">[</span><span class="n">stack_top</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">virtual_root</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">stack_top</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stack</span><span class="p">[</span><span class="n">stack_top</span><span class="p">];</span>
<span class="w">        </span><span class="n">stack_top</span><span class="o">--</span><span class="p">;</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit stack %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">        </span><span class="cm">/* Put nodes on the stack right-to-left, so we visit in left-to-right */</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">right_child</span><span class="p">[</span><span class="n">u</span><span class="p">];</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">;</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">left_sib</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">stack_top</span><span class="o">++</span><span class="p">;</span>
<span class="w">            </span><span class="n">stack</span><span class="p">[</span><span class="n">stack_top</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">stack</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">traverse_upwards</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="o">*</span><span class="n">tree</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_get_samples</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">tree_sequence</span><span class="p">);</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_get_num_samples</span><span class="p">(</span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">tree_sequence</span><span class="p">);</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="n">u</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_samples</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Visit upwards: %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">u</span><span class="p">);</span>
<span class="w">            </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="o">-&gt;</span><span class="n">parent</span><span class="p">[</span><span class="n">u</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_treeseq_t</span><span class="w"> </span><span class="n">ts</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_tree_t</span><span class="w"> </span><span class="n">tree</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;usage: &lt;tree sequence file&gt;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_treeseq_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ts</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_tree_first</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="n">traverse_standard</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>

<span class="w">    </span><span class="n">traverse_recursive</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>

<span class="w">    </span><span class="n">traverse_stack</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>

<span class="w">    </span><span class="n">traverse_upwards</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>

<span class="w">    </span><span class="n">tsk_tree_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tree</span><span class="p">);</span>
<span class="w">    </span><span class="n">tsk_treeseq_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ts</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="file-streaming">
<span id="sec-c-api-examples-file-streaming"></span><h3>File streaming<a class="headerlink" href="#file-streaming" title="Link to this heading">#</a></h3>
<p>It is often useful to read tree sequence files from a stream rather than
from a fixed filename. This example shows how to do this using the
<a class="reference internal" href="#c.tsk_table_collection_loadf" title="tsk_table_collection_loadf"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_loadf()</span></code></a> and
<a class="reference internal" href="#c.tsk_table_collection_dumpf" title="tsk_table_collection_dumpf"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_dumpf()</span></code></a> functions. Here, we sequentially
load table collections from the <code class="docutils literal notranslate"><span class="pre">stdin</span></code> stream and write them
back out to <code class="docutils literal notranslate"><span class="pre">stdout</span></code> with their mutations removed.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit/tables.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        fprintf(stderr, &quot;Error: line %d: %s\n&quot;, __LINE__, tsk_strerror(val));           \</span>
<span class="cp">        exit(EXIT_FAILURE);                                                             \</span>
<span class="cp">    }</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>

<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="nb">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_loadf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="n">stdin</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NO_INIT</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TSK_ERR_EOF</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">        </span><span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Tree sequence %d had %lld mutations</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span>
<span class="w">            </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tables</span><span class="p">.</span><span class="n">mutations</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_mutation_table_truncate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">.</span><span class="n">mutations</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_dumpf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">,</span><span class="w"> </span><span class="n">stdout</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">        </span><span class="n">j</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tsk_table_collection_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tables</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that we use the value <a class="reference internal" href="#c.TSK_ERR_EOF" title="TSK_ERR_EOF"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_ERR_EOF</span></code></a> to detect when the stream
ends, as we don’t know how many tree sequences to expect on the input.
In this case, <a class="reference internal" href="#c.TSK_ERR_EOF" title="TSK_ERR_EOF"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_ERR_EOF</span></code></a> is not considered an error and we exit
normally.</p>
<p>Running this program on some tree sequence files we might get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat tmp1.trees tmp2.trees | ./build/streaming &gt; no_mutations.trees
Tree sequence 0 had 38 mutations
Tree sequence 1 had 132 mutations
</pre></div>
</div>
<p>Then, running this program again on the output of the previous command,
we see that we now have two tree sequences with their mutations removed
stored in the file <code class="docutils literal notranslate"><span class="pre">no_mutations.trees</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./build/streaming &lt; no_mutations.trees &gt; /dev/null
Tree sequence 0 had 0 mutations
Tree sequence 1 had 0 mutations
</pre></div>
</div>
</section>
<section id="parallel-multichromosome-simulation">
<h3>Parallel, multichromosome simulation<a class="headerlink" href="#parallel-multichromosome-simulation" title="Link to this heading">#</a></h3>
<p>A substantial bottleneck in forwards simulations using tree sequences
is <em>simplification</em>. This is therefore a natural target for parallelization.
The potential for breaking up a chromosome into discrete chunks that
are separately parallelized is limited, however, since any edge
that extends across the boundary between two chunks is split;
thus creating more work.
However, distinct chromosomes provide a natural target:
the edge tables describing inheritance for each chromosome can be
independently simplified, as long as the fact that they all refer to
the same set of nodes.
This simulation keeps each chromosome in a separate tree sequence,
but they essentially share a common node table;
the <a class="reference internal" href="#c.TSK_SIMPLIFY_NO_FILTER_NODES" title="TSK_SIMPLIFY_NO_FILTER_NODES"><code class="xref c c-macro docutils literal notranslate"><span class="pre">TSK_SIMPLIFY_NO_FILTER_NODES</span></code></a> flag is used so that
each call to <a class="reference internal" href="#c.tsk_table_collection_simplify" title="tsk_table_collection_simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_simplify()</span></code></a> does not
change the common node table.
Afterwards, we iterate though the edge tables to determine which
nodes need to be retained, and use
<a class="reference internal" href="#c.tsk_node_table_keep_rows" title="tsk_node_table_keep_rows"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_node_table_keep_rows()</span></code></a> to remove unused nodes.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;assert.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;err.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;pthread.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;tskit/tables.h&gt;</span>

<span class="cp">#define check_tsk_error(val)                                                            \</span>
<span class="cp">    if (val &lt; 0) {                                                                      \</span>
<span class="cp">        errx(EXIT_FAILURE, &quot;line %d: %s\n&quot;, __LINE__, tsk_strerror(val));               \</span>
<span class="cp">    }</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">init_tables</span><span class="p">(</span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">tsk_node_table_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">nodes</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">free_tables</span><span class="p">(</span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="cm">/* Must not double free node table columns. */</span>
<span class="w">            </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">nodes</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">tsk_table_collection_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">join_tables</span><span class="p">(</span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_extend</span><span class="p">(</span>
<span class="w">            </span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/* Get all the squashable edges next to each other */</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_sort</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_squash</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">edges</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* We need to sort again after squash */</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_sort</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_build_index</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">struct</span><span class="w"> </span><span class="nc">chunk_work</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">chunk</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tc</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">samples</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">void</span><span class="w"> </span><span class="o">*</span>
<span class="nf">simplify_chunk</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">chunk_work</span><span class="w"> </span><span class="o">*</span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">chunk_work</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">arg</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">edges_before</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">work</span><span class="o">-&gt;</span><span class="n">tc</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">;</span>

<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_sort</span><span class="p">(</span><span class="n">work</span><span class="o">-&gt;</span><span class="n">tc</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_simplify</span><span class="p">(</span><span class="n">work</span><span class="o">-&gt;</span><span class="n">tc</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="o">-&gt;</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="o">-&gt;</span><span class="n">N</span><span class="p">,</span>
<span class="w">        </span><span class="n">TSK_SIMPLIFY_NO_FILTER_NODES</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">TSK_SIMPLIFY_NO_UPDATE_SAMPLE_FLAGS</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* NOTE: this printf makes helgrind complain */</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">chunk %d: %lld -&gt; %lld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">work</span><span class="o">-&gt;</span><span class="n">chunk</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">edges_before</span><span class="p">,</span>
<span class="w">        </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">work</span><span class="o">-&gt;</span><span class="n">tc</span><span class="o">-&gt;</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">sort_and_simplify_all</span><span class="p">(</span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">chunk_work</span><span class="w"> </span><span class="n">work</span><span class="p">[</span><span class="n">num_chroms</span><span class="p">];</span>
<span class="w">    </span><span class="n">pthread_t</span><span class="w"> </span><span class="n">threads</span><span class="p">[</span><span class="n">num_chroms</span><span class="p">];</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">work</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">chunk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span>
<span class="w">        </span><span class="n">work</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">tc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="w">        </span><span class="n">work</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">samples</span><span class="p">;</span>
<span class="w">        </span><span class="n">work</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>

<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">threads</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">simplify_chunk</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pthread create failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="cm">/* simplify_chunk((void *) &amp;work[j]); */</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pthread_join</span><span class="p">(</span><span class="n">threads</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ret</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pthread join failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">simplify_tables</span><span class="p">(</span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">num_edges</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">tsk_size_t</span><span class="w"> </span><span class="n">num_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">num_rows</span><span class="p">;</span>
<span class="w">    </span><span class="n">tsk_bool_t</span><span class="w"> </span><span class="o">*</span><span class="n">keep_nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">num_nodes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">keep_nodes</span><span class="p">));</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">node_id_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">num_nodes</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">node_id_map</span><span class="p">));</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">edge_child</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">edge_parent</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">keep_nodes</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">node_id_map</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Simplify %lld nodes</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>
<span class="w">    </span><span class="n">sort_and_simplify_all</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="n">samples</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_nodes</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">keep_nodes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">        </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">flags</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;=</span><span class="w"> </span><span class="p">(</span><span class="o">~</span><span class="n">TSK_NODE_IS_SAMPLE</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">keep_nodes</span><span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">flags</span><span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">TSK_NODE_IS_SAMPLE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">edge_child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
<span class="w">        </span><span class="n">edge_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">parent</span><span class="p">;</span>
<span class="w">        </span><span class="n">num_edges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_edges</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">keep_nodes</span><span class="p">[</span><span class="n">edge_child</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">            </span><span class="n">keep_nodes</span><span class="p">[</span><span class="n">edge_parent</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">tsk_node_table_keep_rows</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="n">keep_nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">node_id_map</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">done: %lld nodes</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="kt">long</span><span class="p">)</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">num_rows</span><span class="p">);</span>

<span class="w">    </span><span class="cm">/* Remap node references */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">edge_child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
<span class="w">        </span><span class="n">edge_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">parent</span><span class="p">;</span>
<span class="w">        </span><span class="n">num_edges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">].</span><span class="n">edges</span><span class="p">.</span><span class="n">num_rows</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_edges</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">edge_child</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge_child</span><span class="p">[</span><span class="n">k</span><span class="p">]];</span>
<span class="w">            </span><span class="n">edge_parent</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node_id_map</span><span class="p">[</span><span class="n">edge_parent</span><span class="p">[</span><span class="n">k</span><span class="p">]];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_check_integrity</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">node_id_map</span><span class="p">[</span><span class="n">samples</span><span class="p">[</span><span class="n">j</span><span class="p">]];</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">keep_nodes</span><span class="p">);</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">node_id_map</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span>
<span class="nf">simulate</span><span class="p">(</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="o">*</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">simplify_interval</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">tsk_id_t</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">parents</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">children</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="n">left_parent</span><span class="p">,</span><span class="w"> </span><span class="n">right_parent</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">left_is_first</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">chunk_left</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_right</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">;</span>

<span class="w">    </span><span class="n">assert</span><span class="p">(</span><span class="n">simplify_interval</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// leads to division by zero</span>
<span class="w">    </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">tsk_id_t</span><span class="p">));</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Out of memory&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tcs</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">sequence_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">parents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_node_table_add_row</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">parents</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">t</span><span class="o">--</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="cm">/* Alternate between using the first and last N values in the buffer */</span>
<span class="w">        </span><span class="n">parents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">        </span><span class="n">children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">child</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_node_table_add_row</span><span class="p">(</span>
<span class="w">                </span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="n">TSK_NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">child</span><span class="p">);</span>
<span class="w">            </span><span class="cm">/* NOTE: the use of rand() is discouraged for</span>
<span class="cm">             * research code and proper random number generator</span>
<span class="cm">             * libraries should be preferred.</span>
<span class="cm">             */</span>
<span class="w">            </span><span class="n">left_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parents</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)((</span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">)];</span>
<span class="w">            </span><span class="n">right_parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parents</span><span class="p">[(</span><span class="kt">size_t</span><span class="p">)((</span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">)];</span>
<span class="w">            </span><span class="n">left_is_first</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">            </span><span class="n">chunk_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">chunk_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chunk_left</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rand</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">RAND_MAX</span><span class="p">);</span>
<span class="w">                </span><span class="cm">/* a very tiny chance that right and left are equal */</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">chunk_right</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">chunk_left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_add_row</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_left</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_right</span><span class="p">,</span>
<span class="w">                        </span><span class="n">left_is_first</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">left_parent</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">right_parent</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">                    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="n">chunk_left</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">chunk_right</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">chunk_left</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_edge_table_add_row</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">edges</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_right</span><span class="p">,</span><span class="w"> </span><span class="n">chunk_left</span><span class="p">,</span>
<span class="w">                        </span><span class="n">left_is_first</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">right_parent</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">left_parent</span><span class="p">,</span><span class="w"> </span><span class="n">child</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">                    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">child</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">simplify_interval</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">simplify_tables</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="n">children</span><span class="p">,</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/* Set the sample flags for final generation */</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">nodes</span><span class="p">.</span><span class="n">flags</span><span class="p">[</span><span class="n">children</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TSK_NODE_IS_SAMPLE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">errx</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;usage: N T simplify-interval output seed num-chroms&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="n">num_chroms</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>
<span class="w">    </span><span class="n">tsk_table_collection_t</span><span class="w"> </span><span class="n">tcs</span><span class="p">[</span><span class="n">num_chroms</span><span class="p">];</span>

<span class="w">    </span><span class="n">srand</span><span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]));</span>
<span class="w">    </span><span class="n">init_tables</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">);</span>
<span class="w">    </span><span class="n">simulate</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">,</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]));</span>
<span class="w">    </span><span class="n">join_tables</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">);</span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tsk_table_collection_dump</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tcs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">check_tsk_error</span><span class="p">(</span><span class="n">ret</span><span class="p">);</span>
<span class="w">    </span><span class="n">free_tables</span><span class="p">(</span><span class="n">tcs</span><span class="p">,</span><span class="w"> </span><span class="n">num_chroms</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="numba.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Numba Integration</p>
      </div>
    </a>
    <a class="right-next"
       href="cli.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Command line interface</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#do-i-need-the-c-api">Do I need the C API?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differences-with-the-python-api">Differences with the Python API</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-stability-contract">API stability contract</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-structure">API structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-handling">Error handling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-allocation-strategy">Memory allocation strategy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-tskit-in-your-project">Using tskit in your project</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-types">Basic Types</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-options">Common options</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-api">Tables API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-collections">Table collections</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individuals">Individuals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nodes">Nodes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edges">Edges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migrations">Migrations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sites">Sites</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutations">Mutations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#populations">Populations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#provenances">Provenances</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-indexes">Table indexes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-sequences">Tree sequences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trees">Trees</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lifecycle">Lifecycle</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#null-state">Null state</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seeking">Seeking</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-queries">Tree queries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#node-queries">Node queries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#traversal-orders">Traversal orders</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-level-sorting">Low-level sorting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#decoding-genotypes">Decoding genotypes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#miscellaneous-functions">Miscellaneous functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#function-specific-options">Function Specific Options</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#load-and-init">Load and init</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-treeseq-init"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_init()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-treeseq-simplify-tsk-table-collection-simplify"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_treeseq_simplify()</span></code>, <code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_simplify()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-check-integrity"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_check_integrity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-clear"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_clear()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-copy"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#all-equality-functions">All equality functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-subset"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_subset()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tsk-table-collection-union"><code class="xref c c-func docutils literal notranslate"><span class="pre">tsk_table_collection_union()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#api-version">API Version</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#common-constants">Common constants</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-errors">Generic Errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-format-errors">File format errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#out-of-bounds-errors">Out-of-bounds errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#edge-errors">Edge errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#site-errors">Site errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mutation-errors">Mutation errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#migration-errors">Migration errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-errors">Sample errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-errors">Table errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#genotype-decoding-errors">Genotype decoding errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#union-errors">Union errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simplify-errors">Simplify errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-errors">Individual errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extend-edges-errors">Extend edges errors</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-forwards-simulator">Basic forwards simulator</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-iteration">Tree iteration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tree-traversals">Tree traversals</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#file-streaming">File streaming</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parallel-multichromosome-simulation">Parallel, multichromosome simulation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Tskit Developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>